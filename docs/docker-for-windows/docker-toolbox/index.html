
<blockquote class="warning">
  <p><strong>廃止決定</strong></p>

  <p>Docker Toolbox は廃止決定されており、開発は行われていません。
  この代わりに Docker Desktop を利用してください。
  詳しくは <a href="/docs.docker.jp.onthefly/docker-for-mac/">Docker Desktop for Mac</a> や <a href="/docs.docker.jp.onthefly/docker-for-windows/">Docker Desktop for Windows</a> を参照してください。</p>
</blockquote>

<p>このページでは Docker Toolbox ディスクイメージを Docker Desktop へ移行する方法について説明します。
また Docker Toolbox を Mac または Windows からアンインストールする手順についても説明します。</p>

<h2 id="migrate-from-docker-toolbox-to-docker-desktop-on-mac">Docker Toolbox から Docker Desktop on Mac への移行</h2>

<p>Docker Toolbox イメージを移行するには以下の手順を行います。</p>

<p>Toolbox が起動している状態でターミナル画面から<code class="language-plaintext highlighter-rouge">docker commit</code>を実行し、保存しておきたいコンテナーのイメージスナップショットを生成します。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker commit nginx
sha256:1bc0ee792d144f0f9a1b926b862dc88b0206364b0931be700a313111025df022
</code></pre></div></div>

<p>次にそのイメージをエクスポートします（保存しておきたいイメージすべてについて行います）。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker save -o nginx.tar sha256:1bc0ee792d144f0f9a1b926b862dc88b0206364b0931be700a313111025df022
</code></pre></div></div>

<p>Docker Desktop on Mac が起動している状態で、上のイメージをリロードします。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker load -i nginx.tar
Loaded image ID: sha256:1bc0ee792d144f0f9a1b926b862dc88b0206364b0931be700a313111025df022
</code></pre></div></div>

<p>なお上の手順を行っても<code class="language-plaintext highlighter-rouge">docker volume</code>の内容は一切移行されません。
これについては手動でコピーを行ってください。</p>

<p>最後に任意の作業として Docker Toolbox での作業が他に何もなければ、Docker Toolbox の <a href="#uninstall-docker-toolbox-on-windows">アンインストール</a> を行います。
その手順は以降の節で説明しています。</p>

<h2 id="migrate-from-docker-toolbox-to-docker-desktop-on-windows">Docker Toolbox から Docker Desktop on Windows への移行</h2>

<p>Docker Toolbox イメージを移行するには以下の手順を行います。</p>

<p>Toolbox が起動している状態でターミナル画面から<code class="language-plaintext highlighter-rouge">docker commit</code>を実行し、保存しておきたいコンテナーのイメージスナップショットを生成します。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; docker commit nginx
sha256:1bc0ee792d144f0f9a1b926b862dc88b0206364b0931be700a313111025df022
</code></pre></div></div>

<p>次にそのイメージをエクスポートします（保存しておきたいイメージすべてについて行います）。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; docker save -o nginx.tar sha256:1bc0ee792d144f0f9a1b926b862dc88b0206364b0931be700a313111025df022
</code></pre></div></div>

<p>Docker Desktop on Windows が起動している状態で、上のイメージをリロードします。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; docker load -i nginx.tar
Loaded image ID: sha256:1bc0ee792d144f0f9a1b926b862dc88b0206364b0931be700a313111025df022
</code></pre></div></div>

<p>なお上の手順を行っても<code class="language-plaintext highlighter-rouge">docker volume</code>の内容は一切移行されません。
これについては手動でコピーを行ってください。</p>

<h2 id="uninstall-docker-toolbox">Docker Toolbox のアンインストール</h2>

<p>Toolbox を削除するということは、そこに含まれていた Docker コンポーネントをすべて削除するということです。</p>

<p>また完全にアンインストールを行うと、Docker Machine を使って生成したローカルマシンおよびリモートマシンもすべて削除されます。
場合によっては Docker Machine によって生成したマシンを保存しておきたいことがあるはずです。
たとえば Docker Desktop の一部として Docker Machine を再インストールしようとしている場合には、引き続きそのようなマシンを管理していきたいはずです。
あるいはクラウドプロバイダー上にリモートマシンを生成していて、プロバイダー上の管理を引き続き行うのであれば、マシンを削除したくないはずです。
そこで以下の説明においては、マシン削除の手順は任意の作業として説明することにします。</p>

<h3 id="uninstall-docker-toolbox-on-mac">Docker Toolbox on Mac のアンインストール</h3>

<p>Docker Toolbox on Mac のアンインストールは以下のようにして行います。</p>

<ol>
  <li>
    <p>マシン一覧を表示します。</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-machine ls
NAME                ACTIVE   DRIVER       STATE     URL                        SWARM
dev                 *        virtualbox   Running   tcp://192.168.99.100:2376
my-docker-machine            virtualbox   Stopped
default                      virtualbox   Stopped
</code></pre></div>    </div>
  </li>
  <li>
    <p>任意の手順として個々のマシンを削除します。
たとえば以下のとおりです。</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-machine rm my-docker-machine
Successfully removed my-docker-machine
</code></pre></div>    </div>

    <p>この手順は任意です。
<a href="/docs.docker.jp.onthefly/docker-for-mac/">Docker Desktop for Mac</a> の一部として Docker Machine を再インストールする予定であれば、上のマシンをインポートして Docker による管理を引き続き行っていくことができます。</p>
  </li>
  <li>
    <p>「Applications」フォルダーにおいて、「Docker Quickstart Terminal」や「Kitematic」が含まれている「Docker」ディレクトリを削除します。</p>
  </li>
  <li>
    <p>コマンドシェルから以下のコマンドを実行して Kitematic を完全に削除します。</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rm -fr ~/Library/Application\ Support/Kitematic
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">/usr/local/bin</code>フォルダーから<code class="language-plaintext highlighter-rouge">docker</code>、<code class="language-plaintext highlighter-rouge">docker-compose</code>、<code class="language-plaintext highlighter-rouge">docker-machine</code>の各コマンドを削除します。
Docker Desktop for Mac や Brew にはそれらがインストールされたままかもしれません。
それが疑われる場合は、Brew を通した再インストールを行うか、Docker Desktop for Mac を再起動してください（再インストールの必要はありません）。</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ rm -f /usr/local/bin/docker
$ rm -f /usr/local/bin/docker-compose
$ rm -f /usr/local/bin/docker-machine
</code></pre></div>    </div>
  </li>
  <li>
    <p>任意の手順として<code class="language-plaintext highlighter-rouge">~/.docker/machine</code>ディレクトリを削除します。</p>

    <p>このディレクトリには設定ファイルや状態に関する情報が保存されています。
たとえば生成されたマシンや証明書などの情報を含みます。</p>
  </li>
  <li>
    <p>Oracle VirtualBox をアンインストールします。
これは Toolbox インストールの際の一部としてインストールされるものです。</p>
  </li>
</ol>

<h3 id="uninstall-docker-toolbox-on-windows">Docker Toolbox on Windows のアンインストール</h3>

<p>Docker Toolbox on Windows のアンインストールは以下のようにして行います。</p>

<ol>
  <li>
    <p>マシン一覧を表示します。</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-machine ls
NAME                ACTIVE   DRIVER       STATE     URL                        SWARM
dev                 *        virtualbox   Running   tcp://192.168.99.100:2376
my-docker-machine            virtualbox   Stopped
default                      virtualbox   Stopped
</code></pre></div>    </div>
  </li>
  <li>
    <p>任意の手順として個々のマシンを削除します。
たとえば以下のとおりです。</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-machine rm my-docker-machine
Successfully removed my-docker-machine
</code></pre></div>    </div>

    <p>この手順は任意です。
<a href="/docs.docker.jp.onthefly/docker-for-windows/">Docker Desktop for Windows</a> の一部として Docker Machine を再インストールする予定であれば、上のマシンをインポートして Docker による管理を引き続き行っていくことができます。</p>
  </li>
  <li>
    <p>Docker Toolbox のアンインストールは、コントロールパネル（そのプログラムと機能）を通じて、通常のアンインストールプログラムによる処理手順に従って行います。</p>

    <blockquote>
      <p><strong>メモ</strong>: この手順を行っても<code class="language-plaintext highlighter-rouge">docker-install.exe</code>ファイルは削除されません。
  このファイルは手動で削除してください。</p>
    </blockquote>
  </li>
  <li>
    <p>任意の手順として<code class="language-plaintext highlighter-rouge">C:\Users\&lt;your-user&gt;\.docker</code>ディレクトリを削除します。</p>

    <p>Docker を完全に削除する場合は、アンインストールによってユーザーパス配下の<code class="language-plaintext highlighter-rouge">.docker</code>が削除されているかどうかを確認します。
 このディレクトリがまだ存在している場合は手動で削除してください。
 このディレクトリには Docker のプログラム設定や状態に関する情報が保存されています。
 たとえば生成されたマシンや証明書などの情報を含みます。
 通常はこのディレクトリを削除する必要はありません。</p>
  </li>
  <li>
    <p>Oracle VirtualBox をアンインストールします。
これは Toolbox インストールの際の一部としてインストールされるものです。</p>
  </li>
</ol>
