<!-- Page generated 2021-06-04 14:08:15 +0900-->
<!DOCTYPE html>
<html lang="ja"><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Docker ローカルイメージに対するぜい弱性スキャン | Docker ドキュメント</title>
  <meta name="description" content="Dockerローカルイメージに対するぜい弱性スキャン。" />
  <meta name="keywords" content="Docker, scan, Snyk, images, local, CVE, vulnerability, security">
  <link rel="canonical" href="https://localhost:4000{{ site.baseurl }}/engine/scan/" />

  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <meta name="theme-color" content="#2496ed" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0"><script defer src="/docs.docker.jp.onthefly/js/theme-switcher.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/jquery.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
  <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script><script defer src="/docs.docker.jp.onthefly/js/search.js"></script><link rel="preload" as="font" href="https://fonts.gstatic.com/s/opensans/v18/mem8YaGs126MiZpBA-UFVZ0bf8pkAg.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/geomanist/hinted-Geomanist-Book.woff2"    type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/geomanist/hinted-Geomanist-Regular.woff2" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/glyphicons-halflings-regular.woff2"       type="font/woff2" crossorigin="anonymous">
  <link rel="preload" as="font" href="/docs.docker.jp.onthefly/fonts/fontawesome-webfont.woff2?v=4.7.0"        type="font/woff2" crossorigin="anonymous">

  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css" id="pagestyle">

  <!-- SEO stuff -->
  <meta name="twitter:title" itemprop="title name" content="Docker ローカルイメージに対するぜい弱性スキャン"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="" />
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:domain" content="matsuand.github.io"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker ドキュメント"/>
  <meta property="og:title" content="Docker ローカルイメージに対するぜい弱性スキャン" />
  <meta property="og:description" content="Dockerローカルイメージに対するぜい弱性スキャン。" />
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2021-06-04T14:08:15+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta property="og:locale" content="ja_JP" />
  <meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/engine/scan/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <meta property="article:published_time" itemprop="datePublished" content="2021-06-04T14:08:15+09:00"/>
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Docker ローカルイメージに対するぜい弱性スキャン","description":"Dockerローカルイメージに対するぜい弱性スキャン。","url":"https://docs.docker.com/engine/scan/"}</script>
  <!-- END SEO STUFF -->
</head>
<body class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/">
                <img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs" width="160" height="28" />
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/docs.docker.jp.onthefly/">
        <img src="/docs.docker.jp.onthefly/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs" width="30" height="30" />
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline" id="searchForm" action="/docs.docker.jp.onthefly/search/" method="get">
        <label for="st-search-input" class="sr-only">検索</label>
        <input class="search-field form-control ds-input" id="st-search-input" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteResults"></div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div id="tabs">
        <ul class="tabs jsTOCHorizontal"><li><a href="/docs.docker.jp.onthefly/" id="home">ホーム</a></li><li><a href="/docs.docker.jp.onthefly/get-started/overview/" id="guides">ガイド</a></li><li><a href="/docs.docker.jp.onthefly/desktop/" id="manuals">製品マニュアル</a></li><li><a href="/docs.docker.jp.onthefly/reference/" id="reference">リファレンス</a></li><li><a href="/docs.docker.jp.onthefly/samples/" id="samples">サンプル</a></li></ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle" aria-label="現在ページのメニュートグル"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>
<div class="row hidden-sm hidden-xs">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li><a href="/docs.docker.jp.onthefly/" title="Docker docs homepage"><i class="fa fa-home"></i></a></li>
            <li><a href="/docs.docker.jp.onthefly/desktop/">製品マニュアル</a></li><li><a href="/docs.docker.jp.onthefly/engine/">Docker Engine</a></li><li><a href="/docs.docker.jp.onthefly/engine/scan/">Docker スキャン</a></li></ol>
    </nav>
</div></div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section"><h1>Docker ローカルイメージに対するぜい弱性スキャン</h1><p><em class="reading-time">読む時間の目安: 9 分</em></p><blockquote>
  <p>開発サイクルを早めたいと思いませんか？
CVE をすばやく検出して修復する方法として<code class="language-plaintext highlighter-rouge">docker scan IMAGE_NAME</code>を実行してください。
詳しくは <a href="#how-to-scan-images">イメージのスキャン方法</a> を確認してください。</p>
</blockquote>

<p>Docker のローカルイメージに対するぜい弱性スキャンは、開発者および開発チームにおいてコンテナーイメージのセキュリティ状況を明らかにするものであり、スキャン中に発覚した問題への対処につながります。
結果としてより安全なデプロイを実現するものです。
Docker スキャンは Snyk エンジンを使って動作します。
ローカルの Dockerfile やローカルイメージに対して、セキュリティ状況を可視化して示します。</p>

<p>ぜい弱性スキャンは CLI から起動し、CLI を使ってスキャン結果を確認します。
スキャン結果は、ぜい弱性情報データベース CVE（Common Vulnerabilities and Exposures）の一覧として構成され、そこにはぜい弱性の発生源、つまり OS パッケージやライブラリなど、またぜい弱性が発生したバージョン、CVE によって検出された問題を修復するための推奨される修正バージョン（入手可能である場合）が示されます。</p>

<p>ぜい弱性スキャンの実行に必要となるシステム要件については <a href="#prerequisites">前提条件</a> を参照してください。</p>

<p>本ページでは CLI コマンド<code class="language-plaintext highlighter-rouge">docker scan</code>の情報を示します。
Docker Hub を通じて Docker イメージを自動スキャンする情報に関しては <a href="/docs.docker.jp.onthefly/docker-hub/vulnerability-scanning/">Docker Hub のぜい弱性スキャン</a> を参照してください。</p>

<h2 id="how-to-scan-images">イメージのスキャン方法</h2>

<p><code class="language-plaintext highlighter-rouge">docker scan</code>コマンドは、イメージ名またはイメージ ID を指定して、既存の Docker イメージをスキャンします。
たとえば以下のコマンドは hello-world イメージをスキャンします。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span> docker scan hello-world

  Testing hello-world...

  Organization:      docker-desktop-test
  Package manager:   linux
  Project name:      docker-image|hello-world
  Docker image:      hello-world
  Licenses:          enabled

  ✓ Tested 0 dependencies <span class="k">for </span>known issues, no vulnerable paths found.

  Note that we <span class="k">do </span>not currently have vulnerability data <span class="k">for </span>your image.
</code></pre></div></div>

<h3 id="get-a-detailed-scan-report">スキャン結果詳細</h3>

<p>イメージを作り出すために用いられた Dockerfile を指定することで、Docker イメージに関する詳細なスキャン結果を得ることができます。
コマンド文法は<code class="language-plaintext highlighter-rouge">docker scan --file &lt;Dockerfileへのパス&gt; &lt;Dockerイメージ&gt;</code>というものです。</p>

<p>たとえばテストイメージに対してそのオプションを指定すると、以下のような結果が表示されます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--file</span> Dockerfile docker-scan:e2e
Testing docker-scan:e2e
...
✗ High severity vulnerability found <span class="k">in </span>perl
  Description: Integer Overflow or Wraparound
  Info: https://snyk.io/vuln/SNYK-DEBIAN10-PERL-570802
  Introduced through: git@1:2.20.1-2+deb10u3, meta-common-packages@meta
  From: git@1:2.20.1-2+deb10u3 <span class="o">&gt;</span> perl@5.28.1-6
  From: git@1:2.20.1-2+deb10u3 <span class="o">&gt;</span> liberror-perl@0.17027-2 <span class="o">&gt;</span> perl@5.28.1-6
  From: git@1:2.20.1-2+deb10u3 <span class="o">&gt;</span> perl@5.28.1-6 <span class="o">&gt;</span> perl/perl-modules-5.28@5.28.1-6
  and 3 more...
  Introduced by your base image <span class="o">(</span>golang:1.14.6<span class="o">)</span>

Organization:      docker-desktop-test
Package manager:   deb
Target file:       Dockerfile
Project name:      docker-image|99138c65ebc7
Docker image:      99138c65ebc7
Base image:        golang:1.14.6
Licenses:          enabled

Tested 200 dependencies <span class="k">for </span>known issues, found 157 issues.

According to our scan, you are currently using the most secure version of the selected base image
</code></pre></div></div>

<h3 id="excluding-the-base-image">ベースイメージの除外</h3>

<p><code class="language-plaintext highlighter-rouge">--file</code>フラグを使って docker scan を行う場合に<code class="language-plaintext highlighter-rouge">--exclude-base</code>フラグを同時に指定することができます。
このフラグは、ぜい弱性スキャン結果からベースイメージ（Dockerfile において<code class="language-plaintext highlighter-rouge">FROM</code>ディレクティブにより指定されたもの）を除外します。
たとえば以下のとおりです。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--file</span> Dockerfile <span class="nt">--exclude-base</span> docker-scan:e2e
Testing docker-scan:e2e
...
✗ Medium severity vulnerability found <span class="k">in </span>libidn2/libidn2-0
  Description: Improper Input Validation
  Info: https://snyk.io/vuln/SNYK-DEBIAN10-LIBIDN2-474100
  Introduced through: iputils/iputils-ping@3:20180629-2+deb10u1, wget@1.20.1-1.1, curl@7.64.0-4+deb10u1, git@1:2.20.1-2+deb10u3
  From: iputils/iputils-ping@3:20180629-2+deb10u1 <span class="o">&gt;</span> libidn2/libidn2-0@2.0.5-1+deb10u1
  From: wget@1.20.1-1.1 <span class="o">&gt;</span> libidn2/libidn2-0@2.0.5-1+deb10u1
  From: curl@7.64.0-4+deb10u1 <span class="o">&gt;</span> curl/libcurl4@7.64.0-4+deb10u1 <span class="o">&gt;</span> libidn2/libidn2-0@2.0.5-1+deb10u1
  and 3 more...
  Introduced <span class="k">in </span>your Dockerfile by <span class="s1">'RUN apk add -U --no-cache wget tar'</span>



Organization:      docker-desktop-test
Package manager:   deb
Target file:       Dockerfile
Project name:      docker-image|99138c65ebc7
Docker image:      99138c65ebc7
Base image:        golang:1.14.6
Licenses:          enabled

Tested 200 dependencies <span class="k">for </span>known issues, found 16 issues.
</code></pre></div></div>

<h3 id="viewing-the-json-output">JSON 書式による出力</h3>

<p>コマンドに対して<code class="language-plaintext highlighter-rouge">--json</code>フラグを指定することで、スキャン結果を JSON 書式により表示することができます。
たとえば以下のとおりです。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--json</span> hello-world
<span class="o">{</span>
  <span class="s2">"vulnerabilities"</span>: <span class="o">[]</span>,
  <span class="s2">"ok"</span>: <span class="nb">true</span>,
  <span class="s2">"dependencyCount"</span>: 0,
  <span class="s2">"org"</span>: <span class="s2">"docker-desktop-test"</span>,
  <span class="s2">"policy"</span>: <span class="s2">"# Snyk (https://snyk.io) policy file, patches or ignores known vulnerabilities.</span><span class="se">\n</span><span class="s2">version: v1.19.0</span><span class="se">\n</span><span class="s2">ignore: {}</span><span class="se">\n</span><span class="s2">patch: {}</span><span class="se">\n</span><span class="s2">"</span>,
  <span class="s2">"isPrivate"</span>: <span class="nb">true</span>,
  <span class="s2">"licensesPolicy"</span>: <span class="o">{</span>
    <span class="s2">"severities"</span>: <span class="o">{}</span>,
    <span class="s2">"orgLicenseRules"</span>: <span class="o">{</span>
      <span class="s2">"AGPL-1.0"</span>: <span class="o">{</span>
        <span class="s2">"licenseType"</span>: <span class="s2">"AGPL-1.0"</span>,
        <span class="s2">"severity"</span>: <span class="s2">"high"</span>,
        <span class="s2">"instructions"</span>: <span class="s2">""</span>
      <span class="o">}</span>,
      ...
      <span class="s2">"SimPL-2.0"</span>: <span class="o">{</span>
        <span class="s2">"licenseType"</span>: <span class="s2">"SimPL-2.0"</span>,
        <span class="s2">"severity"</span>: <span class="s2">"high"</span>,
        <span class="s2">"instructions"</span>: <span class="s2">""</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>,
  <span class="s2">"packageManager"</span>: <span class="s2">"linux"</span>,
  <span class="s2">"ignoreSettings"</span>: null,
  <span class="s2">"docker"</span>: <span class="o">{</span>
    <span class="s2">"baseImageRemediation"</span>: <span class="o">{</span>
      <span class="s2">"code"</span>: <span class="s2">"SCRATCH_BASE_IMAGE"</span>,
      <span class="s2">"advice"</span>: <span class="o">[</span>
        <span class="o">{</span>
          <span class="s2">"message"</span>: <span class="s2">"Note that we do not currently have vulnerability data for your image."</span>,
          <span class="s2">"bold"</span>: <span class="nb">true</span>,
          <span class="s2">"color"</span>: <span class="s2">"yellow"</span>
        <span class="o">}</span>
      <span class="o">]</span>
    <span class="o">}</span>,
    <span class="s2">"binariesVulns"</span>: <span class="o">{</span>
      <span class="s2">"issuesData"</span>: <span class="o">{}</span>,
      <span class="s2">"affectedPkgs"</span>: <span class="o">{}</span>
    <span class="o">}</span>
  <span class="o">}</span>,
  <span class="s2">"summary"</span>: <span class="s2">"No known vulnerabilities"</span>,
  <span class="s2">"filesystemPolicy"</span>: <span class="nb">false</span>,
  <span class="s2">"uniqueCount"</span>: 0,
  <span class="s2">"projectName"</span>: <span class="s2">"docker-image|hello-world"</span>,
  <span class="s2">"path"</span>: <span class="s2">"hello-world"</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">--json</code>フラグに加えて<code class="language-plaintext highlighter-rouge">--group-issues</code>フラグを利用することもできます。
これはスキャン報告において 1 つのぜい弱性を 1 度だけ表示するものです。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--json</span> <span class="nt">--group-issues</span> docker-scan:e2e
<span class="o">{</span>
    <span class="o">{</span>
      <span class="s2">"title"</span>: <span class="s2">"Improper Check for Dropped Privileges"</span>,
      ...
      <span class="s2">"packageName"</span>: <span class="s2">"bash"</span>,
      <span class="s2">"language"</span>: <span class="s2">"linux"</span>,
      <span class="s2">"packageManager"</span>: <span class="s2">"debian:10"</span>,
      <span class="s2">"description"</span>: <span class="s2">"## Overview</span><span class="se">\n</span><span class="s2">An issue was discovered in disable_priv_mode in shell.c in GNU Bash through 5.0 patch 11. By default, if Bash is run with its effective UID not equal to its real UID, it will drop privileges by setting its effective UID to its real UID. However, it does so incorrectly. On Linux and other systems that support </span><span class="se">\"</span><span class="s2">saved UID</span><span class="se">\"</span><span class="s2"> functionality, the saved UID is not dropped. An attacker with command execution in the shell can use </span><span class="se">\"</span><span class="s2">enable -f</span><span class="se">\"</span><span class="s2"> for runtime loading of a new builtin, which can be a shared object that calls setuid() and therefore regains privileges. However, binaries running with an effective UID of 0 are unaffected.</span><span class="se">\n\n</span><span class="s2">## References</span><span class="se">\n</span><span class="s2">- [CONFIRM](https://security.netapp.com/advisory/ntap-20200430-0003/)</span><span class="se">\n</span><span class="s2">- [Debian Security Tracker](https://security-tracker.debian.org/tracker/CVE-2019-18276)</span><span class="se">\n</span><span class="s2">- [GitHub Commit](https://github.com/bminor/bash/commit/951bdaad7a18cc0dc1036bba86b18b90874d39ff)</span><span class="se">\n</span><span class="s2">- [MISC](http://packetstormsecurity.com/files/155498/Bash-5.0-Patch-11-Privilege-Escalation.html)</span><span class="se">\n</span><span class="s2">- [MISC](https://www.youtube.com/watch?v=-wGtxJ8opa8)</span><span class="se">\n</span><span class="s2">- [Ubuntu CVE Tracker](http://people.ubuntu.com/~ubuntu-security/cve/CVE-2019-18276)</span><span class="se">\n</span><span class="s2">"</span>,
      <span class="s2">"identifiers"</span>: <span class="o">{</span>
        <span class="s2">"ALTERNATIVE"</span>: <span class="o">[]</span>,
        <span class="s2">"CVE"</span>: <span class="o">[</span>
          <span class="s2">"CVE-2019-18276"</span>
        <span class="o">]</span>,
        <span class="s2">"CWE"</span>: <span class="o">[</span>
          <span class="s2">"CWE-273"</span>
        <span class="o">]</span>
      <span class="o">}</span>,
      <span class="s2">"severity"</span>: <span class="s2">"low"</span>,
      <span class="s2">"severityWithCritical"</span>: <span class="s2">"low"</span>,
      <span class="s2">"cvssScore"</span>: 7.8,
      <span class="s2">"CVSSv3"</span>: <span class="s2">"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F"</span>,
      ...
      <span class="s2">"from"</span>: <span class="o">[</span>
        <span class="s2">"docker-image|docker-scan@e2e"</span>,
        <span class="s2">"bash@5.0-4"</span>
      <span class="o">]</span>,
      <span class="s2">"upgradePath"</span>: <span class="o">[]</span>,
      <span class="s2">"isUpgradable"</span>: <span class="nb">false</span>,
      <span class="s2">"isPatchable"</span>: <span class="nb">false</span>,
      <span class="s2">"name"</span>: <span class="s2">"bash"</span>,
      <span class="s2">"version"</span>: <span class="s2">"5.0-4"</span>
    <span class="o">}</span>,
    ...
    <span class="s2">"summary"</span>: <span class="s2">"880 vulnerable dependency paths"</span>,
      <span class="s2">"filesystemPolicy"</span>: <span class="nb">false</span>,
      <span class="s2">"filtered"</span>: <span class="o">{</span>
        <span class="s2">"ignore"</span>: <span class="o">[]</span>,
        <span class="s2">"patch"</span>: <span class="o">[]</span>
      <span class="o">}</span>,
      <span class="s2">"uniqueCount"</span>: 158,
      <span class="s2">"projectName"</span>: <span class="s2">"docker-image|docker-scan"</span>,
      <span class="s2">"platform"</span>: <span class="s2">"linux/amd64"</span>,
      <span class="s2">"path"</span>: <span class="s2">"docker-scan:e2e"</span>
<span class="o">}</span>
</code></pre></div></div>
<p>ぜい弱性のもとになる情報は<code class="language-plaintext highlighter-rouge">from</code>の項目から知ることができます。</p>

<h3 id="checking-the-dependency-tree">依存パッケージツリーの確認</h3>

<p>イメージの依存パッケージを確認するには --dependency-tree フラグを利用します。
これはスキャン前に、依存パッケージをすべて表示するものです。
たとえば以下です。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--dependency-tree</span> debian:buster

<span class="nv">$ </span>docker-image|99138c65ebc7 @ latest
     ├─ ca-certificates @ 20200601~deb10u1
     │  └─ openssl @ 1.1.1d-0+deb10u3
     │     └─ openssl/libssl1.1 @ 1.1.1d-0+deb10u3
     ├─ curl @ 7.64.0-4+deb10u1
     │  └─ curl/libcurl4 @ 7.64.0-4+deb10u1
     │     ├─ e2fsprogs/libcom-err2 @ 1.44.5-1+deb10u3
     │     ├─ krb5/libgssapi-krb5-2 @ 1.17-3
     │     │  ├─ e2fsprogs/libcom-err2 @ 1.44.5-1+deb10u3
     │     │  ├─ krb5/libk5crypto3 @ 1.17-3
     │     │  │  └─ krb5/libkrb5support0 @ 1.17-3
     │     │  ├─ krb5/libkrb5-3 @ 1.17-3
     │     │  │  ├─ e2fsprogs/libcom-err2 @ 1.44.5-1+deb10u3
     │     │  │  ├─ krb5/libk5crypto3 @ 1.17-3
     │     │  │  ├─ krb5/libkrb5support0 @ 1.17-3
     │     │  │  └─ openssl/libssl1.1 @ 1.1.1d-0+deb10u3
     │     │  └─ krb5/libkrb5support0 @ 1.17-3
     │     ├─ libidn2/libidn2-0 @ 2.0.5-1+deb10u1
     │     │  └─ libunistring/libunistring2 @ 0.9.10-1
     │     ├─ krb5/libk5crypto3 @ 1.17-3
     │     ├─ krb5/libkrb5-3 @ 1.17-3
     │     ├─ openldap/libldap-2.4-2 @ 2.4.47+dfsg-3+deb10u2
     │     │  ├─ gnutls28/libgnutls30 @ 3.6.7-4+deb10u4
     │     │  │  ├─ nettle/libhogweed4 @ 3.4.1-1
     │     │  │  │  └─ nettle/libnettle6 @ 3.4.1-1
     │     │  │  ├─ libidn2/libidn2-0 @ 2.0.5-1+deb10u1
     │     │  │  ├─ nettle/libnettle6 @ 3.4.1-1
     │     │  │  ├─ p11-kit/libp11-kit0 @ 0.23.15-2
     │     │  │  │  └─ libffi/libffi6 @ 3.2.1-9
     │     │  │  ├─ libtasn1-6 @ 4.13-3
     │     │  │  └─ libunistring/libunistring2 @ 0.9.10-1
     │     │  ├─ cyrus-sasl2/libsasl2-2 @ 2.1.27+dfsg-1+deb10u1
     │     │  │  └─ cyrus-sasl2/libsasl2-modules-db @ 2.1.27+dfsg-1+deb10u1
     │     │  │     └─ db5.3/libdb5.3 @ 5.3.28+dfsg1-0.5
     │     │  └─ openldap/libldap-common @ 2.4.47+dfsg-3+deb10u2
     │     ├─ nghttp2/libnghttp2-14 @ 1.36.0-2+deb10u1
     │     ├─ libpsl/libpsl5 @ 0.20.2-2
     │     │  ├─ libidn2/libidn2-0 @ 2.0.5-1+deb10u1
     │     │  └─ libunistring/libunistring2 @ 0.9.10-1
     │     ├─ rtmpdump/librtmp1 @ 2.4+20151223.gitfa8646d.1-2
     │     │  ├─ gnutls28/libgnutls30 @ 3.6.7-4+deb10u4
     │     │  ├─ nettle/libhogweed4 @ 3.4.1-1
     │     │  └─ nettle/libnettle6 @ 3.4.1-1
     │     ├─ libssh2/libssh2-1 @ 1.8.0-2.1
     │     │  └─ libgcrypt20 @ 1.8.4-5
     │     └─ openssl/libssl1.1 @ 1.1.1d-0+deb10u3
     ├─ gnupg2/dirmngr @ 2.2.12-1+deb10u1
    ...

Organization:      docker-desktop-test
Package manager:   deb
Project name:      docker-image|99138c65ebc7
Docker image:      99138c65ebc7
Licenses:          enabled

Tested 200 dependencies <span class="k">for </span>known issues, found 157 issues.

For more free scans that keep your images secure, sign up to Snyk at https://dockr.ly/3ePqVcp.
</code></pre></div></div>

<p>ぜい弱性データの詳細については <a href="https://goto.docker.com/rs/929-FJL-178/images/cheat-sheet-docker-desktop-vulnerability-scanning-CLI.pdf" target="_blank" rel="noopener" class="_">Docker Vulnerability Scanning CLI Cheat Sheet</a> を参照してください。</p>

<h3 id="limiting-the-level-of-vulnerabilities-displayed">ぜい弱性レベルの表示制限</h3>

<p>Docker スキャンにおいては<code class="language-plaintext highlighter-rouge">--severity</code>フラグを利用することで、ぜい弱性レベルを選んで表示することができます。
この<code class="language-plaintext highlighter-rouge">--severity</code>フラグには、レポート内において確認したいぜい弱性レベルに応じて<code class="language-plaintext highlighter-rouge">low</code>、<code class="language-plaintext highlighter-rouge">medium</code>、<code class="language-plaintext highlighter-rouge">high</code>のいずれかを指定します。
たとえばこのレベルを<code class="language-plaintext highlighter-rouge">medium</code>に設定した場合、スキャンレポートにはぜい弱性レベルが medium（中程度）と high（重要）のものが表示されます。</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span><span class="w"> </span>docker scan <span class="nt">--severity</span><span class="o">=</span>medium docker-scan:e2e 
<span class="go">./bin/docker-scan_darwin_amd64 scan --severity=medium docker-scan:e2e

Testing docker-scan:e2e...

✗ Medium severity vulnerability found in sqlite3/libsqlite3-0
  Description: Divide By Zero
  Info: https://snyk.io/vuln/SNYK-DEBIAN10-SQLITE3-466337
  Introduced through: gnupg2/gnupg@2.2.12-1+deb10u1, subversion@1.10.4-1+deb10u1, mercurial@4.8.2-1+deb10u1
</span><span class="gp">  From: gnupg2/gnupg@2.2.12-1+deb10u1 &gt;</span><span class="w"> </span>gnupg2/gpg@2.2.12-1+deb10u1 <span class="o">&gt;</span> sqlite3/libsqlite3-0@3.27.2-3
<span class="gp">  From: subversion@1.10.4-1+deb10u1 &gt;</span><span class="w"> </span>subversion/libsvn1@1.10.4-1+deb10u1 <span class="o">&gt;</span> sqlite3/libsqlite3-0@3.27.2-3
<span class="gp">  From: mercurial@4.8.2-1+deb10u1 &gt;</span><span class="w"> </span>python-defaults/python@2.7.16-1 <span class="o">&gt;</span> python2.7@2.7.16-2+deb10u1 <span class="o">&gt;</span> python2.7/libpython2.7-stdlib@2.7.16-2+deb10u1 <span class="o">&gt;</span> sqlite3/libsqlite3-0@3.27.2-3
<span class="go">
✗ Medium severity vulnerability found in sqlite3/libsqlite3-0
  Description: Uncontrolled Recursion
</span><span class="c">...
</span><span class="go">✗ High severity vulnerability found in binutils/binutils-common
  Description: Missing Release of Resource after Effective Lifetime
  Info: https://snyk.io/vuln/SNYK-DEBIAN10-BINUTILS-403318
  Introduced through: gcc-defaults/g++@4:8.3.0-1
</span><span class="gp">  From: gcc-defaults/g++@4:8.3.0-1 &gt;</span><span class="w"> </span>gcc-defaults/gcc@4:8.3.0-1 <span class="o">&gt;</span> gcc-8@8.3.0-6 <span class="o">&gt;</span> binutils@2.31.1-16 <span class="o">&gt;</span> binutils/binutils-common@2.31.1-16
<span class="gp">  From: gcc-defaults/g++@4:8.3.0-1 &gt;</span><span class="w"> </span>gcc-defaults/gcc@4:8.3.0-1 <span class="o">&gt;</span> gcc-8@8.3.0-6 <span class="o">&gt;</span> binutils@2.31.1-16 <span class="o">&gt;</span> binutils/libbinutils@2.31.1-16 <span class="o">&gt;</span> binutils/binutils-common@2.31.1-16
<span class="gp">  From: gcc-defaults/g++@4:8.3.0-1 &gt;</span><span class="w"> </span>gcc-defaults/gcc@4:8.3.0-1 <span class="o">&gt;</span> gcc-8@8.3.0-6 <span class="o">&gt;</span> binutils@2.31.1-16 <span class="o">&gt;</span> binutils/binutils-x86-64-linux-gnu@2.31.1-16 <span class="o">&gt;</span> binutils/binutils-common@2.31.1-16
<span class="go">  and 4 more...

Organization:      docker-desktop-test
Package manager:   deb
Project name:      docker-image|docker-scan
Docker image:      docker-scan:e2e
Platform:          linux/amd64
Licenses:          enabled

Tested 200 dependencies for known issues, found 37 issues.
</span></code></pre></div></div>

<h2 id="provider-authentication">プロバイダー認証</h2>

<p>すでに Snyk アカウントを持っている場合は、Snyk の <a href="https://app.snyk.io/account" target="_blank" rel="noopener" class="_">API トークン</a> を直接利用することができます。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--login</span> <span class="nt">--token</span> &lt;Synk認証トークン&gt;

Your account has been authenticated. Snyk is now ready to be used.
</code></pre></div></div>

<p>トークンを指定せずに<code class="language-plaintext highlighter-rouge">--login</code>フラグを用いた場合、Snyk のウェブサイトにリダイレクトされてログインを行います。</p>

<h2 id="prerequisites">前提条件</h2>

<p>Docker イメージに対してぜい弱性スキャンを実行するには、以下を満たしていることが必要です。</p>

<ol>
  <li>
    <p>Docker Desktop 最新版（Edge）バージョン 2.3.6.0 またはそれ以降をダウンロードしインストールしていること。</p>

    <ul>
      <li><a href="https://desktop.docker.com/mac/edge/Docker.dmg" target="_blank" rel="noopener" class="_">Download for Mac</a></li>
      <li><a href="https://desktop.docker.com/win/edge/Docker%20Desktop%20Installer.exe" target="_blank" rel="noopener" class="_">Download for Windows</a></li>
    </ul>
  </li>
  <li>
    <p><a href="https://hub.docker.com" target="_blank" rel="noopener" class="_">Docker Hub</a> にサインインしていること。</p>
  </li>
  <li>
    <p>Docker Desktop メニューにおいて <strong>Sign in/ Create Docker ID</strong> を選択していること。
あるいはターミナル画面を開いて<code class="language-plaintext highlighter-rouge">docker login</code>を実行していること。</p>
  </li>
  <li>
    <p>（任意作業）スキャンを行うために <a href="https://dockr.ly/3ePqVcp" target="_blank" rel="noopener" class="_">Snyk アカウント</a> を生成していること。
または Docker Hub アカウントとともに利用できるものとして Snyk 社が提供する、月単位の追加無償スキャンを利用していること。</p>
  </li>
</ol>

<p>インストールができているかどうかを<code class="language-plaintext highlighter-rouge">docker scan --version</code>を実行して確認してください。
コマンド実行によって、docker scan の現行バージョン、および Snyk エンジンのバージョンを表示されます。
たとえば以下のとおりです。</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker scan <span class="nt">--version</span>
Version:    v0.5.0
Git commit: 5a09266
Provider:   Snyk <span class="o">(</span>1.432.0<span class="o">)</span>
</code></pre></div></div>

<blockquote>
  <p><strong>メモ</strong></p>

  <p>Docker Scan はデフォルトで、インストールされている Snyk バイナリを利用します。
これが利用できなかった場合は、Docker Desktop に埋め込まれている Snyk バイナリが利用されます。
必要となる Snyk の最低バージョンは<code class="language-plaintext highlighter-rouge">1.385.0</code>です。</p>
</blockquote>

<h2 id="supported-options">サポートされているオプション</h2>

<p>高度なコマンド<code class="language-plaintext highlighter-rouge">docker scan</code>では、イメージの名前または ID を使ってローカルイメージをスキャンします。
このコマンドは以下のオプションをサポートしています。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">オプション</th>
      <th style="text-align: left">内容説明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--accept-license</code></td>
      <td style="text-align: left">サードパーティー製プロバイダーのライセンスを承認します。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--dependency-tree</code></td>
      <td style="text-align: left">スキャン結果において依存パッケージのツリーを表示します。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--exclude-base</code></td>
      <td style="text-align: left">スキャンにあたってベースイメージは取り除きます。このオプションには --file オプションの設定が必要です。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-f</code>, <code class="language-plaintext highlighter-rouge">--file string</code></td>
      <td style="text-align: left">イメージに対応する Dockerfile を指定します。このオプションはスキャンの詳細結果を表示します。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--json</code></td>
      <td style="text-align: left">スキャン結果を JSON 書式により表示します。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--login</code></td>
      <td style="text-align: left">任意に指定されたトークン（--token フラグ利用）を使って Snyk にログインします。あるいはウェブベースのトークンを利用します。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--reject-license</code></td>
      <td style="text-align: left">サードパーティー製プロバイダーのライセンスを否認します。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--severity string</code></td>
      <td style="text-align: left">指定されたレベル以上のぜい弱性のみを表示します。(low、medium、high)</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--token string</code></td>
      <td style="text-align: left">認証トークンを使ってサードパーティー製スキャンプロバイダーにログインします。</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--version</code></td>
      <td style="text-align: left">Docker Scan プラグインのバージョンを表示します。</td>
    </tr>
  </tbody>
</table>

<h2 id="known-issues">既知の問題</h2>

<p><strong>WSL 2 の場合</strong></p>

<ul>
  <li>ぜい弱性スキャン機能は Alpine ディストリビューションにおいては動作しません。</li>
  <li>ディストリビューション Debian または OpenSUSE を利用している場合、ログイン処理は<code class="language-plaintext highlighter-rouge">--token</code>フラグを利用した場合にのみ動作します。その場合、Synk ウェブサイトへはリダイレクトされません。</li>
</ul>

<h2 id="feedback">フィードバック</h2>

<p>Docker ローカルイメージに対するぜい弱性スキャン機能をご利用いただき、ありがとうございます。
みなさんからのフィードバックを頂くことが重要と考えています。
フィードバックは GitHub リポジトリ内の <a href="https://github.com/docker/scan-cli-plugin/issues/new" target="_blank" rel="noopener" class="_">scan-cli-plugin</a> において issue を生成してお知らせください。</p>
<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="/docs.docker.jp.onthefly/search/?q=Docker">Docker</a>, <a href="/docs.docker.jp.onthefly/search/?q=scan">scan</a>, <a href="/docs.docker.jp.onthefly/search/?q=Snyk">Snyk</a>, <a href="/docs.docker.jp.onthefly/search/?q=images">images</a>, <a href="/docs.docker.jp.onthefly/search/?q=local">local</a>, <a href="/docs.docker.jp.onthefly/search/?q=CVE">CVE</a>, <a href="/docs.docker.jp.onthefly/search/?q=vulnerability">vulnerability</a>, <a href="/docs.docker.jp.onthefly/search/?q=security">security</a></span><div class="ratings-div"><div id="pd_rating_holder_8453675"></div></div></section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
                                <ul class="nav jsTOCHorizontal hidden-md hidden-lg"></ul>
                                <ul class="nav" id="jsTOCLeftNav"></ul>
                            </div>
                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul><li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/edit/master/src/engine/scan/index.ch"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> 本ページの編集</a></li><li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [engine/scan/index.ch](https://matsuand.github.io/docs.docker.jp.onthefly/engine/scan/)" class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 変更リクエスト</a></li>
                                        <li><div class="toggle-mode">
  <div class="icon">
      <i class="fa fa-sun-o" aria-hidden="true"></i>
  </div>
  <div class="toggle-switch">
      <label class="switch">
          <input type="checkbox" id="switch-style">
          <span class="slider round"></span>
      </label>
  </div>
  <div class="icon">
      <i class="fa fa-moon-o" aria-hidden="true"></i>
  </div>
</div>
</li>
                                    </ul>
                                </div><div id="side-toc-title">本ページ内:</div>
<ul id="my_toc" class="inline_toc">
  <li><a href="#how-to-scan-images" class="nomunge">イメージのスキャン方法</a>
    <ul>
      <li><a href="#provider-authentication" class="nomunge">プロバイダー認証</a></li>
      <li><a href="#prerequisites" class="nomunge">前提条件</a></li>
      <li><a href="#supported-options" class="nomunge">サポートされているオプション</a></li>
      <li><a href="#known-issues" class="nomunge">既知の問題</a></li>
      <li><a href="#feedback" class="nomunge">フィードバック</a></li>
    </ul>
  </li>
</ul>

</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">なぜ Docker なのか？</a></b></li>
                        <li><a href="https://www.docker.com/what-container">コンテナーって何？</a></li>
                        <li><a href="https://docker.events.cube365.net/dockercon/">DockerCon</a></li>
                        <li><b><a href="https://www.docker.com/products/overview">製品</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><a href="https://www.docker.com/roadmap">Docker 製品ロードマップ</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">機能</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">コンテナーランタイム</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">開発ツール</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">開発者</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">利用例</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Docker で遊ぶ</a></li>
                        <li><a href="https://www.docker.com/docker-community">コミュニティ</a></li>
                        <li><a href="https://www.docker.com/open-source">オープンソース</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker キャプテン</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">価格体系</a></b></li>
                        <li><a href="https://www.docker.com/pricing/faq">FAQ</a></li>
                        <li><a href="https://www.docker.com/partners/programs">Verified Publisher Program</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank" rel="noopener">会社</a></b></li>
                        <li><a href="https://www.docker.com/company">概要</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank" rel="noopener">ブログ</a></li>
                        <li><a href="https://www.docker.com/customers">顧客</a></li>
                        <li><a href="https://www.docker.com/partners">パートナー</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">ニュースルーム</a></li>
                        <li><a href="https://www.docker.com/careers">採用情報</a></li>
                        <li><a href="https://www.docker.com/company/contact">連絡先</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">ステータス</a></li>
                        <li><a href="https://www.docker.com/legal">法的情報</a></li>
                        <li><a href="https://www.docker.com/company/contact">連絡</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2021 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <script>const pageURL = "/engine/scan/";</script></body>
</html>
