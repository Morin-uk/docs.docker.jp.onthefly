
<p>Swarm に対して <a href="/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/deploy-service/">サービスのデプロイ</a> を行ったら、次は Docker CLI を使って、サービス内のコンテナー数のスケール変更を行います。
サービス内に起動しているコンテナーは「タスク」と呼びます。</p>

<ol>
  <li>
    <p>マシンへの接続ができていなければ、端末画面を開いて SSH により接続します。
接続先はマネージャーノードを起動したマシンです。
たとえばこのチュートリアルでは <code class="language-plaintext highlighter-rouge">manager1</code> というマシンを利用します。</p>
  </li>
  <li>
    <p>Swarm 内で起動しているサービスの状態を変更するため、以下のコマンドを実行します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service scale &lt;サービスID&gt;<span class="o">=</span>&lt;タスク数&gt;
</code></pre></div>    </div>

    <p>たとえば以下のとおりです。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service scale <span class="nv">helloworld</span><span class="o">=</span>5

helloworld scaled to 5
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">docker service ps &lt;サービスID&gt;</code> を実行して、タスク一覧が更新されていることを確認します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker service ps helloworld

NAME                                    IMAGE   NODE      DESIRED STATE  CURRENT STATE
helloworld.1.8p1vev3fq5zm0mi8g0as41w35  alpine  worker2   Running        Running 7 minutes
helloworld.2.c7a7tcdq5s0uk3qr88mf8xco6  alpine  worker1   Running        Running 24 seconds
helloworld.3.6crl09vdcalvtfehfh69ogfb1  alpine  worker1   Running        Running 24 seconds
helloworld.4.auky6trawmdlcne8ad8phb0f1  alpine  manager1  Running        Running 24 seconds
helloworld.5.ba19kca06l18zujfwxyc5lkyn  alpine  worker2   Running        Running 24 seconds
</code></pre></div>    </div>

    <p>この結果から Alpine Linux の実行インスタンスが合計で 5 つのタスクとなるように Swarm が 4 つの新たなタスクを実行したことがわかります。
このタスクは Swarm 上の 3 つのノード間に分散されています。
そのうちの 1 つが <code class="language-plaintext highlighter-rouge">manager1</code> 上で実行されています。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">docker ps</code> を実行して、接続しているノード上で実行されているコンテナーを確認します。
以下の例では <code class="language-plaintext highlighter-rouge">manager1</code> 上において実行されているタスクが示されます。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker ps

CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
528d68040f95        alpine:latest       <span class="s2">"ping docker.com"</span>   About a minute ago   Up About a minute                       helloworld.4.auky6trawmdlcne8ad8phb0f1
</code></pre></div>    </div>

    <p>他のノード上で起動しているコンテナーを確認するには、そのノードに SSH によりログインし、<code class="language-plaintext highlighter-rouge">docker ps</code> コマンドを実行します。</p>
  </li>
</ol>

<h2 id="whats-next">次にすることは</h2>

<p>チュートリアルのこの時点までで、<code class="language-plaintext highlighter-rouge">helloworld</code> サービスによる作業は終了です。
次の手順では <a href="/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/delete-service/">サービスの削除</a> について示します。</p>
