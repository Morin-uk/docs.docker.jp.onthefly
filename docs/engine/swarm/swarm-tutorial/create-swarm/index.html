
<p><a href="/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/">チュートリアルでのセットアップ</a> 手順をすべて終えたら、Swarm の生成を行います。
ホストマシン上において Docker Engine デーモンが起動済であることを確認してください。</p>

<ol>
  <li>
    <p>ターミナル画面を開き、マネージャーノードを起動させたいマシンに SSH 接続します。
このチュートリアルでは <code class="language-plaintext highlighter-rouge">manager1</code> というマシン名にします。
Docker Machine を利用している場合は、以下のコマンドを使って SSH 経由で接続することができます。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine ssh manager1
</code></pre></div>    </div>
  </li>
  <li>
    <p>以下のコマンドを実行して、新規に Swarm を生成します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker swarm init <span class="nt">--advertise-addr</span> &lt;MANAGER-IP&gt;
</code></pre></div>    </div>

    <blockquote>
      <p><strong>メモ</strong>: Docker Desktop for Mac または Docker Desktop for Windows 利用し単一ノードの Swarm を生成する場合は、引数なしで <code class="language-plaintext highlighter-rouge">docker swarm init</code> を実行します。
このときには <code class="language-plaintext highlighter-rouge">--advertise-addr</code> を指定する必要はありません。
詳しくは Swarm を使った <a href="/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/#use-docker-desktop-for-mac-or-docker-desktop-for-windows">Docker Desktop for Mac または Docker Desktop for Windows の利用</a> を参照してください。</p>
    </blockquote>

    <p>このチュートリアルでは、以下のコマンドにより <code class="language-plaintext highlighter-rouge">manager1</code> マシン上に Swarm が生成されます。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker swarm init <span class="nt">--advertise-addr</span> 192.168.99.100
Swarm initialized: current node <span class="o">(</span>dxn1zf6l61qsb1josjja83ngz<span class="o">)</span> is now a manager.

To add a worker to this swarm, run the following <span class="nb">command</span>:

    docker swarm <span class="nb">join</span> <span class="se">\</span>
    <span class="nt">--token</span> SWMTKN-1-49nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv-8vxv8rssmk743ojnwacrr2e7c <span class="se">\</span>
    192.168.99.100:2377

To add a manager to this swarm, run <span class="s1">'docker swarm join-token manager'</span> and follow the instructions.
</code></pre></div>    </div>

    <p><code class="language-plaintext highlighter-rouge">--advertise-addr</code> フラグはマネージャーノードに対して、アドレス <code class="language-plaintext highlighter-rouge">192.168.99.100</code> を公開することを指示します。
Swarm 上の他のノードは、マネージャーに対してこの IP アドレスを使ってアクセスしなければなりません。</p>

    <p>出力メッセージには、Swarm に新たなノードを参加させるためのコマンドが示されています。
参加させるノードをマネージャーとするかワーカーとするかは、<code class="language-plaintext highlighter-rouge">--token</code> フラグに与える値によって決まります。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">docker info</code> を実行して、Swarm の現時点での状態を確認してみます。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker info

Containers: 2
Running: 0
Paused: 0
Stopped: 2
  ...snip...
Swarm: active
  NodeID: dxn1zf6l61qsb1josjja83ngz
  Is Manager: <span class="nb">true
  </span>Managers: 1
  Nodes: 1
  ...snip...
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">docker node ls</code> コマンドを実行して、ノードに関する情報を確認します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker node <span class="nb">ls

</span>ID                           HOSTNAME  STATUS  AVAILABILITY  MANAGER STATUS
dxn1zf6l61qsb1josjja83ngz <span class="k">*</span>  manager1  Ready   Active        Leader

</code></pre></div>    </div>

    <p>ノード ID の横にある <code class="language-plaintext highlighter-rouge">*</code> が、現在接続しているノードを表わしています。</p>

    <p>Docker Engine の Swarm モードはマシンホスト名にちなんで、自動的にノードに名称がつけられます。
その他の出力カラムに関しては、後のステップにおいて説明します。</p>
  </li>
</ol>

<h2 id="whats-next">次にすることは</h2>

<p>本チュートリアルの次節では、クラスターに対して <a href="/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/add-nodes/">さらに 2 つのノードを追加</a> します。</p>
