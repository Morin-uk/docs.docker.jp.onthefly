
<blockquote>
  <p><strong>メモ</strong>: このページへはリダイレクトによりやってきたかもしれません。
お使いの Linux ディストリビューションでは、ダイナミックリンクによる Docker パッケージが提供されていないためです。</p>
</blockquote>

<p>Docker を利用したい、あるいはテスト環境で使いたいと思っても、お使いのプラットフォームでは Docker がサポートされていません。
そんなときはスタティックリンクされたバイナリをインストールしてみてください。
可能であれば、お使いのオペレーティングシステム用にビルドされたパッケージを使い、オペレーティングシステムのパッケージ管理方法に基づいて Docker のインストールやアップグレードを行ってください。
なお 32 ビットのスタティックバイナリには、Docker デーモンが含まれていない点に注意してください。</p>

<p>Docker デーモンに対するスタティックバイナリは、Linux でのみ利用可能です（<code class="language-plaintext highlighter-rouge">dockerd</code> として）。
Docker クライアントに対するスタティックバイナリは、Linux と macOS で利用可能です（<code class="language-plaintext highlighter-rouge">docker</code> として）。</p>

<p>ここでは Linux と macOS におけるバイナリモジュールのインストール方法を説明します。</p>

<ul>
  <li><a href="#install-daemon-and-client-binaries-on-linux">Linux においてデーモンとクライアントのバイナリをインストール</a></li>
  <li><a href="#install-client-binaries-on-macos">macOS においてクライアントのバイナリをインストール</a></li>
</ul>

<h2 id="install-daemon-and-client-binaries-on-linux">Linux においてデーモンとクライアントのバイナリをインストール</h2>

<h3 id="prerequisites">前提条件</h3>

<p>Docker のバイナリをインストールする場合には、ホストマシンが以下の前提条件を満たしていることを確認してください。</p>

<ul>
  <li>64 ビットシステム。</li>
  <li>Linux カーネルのバージョンは 3.10 またはそれ以上。
利用するプラットフォームが提供する最新カーネルを用いることを推奨。</li>
  <li><code class="language-plaintext highlighter-rouge">iptables</code> のバージョンは 1.4 またはそれ以上。</li>
  <li><code class="language-plaintext highlighter-rouge">git</code> のバージョンは 1.7 またはそれ以上。</li>
  <li><code class="language-plaintext highlighter-rouge">ps</code> 実行モジュールがあること。通常 <code class="language-plaintext highlighter-rouge">procps</code> あるいは類似パッケージが提供している。</li>
  <li><a href="https://tukaani.org/xz/">XZ Utils</a> のバージョンは 4.9 またはそれ以上。</li>
  <li><a href="https://github.com/tianon/cgroupfs-mount/blob/master/cgroupfs-mount"><code class="language-plaintext highlighter-rouge">cgroupfs</code> 階層が適切にマウントされていること</a>。
単純にすべてを取りまとめた <code class="language-plaintext highlighter-rouge">cgroup</code> マウントポイントでは不十分です。
Github の 以下の issue を参考にしてください。
<a href="https://github.com/moby/moby/issues/2683">#2683</a>、
<a href="https://github.com/moby/moby/issues/3485">#3485</a>、
<a href="https://github.com/moby/moby/issues/4568">#4568</a></li>
</ul>

<h4 id="secure-your-environment-as-much-as-possible">できるだけセキュアな環境を</h4>

<h5 id="os-considerations">OS に関すること</h5>

<p>利用可能であれば SELinux や AppArmor を有効にしてください。</p>

<p>利用する Linux ディストリビューションが SELinux または AppArmor をサポートしている場合は、それらを利用することを推奨します。
これを有効にしていればセキュリティは向上し、ある種のセキュリティ攻撃を防ぐことにもつながります。
SELinux や AppArmor を設定し有効にする手順については、各 Linux ディストリビューションのドキュメントを参照してください。</p>

<blockquote class="warning">
  <p>セキュリティ警告</p>

  <p>このセキュリティ機能を有効にしていた場合には、Docker やコンテナーを動作させたいからというので、機能を無効にするのはお止めください。
そのかわりに、正しく機能するように設定を適切に行ってください。</p>
</blockquote>

<h5 id="docker-daemon-considerations">Docker デーモンに関すること</h5>

<ul>
  <li>
    <p>利用可能であれば、セキュリティプロファイル <code class="language-plaintext highlighter-rouge">seccomp</code> を有効にしてください。
<a href="/docs.docker.jp.onthefly/engine/security/seccomp/">Docker における <code class="language-plaintext highlighter-rouge">seccomp</code> の利用</a> を参照。</p>
  </li>
  <li>
    <p>利用可能であればユーザー名前空間を有効にしてください。
<a href="/engine/reference/commandline/#daemon-user-namespace-options">デーモンのユーザー名前空間に関するオプション</a> を参照。</p>
  </li>
</ul>

<h3 id="install-static-binaries">スタティックバイナリのインストール</h3>

<ol>
  <li>
    <p>スタティックバイナリのアーカイブをダウンロードします。
<a href="https://download.docker.com/linux/static/stable/">https://download.docker.com/linux/static/stable/</a> へ行き、対応するハードウェアプラットフォーム向けのものを選びます。
（<code class="language-plaintext highlighter-rouge">stable</code> の部分は必要に応じて <code class="language-plaintext highlighter-rouge">nightly</code> や <code class="language-plaintext highlighter-rouge">test</code> とします。）
必要としている Docker Engine のバージョンに対応づいた <code class="language-plaintext highlighter-rouge">.tgz</code> ファイルをダウンロードします。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">tar</code> ユーティリティーを使ってアーカイブを展開します。
バイナリ <code class="language-plaintext highlighter-rouge">dockerd</code> と <code class="language-plaintext highlighter-rouge">docker</code> が抽出されます。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">tar </span>xzvf /path/to/&lt;FILE&gt;.tar.gz
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>任意の作業</strong>: 上のバイナリを実行パスの通ったディレクトリ、たとえば <code class="language-plaintext highlighter-rouge">/usr/bin/</code> などに移動させます。
この作業を行わない場合、<code class="language-plaintext highlighter-rouge">docker</code> や <code class="language-plaintext highlighter-rouge">dockerd</code> コマンドを起動する際には、常に実行ファイルへのパスも指定する必要があります。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo cp </span>docker/<span class="k">*</span> /usr/bin/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Docker デーモンを起動します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>dockerd &amp;
</code></pre></div>    </div>

    <p>デーモンに追加のオプションをつけて実行する必要がある場合は、上記のコマンドそれぞれを修正するか、あるいは設定ファイル <code class="language-plaintext highlighter-rouge">/etc/docker/daemon.json</code> を生成編集します。そこに必要な設定オプションを追加します。</p>
  </li>
  <li>
    <p>Docker が正しくインストールされたことを確認するために <code class="language-plaintext highlighter-rouge">hello-world</code> イメージを実行します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker run hello-world
</code></pre></div>    </div>

    <p>このコマンドはテストイメージをダウンロードして、コンテナー内で実行します。
コンテナーが起動すると、メッセージを表示して終了します。</p>
  </li>
</ol>

<h2 id="install-client-binaries-on-macos">macOS においてクライアントのバイナリをインストール</h2>

<p>macOS のバイナリには Docker クライアントのみが提供されます。
つまり <code class="language-plaintext highlighter-rouge">dockerd</code> デーモンは含まれていません。</p>

<ol>
  <li>
    <p>スタティックバイナリのアーカイブをダウンロードします。
<a href="https://download.docker.com/mac/static/stable/x86_64/">https://download.docker.com/mac/static/stable/x86_64/</a> へ行きます。
（<code class="language-plaintext highlighter-rouge">stable</code> の部分は必要に応じて <code class="language-plaintext highlighter-rouge">nightly</code> や <code class="language-plaintext highlighter-rouge">test</code> とします。）
必要としている Docker Engine のバージョンに対応づいた <code class="language-plaintext highlighter-rouge">.tgz</code> ファイルをダウンロードします。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">tar</code> ユーティリティーを使ってアーカイブを展開します。
バイナリ <code class="language-plaintext highlighter-rouge">docker</code> が抽出されます。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">tar </span>xzvf /path/to/&lt;FILE&gt;.tar.gz
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>任意の作業</strong>: 上のバイナリを実行パスの通ったディレクトリ、たとえば <code class="language-plaintext highlighter-rouge">/usr/local/bin/</code> などに移動させます。
この作業を行わない場合、<code class="language-plaintext highlighter-rouge">docker</code> や <code class="language-plaintext highlighter-rouge">dockerd</code> コマンドを起動する際には、常に実行ファイルへのパスも指定する必要があります。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo cp </span>docker/docker /usr/local/bin/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Docker が正しくインストールされたことを確認するために <code class="language-plaintext highlighter-rouge">hello-world</code> イメージを実行します。
<code class="language-plaintext highlighter-rouge">&lt;hostname&gt;</code> にはホスト名かその IP アドレスを指定します。
このホストは Docker デーモンが起動しているマシンのことであり、クライアントからアクセス可能であるものです。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>docker <span class="nt">-H</span> &lt;<span class="nb">hostname</span><span class="o">&gt;</span> run hello-world
</code></pre></div>    </div>

    <p>このコマンドはテストイメージをダウンロードして、コンテナー内で実行します。
コンテナーが起動すると、メッセージを表示して終了します。</p>
  </li>
</ol>

<h2 id="upgrade-static-binaries">スタティックバイナリのアップグレード</h2>

<p>Docker Engine を手動によりインストールしていて、これをアップデートする場合は、まずローカルで起動させている <code class="language-plaintext highlighter-rouge">dockerd</code> あるいは <code class="language-plaintext highlighter-rouge">dockerd.exe</code> のプロセスをすべて終了させます。
そして通常の手順により新しいバージョンをインストールします。</p>

<h2 id="next-steps">次のステップ</h2>

<ul>
  <li><a href="/docs.docker.jp.onthefly/engine/install/linux-postinstall/">Linux インストール後の作業</a> へ進む</li>
  <li><a href="/docs.docker.jp.onthefly/get-started/">Docker をはじめよう</a> に示すトレーニングを見てください。
イメージのビルド方法や、イメージをコンテナー化アプリケーションとして起動する方法を学んでいきます。</li>
  <li><a href="/docs.docker.jp.onthefly/develop/">Docker を用いた開発</a> における各項目を参照してください。
Docker を使ったアプリケーションの構築方法を学びます。</li>
</ul>
