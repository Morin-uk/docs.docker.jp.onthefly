<!-- Page generated 2020-10-09 12:58:46 +0900 -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>

  <meta name="robots" content="noindex"/>
  <title>Docker Machine とローカル VM を使ってはじめよう | Docker Documentation</title>
  <meta name="description" content="Get started with Docker Machine and a local VM" />
  <meta name="keywords" content="machine, virtualbox">
  <link rel="canonical" href="/machine/get-started/" />

  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css" id="pygments">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css" id="pagestyle">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">

  <!-- SEO stuff -->
  <meta name="twitter:title" itemprop="title name" content="Docker Machine とローカル VM を使ってはじめよう"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="" />
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="matsuand.github.io"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker ドキュメント"/>
  <meta property="og:title" content="Docker Machine とローカル VM を使ってはじめよう" />
  <meta property="og:description" content="Get started with Docker Machine and a local VM" />
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-10-09T12:58:46+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta property="og:locale" content="ja_JP" />
  <meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/machine/get-started/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <meta property="article:published_time" itemprop="datePublished" content="2020-10-09T12:58:46+09:00"/>
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Docker Machine とローカル VM を使ってはじめよう","description":"Get started with Docker Machine and a local VM","url":"https://docs.docker.com/machine/get-started/"}</script>
  <!-- END SEO STUFF -->
</head>


    <body class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/">
                <img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs">
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/docs.docker.jp.onthefly/">
        <img src="/docs.docker.jp.onthefly/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs">
    </a>
</div>
<div class="search-form" id="search-div">
    <form class="search-form form-inline" id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div id="tabs">
        <ul class="tabs jsTOCHorizontal"><li><a href="/docs.docker.jp.onthefly/" id="home">ホーム</a></li><li><a href="/docs.docker.jp.onthefly/get-started/overview/" id="guides">ガイド</a></li><li><a href="/docs.docker.jp.onthefly/engine/" id="manuals">製品マニュアル</a></li><li><a href="/docs.docker.jp.onthefly/reference/" id="reference">リファレンス</a></li><li><a href="/docs.docker.jp.onthefly/samples/" id="samples">サンプル</a></li></ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>Docker Machine とローカル VM を使ってはじめよう</h1> 
                            <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    7 分
  
</span>

                            
                            
<p><code class="highlighter-rouge">docker-machine</code>コマンドを使って、ローカルの仮想マシン内部に Docker ホストを生成して管理する方法を見ていきます。</p>

<h2 id="prerequisite-information">前提条件</h2>

<p><a href="../toolbox/overview.md">Docker Toolbox</a> に代わるものとして <a href="/docs.docker.jp.onthefly/docker-for-mac/">Docker Desktop for Mac</a> や <a href="/docs.docker.jp.onthefly/docker-for-windows/">Docker Desktop for Windows</a> が開発されているので、Docker を使った作業には、これらの新しいアプリケーションを利用することをお勧めします。
このアプリケーションを利用すれば Docker Machine を用いることなく、ローカルシステム上において Docker をネイティブに実行することができます。
（Mac 上における説明については <a href="/docs.docker.jp.onthefly/docker-for-mac/docker-toolbox/">Docker Desktop for Mac と Docker Toolbox</a> を参照してください。）</p>

<p>もっとも現在のところ、ローカルマシンを <strong>複数</strong> 生成するには Docker Machine がまだ必要になります。
Docker Machine では、複数ノードを用いたマシンの生成や管理を行うことができます。
Docker Desktop for Mac や Docker Desktop for Windows には、いずれも最新版の Docker Machine が含まれるため、どちらかをインストールしていれば<code class="highlighter-rouge">docker-machine</code>は入手できていることになります。</p>

<p>この新たなソリューションでは、Oracle VirtualBox を用いることなく、独自にネイティブな仮想技術を導入しています。
したがって Docker Machine を使ってローカル VM を生成していく上では、以下のことを覚えておいてください。</p>

<ul>
  <li>
    <p><strong>Docker Desktop for Mac</strong> - <code class="highlighter-rouge">docker-machine create</code>コマンドによって追加のローカルマシンを生成する際には、<code class="highlighter-rouge">virtualbox</code>ドライバーが用いられます。</p>
  </li>
  <li>
    <p><strong>Docker Desktop for Windows</strong> - <code class="highlighter-rouge">docker-machine create</code>コマンドによって追加のローカルマシンを生成する際には<code class="highlighter-rouge">hyperv</code>ドライバーが用いられます。</p>
  </li>
</ul>

<h4 id="if-you-are-using-docker-desktop-for-windows">Docker Desktop for Windows を使う場合</h4>

<p>Docker Desktop for Windows では、仮想化技術として <a href="https://msdn.microsoft.com/en-us/virtualization/hyperv_on_windows/windows_welcome">Microsoft Hyper-V</a> を用います。
Hyper-V は Oracle VirtualBox と互換性はありません。
したがってこの 2 つのソリューションを同時に実行することはできません。
<code class="highlighter-rouge">docker-machine</code>コマンドが Microsoft Hyper-V ドライバーを用いていれば、ローカル VM をさらに作り出していくことができます。</p>

<p>前提条件は以下のとおりです。</p>

<ul>
  <li>
    <p>Docker Desktop for Windows がインストールされていて、実行していることが必要です。
（実行するためには仮想化環境および Hyper-V が有効であることが必要です。
 このことは <a href="/docs.docker.jp.onthefly/docker-for-windows/install/#what-to-know-before-you-install">Docker Desktop for Windows をインストール前に確認すべきこと</a> において説明されています。）</p>
  </li>
  <li>
    <p>Hyper-V ドライバーを、外部の仮想ネットワークスイッチとして設定していることが必要です。
<a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/">Docker Machine の Microsoft Hyper-V 向けドライバー</a> のトピックを参照してください。
そこではこのドライバーをどのように用いるかの <a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/#example">利用例</a> を示しています。</p>
  </li>
</ul>

<h4 id="if-you-are-using-docker-desktop-for-mac">Docker Desktop for Mac を使う場合</h4>

<p>Docker Desktop for Mac では <a href="https://github.com/docker/HyperKit/">HyperKit</a> が用いられます。
これは macOS の軽量な仮想化ソリューションであり、<a href="https://developer.apple.com/reference/hypervisor">Hypervisor.framework</a> の最上位に構築されています。
.</p>

<p>現時点で<code class="highlighter-rouge">docker-machine create</code>が利用する HyperKit 用のドライバーはありません。
したがってローカルマシンの生成には<code class="highlighter-rouge">virtualbox</code>ドライバーが用いられます。
（<a href="/docs.docker.jp.onthefly/machine/drivers/virtualbox/">Docker Machine の Oracle VirtualBox 向けドライバー</a> を参照してください。）
HyperKit と Oracle VirtualBox は 1 つのシステム上に稼動させることができます。
詳しくは <a href="/docs.docker.jp.onthefly/docker-for-mac/docker-toolbox/">Docker Desktop for Mac と Docker Toolbox</a> を参照してください。</p>

<ul>
  <li><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" class="_">最新版の VirtualBox</a> が正しくインストールされていることを確認してください。
（すでに示した ToolBox の一部としてインストールしているか、直接インストールしているかのどちらでもかまいません。）</li>
</ul>

<h4 id="if-you-are-using-docker-toolbox">Docker Toolbox を使う場合</h4>

<p>Docker Desktop for Mac と Docker Desktop for Windows では、それぞれのオペレーティングシステムの最新版を必要とします。
したがってシステムバージョンが古いユーザーは Docker Toolbox を利用しなければなりません。</p>

<ul>
  <li>
    <p>Docker Toolbox を Mac 上において、あるいは（Hyper-V がない）古い Windows 上において利用している場合は、Oracle <a href="https://www.virtualbox.org/" target="_blank" class="_">VirtualBox</a> に基づいたローカルマシンを生成する際に<code class="highlighter-rouge">virtualbox</code>ドライバーが用いられます。
（<a href="/docs.docker.jp.onthefly/machine/drivers/virtualbox/">Docker Machine の Oracle VirtualBox 向けドライバー</a> を参照してください。）</p>
  </li>
  <li>
    <p>Docker Toolbox を Windows 上で利用している場合で、Hyper-V 機能はあるものの Docker Desktop for Windows は稼動させていない場合（たとえば Windows 8 pro の場合）には、ローカルマシンの生成に<code class="highlighter-rouge">hyperv</code>ドライバーが必要になります。
（<a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/">Docker Machine の Microsoft Hyper-V 向けドライバー</a> を参照してください。）</p>
  </li>
  <li>
    <p><a href="https://www.virtualbox.org/wiki/Downloads" target="_blank" class="_">最新版の VirtualBox</a> が正しくインストールされていることを確認してください。
<a href="https://www.docker.com/products/docker-toolbox" target="_blank" class="_">Toolbox</a> または <a href="/docs.docker.jp.onthefly/docker-for-windows/" target="_blank" class="_">Docker Desktop for Windows</a> を利用して Docker Machine がインストールできている場合、VirtualBox は自動的にインストールされています。</p>
  </li>
  <li>
    <p>Quickstart Terminal を利用してマシン起動を行っていて、ターミナル画面の環境を設定済みである場合、デフォルトのマシンは自動的に生成されています。
その場合でも、ここに示す手順に従って進めることはできます。
ただしマシンは別のものを生成して、その名前は<code class="highlighter-rouge">default</code>以外のものにしてください。</p>
  </li>
</ul>

<h2 id="use-machine-to-run-docker-containers">Docker Machine を使ったコンテナーの起動</h2>

<p>Docker コンテナーを実行するには、以下を行います。</p>

<ul>
  <li>新しい Docker 仮想マシンを生成します（あるいは既存の仮想マシンを起動します）。</li>
  <li>環境変数を新しい仮想マシンに切り替えます。</li>
  <li>docker クライアントを使ってコンテナーの作成、ロード、管理を行います。</li>
</ul>

<p>Docker Machine で生成したマシンは、必要に応じて何度でも再利用できます。
そのマシンは VirtualBox 上にあるそれまでの仮想マシンと同じものであり、どちらでも同じ設定が使われます。</p>

<p>以下の例では、マシンの生成、起動、 Docker コマンドの実行、コンテナーの使い方を見ていきます。</p>

<h2 id="create-a-machine">マシンの生成</h2>

<ol>
  <li>
    <p>コマンドシェルやターミナル画面を開きます。</p>

    <p>以下の例では Bash シェルを扱います。
 C シェルのような他のシェルでは、動作しないコマンドがあるかもしれないので注意してください。</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">docker-machine ls</code>を使って利用可能なマシンの一覧を表示します。</p>

    <p>以下の例では、マシンがまだ 1 台も生成されていないことがわかります。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker-machine ls
 NAME   ACTIVE   DRIVER   STATE   URL   SWARM   DOCKER   ERRORS
</code></pre></div>    </div>
  </li>
  <li>
    <p>マシンを生成します。</p>

    <p>コマンド<code class="highlighter-rouge">docker-machine create</code>を実行します。
 引数として<code class="highlighter-rouge">--driver</code>フラグには適切なドライバー名を指定し、マシン名を与えます。
 マシンを生成するのはこれが初めての場合、例に示しているように名称は<code class="highlighter-rouge">default</code>としてください。
 すでに「default｣というマシンが存在している場合は、別のマシン名を指定します。</p>

    <ul>
      <li>
        <p>利用しているシステムが以下の場合、つまり Toolbox on Mac であるか、Hyper-V のない古い Windows 上でのToolbox か、Docker Desktop for Mac である場合、ドライバーとしては、例に示しているように<code class="highlighter-rouge">virtualbox</code>を指定します。
（Docker Machine の VirtualBox 向けドライバーのリファレンスは <a href="/docs.docker.jp.onthefly/machine/drivers/virtualbox/">こちら</a> にあります。）
（<a href="/docs.docker.jp.onthefly/machine/get-started/#prerequisite-information">prerequisites</a> を再度確認してください。）</p>
      </li>
      <li>
        <p>Hyper-V をサポートしている Windows 上において Docker Desktop for Windows を利用いている場合は<code class="highlighter-rouge">hyperv</code>ドライバーを指定します。
このドライバーについては <a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/">Docker Machine の Microsoft Hyper-V 向けドライバーリファレンス</a> に示されています。
そこにある <a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/#example">利用例</a> に従ってください。
そこでは外部ネットワークスイッチの利用方法を示すとともに、各コマンドのフラグについて説明しています。
（詳しくは上の <a href="/docs.docker.jp.onthefly/machine/get-started/#prerequisite-information">前提条件</a> を参照してください。）</p>

        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  $ docker-machine create --driver virtualbox default
  Running pre-create checks...
  Creating machine...
  (staging) Copying /Users/ripley/.docker/machine/cache/boot2docker.iso to /Users/ripley/.docker/machine/machines/default/boot2docker.iso...
  (staging) Creating VirtualBox VM...
  (staging) Creating SSH key...
  (staging) Starting the VM...
  (staging) Waiting for an IP...
  Waiting for machine to be running, this may take a few minutes...
  Machine is running, waiting for SSH to be available...
  Detecting operating system of created instance...
  Detecting the provisioner...
  Provisioning with boot2docker...
  Copying certs to the local machine directory...
  Copying certs to the remote machine...
  Setting Docker configuration on the remote daemon...
  Checking connection to Docker...
  Docker is up and running!
  To see how to connect Docker to this machine, run: docker-machine env default
</code></pre></div>        </div>

        <p>このコマンドは、インストールされている Docker デーモンを利用して、軽量 Linux ディストリビューション (<a href="https://github.com/boot2docker/boot2docker" target="_blank" class="_">boot2docker</a>) をダウンロードします。
そして稼動中の Docker を利用して VirtualBox 仮想マシンを生成し起動します。</p>
      </li>
    </ul>
  </li>
  <li>
    <p>再びマシン一覧を確認すると、新たに生成されたマシンが表示されています。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker-machine ls
 NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER   ERRORS
 default   *        virtualbox   Running   tcp://192.168.99.187:2376           v1.9.1
</code></pre></div>    </div>
  </li>
  <li>
    <p>新しい仮想マシン用の、環境変数設定のためのコマンドを取得します。</p>

    <p><code class="highlighter-rouge">docker-machine create</code>コマンドの出力に示されているように、新たに生成したマシンとのやりとりを行うために、Docker に対する設定が必要です。
 これには<code class="highlighter-rouge">docker-machine env</code>コマンドを実行します。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker-machine env default
 export DOCKER_TLS_VERIFY="1"
 export DOCKER_HOST="tcp://172.16.62.130:2376"
 export DOCKER_CERT_PATH="/Users/&lt;yourusername&gt;/.docker/machine/machines/default"
 export DOCKER_MACHINE_NAME="default"
 # Run this command to configure your shell:
 # eval "$(docker-machine env default)"
</code></pre></div>    </div>
  </li>
  <li>
    <p>シェルから新しいマシンに接続します。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ eval "$(docker-machine env default)"
</code></pre></div>    </div>

    <p><strong>メモ</strong>: <code class="highlighter-rouge">fish</code>や Powershell、<code class="highlighter-rouge">cmd.exe</code>のような Windows シェルでは、先ほどのコマンドは実行できません。
   利用するシェルにおいて環境変数を有効にする方法は、<a href="/docs.docker.jp.onthefly/machine/reference/env/" target="_blank" class="_">the <code class="highlighter-rouge">env</code> command’s documentation</a> を参照してください。</p>

    <p>カレントなシェル上でこの環境変数設定を使えば、クライアントはその TLS 設定を読み込みます。
 新しいシェルの起動時やマシン再起動時には、再度指定する必要があります。
 （<a href="/docs.docker.jp.onthefly/machine/get-started/#unset-environment-variables-in-the-current-shell">カレントシェルの環境変数クリア</a> も参照してください。）</p>

    <p>こうしてホスト上において Docker コマンドを実行します。</p>
  </li>
</ol>

<h2 id="run-containers-and-experiment-with-machine-commands">Docker Machine のコマンドを使ったコンテナー実行</h2>

<p><code class="highlighter-rouge">docker run</code>コマンドによりコンテナーを起動することで、セットアップができていることを確認します。</p>

<ol>
  <li>
    <p><code class="highlighter-rouge">docker run</code>コマンドを実行して<code class="highlighter-rouge">busybox</code>イメージをダウンロードし、単純に「echo」コマンドを実行する<code class="highlighter-rouge">busybox</code>を起動します。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker run busybox echo hello world
 Unable to find image 'busybox' locally
 Pulling repository busybox
 e72ac664f4f0: Download complete
 511136ea3c5a: Download complete
 df7546f9f060: Download complete
 e433a6c5b276: Download complete
 hello world
</code></pre></div>    </div>
  </li>
  <li>
    <p>ホストの IP アドレスを確認します。</p>

    <p>Docker ホスト上の IP アドレスに対して、公開されるポートはすべて利用できます。
 これは<code class="highlighter-rouge">docker-machine ip</code>コマンドを実行して確認できます。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker-machine ip default
 192.168.99.100
</code></pre></div>    </div>
  </li>
  <li>
    <p>コンテナー内においてウェブサーバー <a href="https://www.nginx.com/" target="_blank" class="_">Nginx</a> を起動するために、以下のコマンドを実行します。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker run -d -p 8000:80 nginx
</code></pre></div>    </div>

    <p>イメージのプルが完了したら、サーバーに対してポート 8000 によりアクセスします。
 IP アドレスは<code class="highlighter-rouge">docker-machine ip</code>で得られるものを利用します。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     $ curl $(docker-machine ip default):8000
     <span class="cp">&lt;!DOCTYPE html&gt;</span>
     <span class="nt">&lt;html&gt;</span>
     <span class="nt">&lt;head&gt;</span>
     <span class="nt">&lt;title&gt;</span>Welcome to nginx!<span class="nt">&lt;/title&gt;</span>
     <span class="nt">&lt;style&gt;</span>
         <span class="nt">body</span> <span class="p">{</span>
             <span class="nl">width</span><span class="p">:</span> <span class="m">35em</span><span class="p">;</span>
             <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="nb">auto</span><span class="p">;</span>
             <span class="nl">font-family</span><span class="p">:</span> <span class="n">Tahoma</span><span class="p">,</span> <span class="n">Verdana</span><span class="p">,</span> <span class="n">Arial</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
         <span class="p">}</span>
     <span class="nt">&lt;/style&gt;</span>
     <span class="nt">&lt;/head&gt;</span>
     <span class="nt">&lt;body&gt;</span>
     <span class="nt">&lt;h1&gt;</span>Welcome to nginx!<span class="nt">&lt;/h1&gt;</span>
     <span class="nt">&lt;p&gt;</span>If you see this page, the nginx web server is successfully installed and
     working. Further configuration is required.<span class="nt">&lt;/p&gt;</span>

     <span class="nt">&lt;p&gt;</span>For online documentation and support, refer to
     <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://nginx.org/"</span><span class="nt">&gt;</span>nginx.org<span class="nt">&lt;/a&gt;</span>.<span class="nt">&lt;br/&gt;</span>
     Commercial support is available at
     <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"http://nginx.com/"</span><span class="nt">&gt;</span>nginx.com<span class="nt">&lt;/a&gt;</span>.<span class="nt">&lt;/p&gt;</span>

     <span class="nt">&lt;p&gt;&lt;em&gt;</span>Thank you for using nginx.<span class="nt">&lt;/em&gt;&lt;/p&gt;</span>
     <span class="nt">&lt;/body&gt;</span>
     <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
  </li>
</ol>

<p>ローカルのリソースが許す限り、Docker を起動するローカル VM はいくらでも生成して管理することができます。
  そのときには、再度<code class="highlighter-rouge">docker-machine create</code>を実行するだけです。
  生成したマシンは、<code class="highlighter-rouge">docker-machine ls</code>の出力結果にすべて表示されます。</p>

<h2 id="start-and-stop-machines">マシンの起動と停止</h2>

<p>ホストの利用が終わってしばらくたったものは、<code class="highlighter-rouge">docker-machine stop</code>を実行して停止しておきます。
後に起動したくなったら<code class="highlighter-rouge">docker-machine start</code>を実行します。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    $ docker-machine stop default
    $ docker-machine start default
</code></pre></div></div>

<h2 id="operate-on-machines-without-specifying-the-name">マシン名指定なしの操作</h2>

<p><code class="highlighter-rouge">docker-machine</code>コマンドにおいてマシン名を指定しなかった場合、操作の対象を<code class="highlighter-rouge">default</code>という名のマシン（それが存在している場合に限り）であるものとして処理するものがあります。
ローカル VM は<code class="highlighter-rouge">default</code>という名前にするのが通常であるため、何度も利用する Docker Machine コマンドにおいては、入力を省くことができます。</p>

<p>たとえば以下のとおりです。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      $ docker-machine stop
      Stopping "default"....
      Machine "default" was stopped.

      $ docker-machine start
      Starting "default"...
      (default) Waiting for an IP...
      Machine "default" was started.
      Started machines may have new IP addresses.  You may need to re-run the `docker-machine env` command.

      $ eval $(docker-machine env)

      $ docker-machine ip
        192.168.99.100
</code></pre></div></div>

<p>このような扱いとしているコマンドは、以下のものです。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    - `docker-machine config`
    - `docker-machine env`
    - `docker-machine inspect`
    - `docker-machine ip`
    - `docker-machine kill`
    - `docker-machine provision`
    - `docker-machine regenerate-certs`
    - `docker-machine restart`
    - `docker-machine ssh`
    - `docker-machine start`
    - `docker-machine status`
    - `docker-machine stop`
    - `docker-machine upgrade`
    - `docker-machine url`
</code></pre></div></div>

<p><code class="highlighter-rouge">default</code>以外のマシンを扱う場合や、上記以外のコマンドを利用する場合は、コマンドの引数に必ずマシン名を指定する必要があります。</p>

<h2 id="unset-environment-variables-in-the-current-shell">カレントシェルにおける環境変数クリア</h2>

<p>カレントなシェルから、今までとは違う Docker Engine に接続したい場合があります。
たとえば <a href="/docs.docker.jp.onthefly/docker-for-mac/docker-toolbox/">Docker Desktop for Mac と Docker Toolbox を同時実行</a> している場合であって、2 つの Docker Engine に接続する必要がある場合です。
こういった場合、カレントなシェルが別の Docker Engine に接続するように、環境を切り替えることができます。</p>

<ol>
  <li>
    <p><code class="highlighter-rouge">env|grep DOCKER</code>を実行して、DOCKER 関連の環境変数 が設定されているかどうかを確認します。</p>

    <pre><code class="language-none">$ env | grep DOCKER
DOCKER_HOST=tcp://192.168.99.100:2376
DOCKER_MACHINE_NAME=default
DOCKER_TLS_VERIFY=1
DOCKER_CERT_PATH=/Users/&lt;your_username&gt;/.docker/machine/machines/default
</code></pre>

    <p>（例に示すように）出力結果が返されたら、この<code class="highlighter-rouge">DOCKER</code>関連の環境変数をクリアします。</p>
  </li>
  <li>
    <p>カレントシェルにおいて DOCKER 関連の環境変数をクリアするには、以下のいずれかの方法をとります。</p>

    <ul>
      <li>
        <p><code class="highlighter-rouge">unset</code>コマンドに続けて<code class="highlighter-rouge">DOCKER</code>関連の環境変数を指定して実行します。</p>

        <pre><code class="language-none">unset DOCKER_TLS_VERIFY
unset DOCKER_CERT_PATH
unset DOCKER_MACHINE_NAME
unset DOCKER_HOST
</code></pre>
      </li>
      <li>
        <p>もう 1 つの方法は、ショートカットコマンド<code class="highlighter-rouge">docker-machine env -u</code>を実行して、DOCKER 関連の環境変数をクリアするコマンドを表示させます。</p>

        <pre><code class="language-none">$ docker-machine env -u
unset DOCKER_TLS_VERIFY
unset DOCKER_HOST
unset DOCKER_CERT_PATH
unset DOCKER_MACHINE_NAME
# Run this command to configure your shell:
# eval $(docker-machine env -u)
</code></pre>

        <p><code class="highlighter-rouge">eval $(docker-machine env -u)</code>を実行して、カレントなシェル上における DOCKER 関連の環境変数をクリアします。</p>
      </li>
    </ul>
  </li>
  <li>
    <p>そこでもう一度、先ほどのコマンドを実行してみます。
何も出力されなくなったはずです。</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ env | grep DOCKER
</code></pre></div>    </div>

    <p>Docker Desktop for Mac を利用している場合、同時にインストールされる Docker Engine とのやりとりを Docker コマンドにより行います。</p>

    <p><a href="/docs.docker.jp.onthefly/docker-for-windows/install/#what-to-know-before-you-install">Docker Desktop for Windows は Toolbox と非互換</a> であることから、ここに示した方法は、その場合には利用できません。
 Docker Desktop for Windows が利用するのは、同時にインストールされる Docker Engine と Docker Machine だからです。</p>
  </li>
</ol>

<h2 id="start-local-machines-on-startup">起動時におけるローカルマシン起動</h2>

<p>シェルを起動する際に、自動的に Docker クライアントが設定されるようにするには、シェルプロファイルに<code class="highlighter-rouge">eval $(docker-machine env default)</code>を書き入れます。
具体的には<code class="highlighter-rouge">~/.bash_profile</code>ファイルか、あるいはこれに相当する設定ファイルに記述します。
ただし<code class="highlighter-rouge">default</code>というマシンが実行中でない場合に、この記述はエラーとなります。
そこでシステム起動時に<code class="highlighter-rouge">default</code>マシンが自動的に起動されるように設定します。
以下の例は macOS において、それを実現するものです。</p>

<p><code class="highlighter-rouge">~/Library/LaunchAgents</code>の配下に<code class="highlighter-rouge">com.docker.machine.default.plist</code>というファイルを生成し、内容を以下のようにします。</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>EnvironmentVariables<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;dict&gt;</span>
            <span class="nt">&lt;key&gt;</span>PATH<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;string&gt;</span>/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;/dict&gt;</span>
        <span class="nt">&lt;key&gt;</span>Label<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;string&gt;</span>com.docker.machine.default<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;key&gt;</span>ProgramArguments<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;array&gt;</span>
            <span class="nt">&lt;string&gt;</span>/usr/local/bin/docker-machine<span class="nt">&lt;/string&gt;</span>
            <span class="nt">&lt;string&gt;</span>start<span class="nt">&lt;/string&gt;</span>
            <span class="nt">&lt;string&gt;</span>default<span class="nt">&lt;/string&gt;</span>
        <span class="nt">&lt;/array&gt;</span>
        <span class="nt">&lt;key&gt;</span>RunAtLoad<span class="nt">&lt;/key&gt;</span>
        <span class="nt">&lt;true/&gt;</span>
    <span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</code></pre></div></div>

<p>上の<code class="highlighter-rouge">default</code>の記述を変更すれば、<code class="highlighter-rouge">LaunchAgent</code>から起動するマシンを別のものにすることがでｋます。</p>

<h2 id="where-to-go-next">次に読むものは</h2>

<ul>
  <li><a href="/docs.docker.jp.onthefly/machine/get-started-cloud/">クラウドプロバイダー</a> 上に複数の Docker ホストをプロビジョニングします。</li>
  <li><a href="/docs.docker.jp.onthefly/machine/concepts/">Machine の考え方</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/drivers/">Docker Machine に対応する全ドライバーのリファレンス一覧</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/drivers/virtualbox/">Docker Machine ドライバー Oracle VirtualBox 用</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/drivers/hyper-v/">Docker Machine ドライバー Microsoft Hyper-V 用</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/reference/"><code class="highlighter-rouge">docker-machine</code>コマンドラインリファレンス</a></li>
</ul>

                            <!-- tags -->
                            
                            <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span
                                style="vertical-align: 2px"><a
                                    href="/docs.docker.jp.onthefly/search/?q=machine">machine</a>, <a
                                    href="/docs.docker.jp.onthefly/search/?q=virtualbox">virtualbox</a></span>
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px;">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "machine/get-started.md",
                                        "title": "Docker Machine とローカル VM を使ってはじめよう",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/master/machine/get-started.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav jsTOCHorizontal hidden-md hidden-lg">
    </ul>
    <div class="divider hidden-md hidden-lg"></div>
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/edit/master/src/machine/get-started.ch"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=ファイル: [machine/get-started.ch](https://matsuand.github.io/docs.docker.jp.onthefly/machine/get-started/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#prerequisite-information" class="nomunge">前提条件</a></li>
  <li><a href="#use-machine-to-run-docker-containers" class="nomunge">Docker Machine を使ったコンテナーの起動</a></li>
  <li><a href="#create-a-machine" class="nomunge">マシンの生成</a></li>
  <li><a href="#run-containers-and-experiment-with-machine-commands" class="nomunge">Docker Machine のコマンドを使ったコンテナー実行</a></li>
  <li><a href="#start-and-stop-machines" class="nomunge">マシンの起動と停止</a></li>
  <li><a href="#operate-on-machines-without-specifying-the-name" class="nomunge">マシン名指定なしの操作</a></li>
  <li><a href="#unset-environment-variables-in-the-current-shell" class="nomunge">カレントシェルにおける環境変数クリア</a></li>
  <li><a href="#start-local-machines-on-startup" class="nomunge">起動時におけるローカルマシン起動</a></li>
  <li><a href="#where-to-go-next" class="nomunge">次に読むものは</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">なぜ Docker なのか？</a></b></li>
                        <li><a href="https://www.docker.com/what-container">コンテナーって何？</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">製品</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">機能</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">コンテナーランタイム</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">開発ツール</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">開発者</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">利用例</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Docker で遊ぶ</a></li>
                        <li><a href="https://www.docker.com/docker-community">コミュニティ</a></li>
                        <li><a href="https://www.docker.com/open-source">オープンソース</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker キャプテン</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">会社</a></b></li>
                        <li><a href="https://www.docker.com/company">概要</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">ブログ</a></li>
                        <li><a href="https://www.docker.com/customers">顧客</a></li>
                        <li><a href="https://www.docker.com/partners">パートナー</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">ニュースルーム</a></li>
                        <li><a href="https://www.docker.com/careers">採用情報</a></li>
                        <li><a href="https://www.docker.com/company/contact">連絡先</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">ステータス</a></li>
                        <li><a href="https://www.docker.com/docker-security">セキュリティ</a></li>
                        <li><a href="https://www.docker.com/legal">法的情報</a></li>
                        <li><a href="https://www.docker.com/company/contact">連絡</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script>var pageURL = "/machine/get-started/";</script>
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/search.js"></script>
</body>


</html>
