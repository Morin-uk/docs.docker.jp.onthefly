
<p>Docker Machine を用いて以下を行います。</p>

<ul>
  <li>Mac や Windows 上に Docker をインストールして実行します。</li>
  <li>複数のリモート Docker ホストを導入し管理します。</li>
  <li>Swarm クラスターを導入します。</li>
</ul>

<h2 id="what-is-docker-machine">Docker Machine とは何か</h2>

<p>Docker Machine は仮想ホスト上への Docker Engine のインストールを可能にするツールです。
ホストの管理には<code class="language-plaintext highlighter-rouge">docker-machine</code>コマンドを利用します。
Machine を利用して、ローカルの Mac や Windows マシン上に Docker ホストを生成できます。
さらに企業ネットワーク上やデータセンター、Azure、AWS、DigitalOcean といったクラウドプロバイダー上においても生成可能です。</p>

<p><code class="language-plaintext highlighter-rouge">docker-machine</code>コマンドを使って、管理するホストの起動、確認、停止、再起動を行います。
また Docker クライアントやデーモンのアップグレードや、手元のホストにおいて Docker クライアントを利用する設定を行います。</p>

<p>Machine CLI の操作対象として実行中の管理ホストを設定したら、そのホスト上において直接<code class="language-plaintext highlighter-rouge">docker</code>コマンドを実行します。
たとえば<code class="language-plaintext highlighter-rouge">docker-machine env default</code>コマンドを実行すると、対象のホストが<code class="language-plaintext highlighter-rouge">default</code>となります。
画面上に表示される<code class="language-plaintext highlighter-rouge">env</code>命令を設定して、<code class="language-plaintext highlighter-rouge">docker ps</code>や<code class="language-plaintext highlighter-rouge">docker run hello-world</code>などを実行していきます。</p>

<p>Docker Machine は、Docker v1.12 以前は Mac および Windows 上において Docker を実行する唯一の方法<strong>でした</strong>。
Docker v1.12 のベータ版として始まったプログラムが、<a href="/docs.docker.jp.onthefly/docker-for-mac/">Docker Desktop for Mac</a> と <a href="/docs.docker.jp.onthefly/docker-for-windows/">Docker Desktop for Windows</a> というネイティブアプリとして利用可能になり、これが最新のデスクトップやノート PC に対しての最適な選択肢となりました。
現在ではこれらの新しいアプリケーションの利用をお勧めしています。
Docker Desktop for Mac や Docker Desktop for Windows のインストーラーには、Docker Machine や Docker Compose が含まれています。</p>

<p>どこからはじめたらよいのか不明であれば、<a href="/docs.docker.jp.onthefly/get-started/">Docker をはじめよう</a> を確認してください。
このガイドでは Docker の全般的なチュートリアルを示しています。</p>

<h2 id="why-should-i-use-it">利用する理由は</h2>

<p>Docker Machine を利用すると、さまざまな種類の Linux に対して、リモート Docker ホストを複数プロビジョングできます。</p>

<p>さらに Docker Machine は上で述べているように、Mac や Windows の古いシステムにおいて Docker を起動させることができます。</p>

<p>Docker Machine は、以下の 2 つの利用がよく行われています。</p>

<ul>
  <li>
    <p><strong>Mac や Windows のデスクトップシステムが古いけど Docker を実行したい</strong></p>

    <p><img src="/docs.docker.jp.onthefly/machine/img/machine-mac-win.png" alt="Mac と Windows 上の Docker Machine" class="white-bg" /></p>

    <p>主に作業をしているマシンが Mac や Windows の古いデスクトップやノート PC であって、<a href="/docs.docker.jp.onthefly/docker-for-mac/">Docker Desktop for Mac</a> や <a href="/docs.docker.jp.onthefly/docker-for-windows/">Docker Desktop for Windows</a> という新たなアプリを利用する前提条件を満たしていない場合、Docker Engine をローカルで実行するには Docker Machine が必要になります。</p>
  </li>
  <li>
    <p><strong>リモートシステムに対して Docker ホストをプロビジョニングしたい</strong></p>

    <p><img src="/docs.docker.jp.onthefly/machine/img/provision-use-case.png" alt="複数システムをプロビジョニングする Docker Machine" class="white-bg" /></p>

    <p>Docker Engine は Linux システム上でネイティブに動作します。
主に利用するシステムが Linux であって <code class="language-plaintext highlighter-rouge">docker</code>コマンドを利用したいのであれば、やるべきことは、単に Docker Engine をダウンロードしてインストールするだけです。
ただしネットワーク上に複数の Docker ホストを効率よくプロビジョニングしたい場合は、クラウド上とローカル上は問わず Docker Machine が必要になります。</p>

    <p>ふだん利用するシステムが Mac、Windows、Linux のどれであっても、Docker Machine をインストールして<code class="language-plaintext highlighter-rouge">docker-machine</code>コマンドを使えば、いくらでも Docker ホストのプロビジョニングと管理が可能になります。
Docker Machine からはホストが自動生成され、そのホスト内に Docker Engine がインストールされます。
そして<code class="language-plaintext highlighter-rouge">docker</code>クライアントが設定されます。
こうして管理される各ホスト（「<strong>マシン</strong>」）が、Docker ホストと設定済みクライアントを結びつけます。</p>
  </li>
</ul>

<h2 id="whats-the-difference-between-docker-engine-and-docker-machine">Docker Engine と Docker Machine はどう違うのか</h2>

<p>「Docker」と言えば、普通は <strong>Docker Engine</strong> のことを意味します。
これは Docker デーモンによって構成されるクライアントサーバーアプリケーションであり、デーモンとのやりとりを行うためのインターフェースを規定する REST API であり、デーモンとの対話を（REST API ラッパーを通じて）行うコマンドラインインターフェース（CLI）をすべて意味しています。
Docker Engine は CLI から<code class="language-plaintext highlighter-rouge">docker</code>コマンド、たとえば<code class="language-plaintext highlighter-rouge">docker run &lt;イメージ名&gt;</code>を受けつけます。
あるいは<code class="language-plaintext highlighter-rouge">docker ps</code>によって実行中コンテナーの一覧を表示し、<code class="language-plaintext highlighter-rouge">docker image ls</code>によってイメージ一覧を表示するといった具合です。</p>

<p><img src="/docs.docker.jp.onthefly/machine/img/engine.png" alt="Docker Engine" /></p>

<p><strong>Docker Machine</strong> とは、Docker 化されたホスト（Docker Engine がインストールされたホスト）をプロビジョニングして管理するツールのことです。
通常はローカルシステムに Docker Machine をインストールして利用します。
Docker Machine には独自のコマンドラインクライアント<code class="language-plaintext highlighter-rouge">docker-machine</code>と Docker Engine クライアント<code class="language-plaintext highlighter-rouge">docker</code>があります。
Docker Machine を利用して、必要な分だけ仮想システムに Docker Engine をインストールできます。
この仮想システムはローカル上に実現（Mac や Windows 上の VirtualBox において Docker Engine をインストールし実行）することもでき、リモート上に（Machine を使ってクラウドプロバイダー上に Docker 化したホストをプロビジョニングしたり）することができます。
Docker 化されたこのホストが、管理された「<strong>Machine</strong>」と認識され、そう呼ばれます。</p>

<p><img src="/docs.docker.jp.onthefly/machine/img/machine.png" alt="Docker Machine" class="white-bg" /></p>

<h2 id="where-to-go-next">次に読むものは</h2>

<ul>
  <li><a href="/docs.docker.jp.onthefly/machine/install-machine/">Docker Machine のインストール</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/get-started/">VirtualBox 利用によるローカルシステム</a> に Docker ホストを生成して実行します。</li>
  <li><a href="/docs.docker.jp.onthefly/machine/get-started-cloud/">クラウドプロバイダー</a> 上に複数の Docker ホストをプロビジョニングします。</li>
  <li><a href="../swarm/provision-with-machine.md">Docker Machine を使った Docker Swarm クラスターのプロビジョニング</a> （かつての Swarm）</li>
  <li><a href="/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/">Swarm モードをはじめよう</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/concepts/">Machine の考え方</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/drivers/">Docker Machine ドライバーリファレンス</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/reference/">Docker Machine サブコマンドリファレンス</a></li>
  <li><a href="/docs.docker.jp.onthefly/machine/migrate-to-machine/">Boot2Docker から Docker Machine への移行</a></li>
</ul>
