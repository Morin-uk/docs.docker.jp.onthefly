<p>Create machines using an existing VM/Host with SSH.</p>

<p>This is useful if you are using a provider that Machine does not support
directly or if you would like to import an existing host to allow Docker
Machine to manage.</p>

<p>The driver performs a list of tasks on create:</p>

<ul>
  <li>If docker is not running on the host, it is installed automatically.</li>
  <li>It updates the host packages (<code class="language-plaintext highlighter-rouge">apt-get update</code>, <code class="language-plaintext highlighter-rouge">yum update</code>...).</li>
  <li>It generates certificates to secure the docker daemon.</li>
  <li>If the host uses systemd, it creates /etc/systemd/system/docker.service.d/10-machine.conf</li>
  <li>The docker daemon restarts, thus all running containers are stopped.</li>
  <li>The hostname is updated to fit the machine name.</li>
</ul>

<h3 id="example">Example</h3>

<p>To create a machine instance, specify <code class="language-plaintext highlighter-rouge">--driver generic</code>, the IP address or DNS
name of the host and the path to the SSH private key authorized to connect
to the host.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-machine create \
  --driver generic \
  --generic-ip-address=203.0.113.81 \
  --generic-ssh-key ~/.ssh/id_rsa \
  vm
</code></pre></div></div>

<h3 id="sudo-privileges">Sudo privileges</h3>

<p>The user that is used to SSH into the host can be specified with
<code class="language-plaintext highlighter-rouge">--generic-ssh-user</code> flag. This user needs password-less sudo
privileges.
If it’s not the case, you need to edit the <code class="language-plaintext highlighter-rouge">sudoers</code> file and configure the user
as a sudoer with <code class="language-plaintext highlighter-rouge">NOPASSWD</code>. See https://help.ubuntu.com/community/Sudoers.</p>

<h3 id="options">Options</h3>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--generic-engine-port</code>: Port to use for Docker Daemon (Note: This flag does not work with boot2docker).</li>
  <li><code class="language-plaintext highlighter-rouge">--generic-ip-address</code>: <strong>required</strong> IP Address of host.</li>
  <li><code class="language-plaintext highlighter-rouge">--generic-ssh-key</code>: Path to the SSH user private key.</li>
  <li><code class="language-plaintext highlighter-rouge">--generic-ssh-user</code>: SSH username used to connect.</li>
  <li><code class="language-plaintext highlighter-rouge">--generic-ssh-port</code>: Port to use for SSH.</li>
</ul>

<blockquote>
  <p><strong>Note</strong>: You must use a base operating system supported by Machine.</p>
</blockquote>

<h4 id="environment-variables-and-default-values">Environment variables and default values</h4>

<table>
  <thead>
    <tr>
      <th>CLI option</th>
      <th>Environment variable</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--generic-engine-port</code></td>
      <td><code class="language-plaintext highlighter-rouge">GENERIC_ENGINE_PORT</code></td>
      <td><code class="language-plaintext highlighter-rouge">2376</code></td>
    </tr>
    <tr>
      <td><strong><code class="language-plaintext highlighter-rouge">--generic-ip-address</code></strong></td>
      <td><code class="language-plaintext highlighter-rouge">GENERIC_IP_ADDRESS</code></td>
      <td>-</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--generic-ssh-key</code></td>
      <td><code class="language-plaintext highlighter-rouge">GENERIC_SSH_KEY</code></td>
      <td>-</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--generic-ssh-user</code></td>
      <td><code class="language-plaintext highlighter-rouge">GENERIC_SSH_USER</code></td>
      <td><code class="language-plaintext highlighter-rouge">root</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">--generic-ssh-port</code></td>
      <td><code class="language-plaintext highlighter-rouge">GENERIC_SSH_PORT</code></td>
      <td><code class="language-plaintext highlighter-rouge">22</code></td>
    </tr>
  </tbody>
</table>

<h3 id="systemd-settings">Systemd settings</h3>

<p>For systems that use systemd, if you have an existing configuration defined in
‘/etc/systemd/system/docker.service.d/’ this  may conflict with the settings created by
docker-machine.  Make sure you don’t have any other configuration files in this location
that override the [ExecStart] setting.</p>

<p>Once you have confirmed any conflicting settings have been removed, run
<code class="language-plaintext highlighter-rouge">sudo systemctl daemon-reload</code> followed by <code class="language-plaintext highlighter-rouge">sudo systemctl restart docker</code></p>

