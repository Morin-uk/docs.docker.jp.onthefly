
<p>Docker コンテナーやサービスの機能が強力である理由は、これらを互いに接続することができ、あるいは Docker ではないシステムとも接続ができる点です。
Docker コンテナーやサービスはどちらも、Docker によってデプロイされたものであるかを知っておく必要がなく、さらに接続された先が Docker によるものかどうかすら、わかっていなくてよいのです。
Docker ホストが Linux や Windows 上で、あるいはその両方が混在した上で動作しているとしても、Docker を使えばプラットフォームに依存せずに Docker ホストを管理することができます。</p>

<p>ここでは Docker ネットワークの基本的な考え方を紹介し、Docker の機能を最大限活用したアプリケーションの設計とデプロイができるようにしていきます。</p>

<h2 id="scope-of-this-topic">説明を行う範囲</h2>

<p>Docker ネットワークがどのように動作するのかに関して、OS 固有の話にまで踏み込んで説明するつもりは <strong>ありません</strong>。
したがって Linux 上において Docker がどのようにして <code class="language-plaintext highlighter-rouge">iptables</code> ルールを処理するのか、Windows Server 上にてルーティング規則をどのように処理するのか、といった情報を示すことはありません。
さらに Docker がパケットを構成しカプセル化する様子や暗号化を取り扱うところに関して、詳細情報も示しません。
技術的にかなり踏み込んだ詳細に関しては <a href="/docs.docker.jp.onthefly/network/iptables/">Docker と iptable</a> を参照してください。</p>

<p>上に加えてこの説明においては Docker ネットワークの生成、管理、利用に関するチュートリアルも含んでいません。
各節では、対応するチュートリアルやコマンドリファレンスはリンクとして示しています。</p>

<h2 id="network-drivers">ネットワークドライバー</h2>

<p>Docker 内のサブシステムであるネットワーク機能は、ドライバーを利用したプラガブル（pluggable）なものです。
デフォルトで数種のドライバーがあり、基本的なネットワーク機能が提供されています。</p>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">bridge</code>（ブリッジ）: デフォルトのネットワークドライバー。
ドライバーを指定しなかった場合、生成したネットワークのタイプがこのドライバーになります。
<strong>ブリッジネットワークは通常、アプリケーションがいくつかのスタンドアロンコンテナー上に動作していて、コンテナーが互いに通信を必要とする場合に利用されます。</strong>
<a href="/docs.docker.jp.onthefly/network/bridge/">ブリッジネットワーク</a> を参照してください。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">host</code>（ホスト）: スタンドアロンコンテナーにおいて、コンテナーと Docker ホスト間でのネットワーク隔離を取り除き、ホストのネットワーク機能を直接利用します。
<code class="language-plaintext highlighter-rouge">host</code> は Docker 17.06 またはそれ以降の swarm サービスにおいてのみ利用可能です。
<a href="/docs.docker.jp.onthefly/network/host/">ホストネットワークの利用</a> を参照してください。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">overlay</code>: オーバーレイネットワークは、複数の Docker デーモンを接続します。
そして swarm サービスによる相互の通信を可能にします。
またオーバーレイネットワークは、swarm サービスとスタンドアロンコンテナーとの間での通信、あるいは異なる Docker デーモン上の 2 つのスタンドアロンコンテナー間での通信を容易に実現します。
この方法を使えば、コンテナー間での OS レベルのルーティングは不要となります。
<a href="/docs.docker.jp.onthefly/network/overlay/">オーバーレイネットワーク</a> を参照してください。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">macvlan</code>: Macvlan ネットワークは、コンテナーに対して MAC アドレスを割り当てられるようにし、ネットワーク上の物理デバイスであるかのように見せることができます。
Docker デーモンはその MAC アドレスによって各コンテナー間のトラフィックを処理します。
<code class="language-plaintext highlighter-rouge">macvlan</code> ドライバーは、古いアプリケーションを取り扱う際、Docker ホストのネットワーク層を通じての処理ではなく、物理ネットワークに直接接続することが求められている場合に、ベストな選択となる場合があります。
<a href="/docs.docker.jp.onthefly/network/macvlan/">Macvlan ネットワーク</a> を参照してください。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">none</code>: これが指定されたコンテナーでは、ネットワーク機能がすべて無効化されます。
通常はカスタムネットワークドライバーと組み合わせて利用されます。
<code class="language-plaintext highlighter-rouge">none</code> は swarm サービスに対して利用することはできません。
<a href="/docs.docker.jp.onthefly/network/none/">コンテナーのネットワーク無効化</a> を参照してください。</p>
  </li>
  <li>
    <p><a href="/engine/extend/plugins_services/">ネットワークプラグイン</a>:
Docker では、サードパーティー製のネットワークドライバーをインストールして利用することができます。
プラグインは <a href="https://hub.docker.com/search?category=network&amp;q=&amp;type=plugin">Docker Hub</a> から、あるいはサードパーティーベンダーから入手することができます。
プラグインのインストール手順や利用方法については、ベンダー各社のドキュメントを参照してください。</p>
  </li>
</ul>

<h3 id="network-driver-summary">ネットワークドライバーのまとめ</h3>

<ul>
  <li>
    <p><strong>ユーザー定義ブリッジネットワーク</strong> は、同一 Docker ホスト上で複数コンテナーが通信する場合に利用します。</p>
  </li>
  <li>
    <p><strong>ホストネットワーク</strong> は、ネットワーク層が Docker ホストとは隔離されないことが必要な場合、そしてコンテナーの隔離は別の観点で必要な場合に利用します。</p>
  </li>
  <li>
    <p><strong>オーバーレイネットワーク</strong> は、異なる Docker ホスト上においてコンテナーが互いに通信する必要がある場合に利用します。
あるいは swarm サービスを利用して複数アプリケーションを動作させる場合に利用します。</p>
  </li>
  <li>
    <p><strong>Macvlan ネットワーク</strong> は、VM 環境から移行する場合や、ネットワーク上の物理ホストのようにコンテナーを扱う必要がある場合に利用します。  個々においては固有の MAC アドレスが用いられます。</p>
  </li>
  <li>
    <p><strong>サードパーティー製ネットワークプラグイン</strong> は、Docker に特別なネットワークスタックを統合します。</p>
  </li>
</ul>

<h2 id="networking-tutorials">ネットワークに関するチュートリアル</h2>

<p>Docker ネットワークの基本について理解してきました。
以下のチュートリアルを通じて、さらに理解を深めてください。</p>

<ul>
  <li><a href="/docs.docker.jp.onthefly/network/network-tutorial-standalone/">スタンドアロンネットワークのチュートリアル</a></li>
  <li><a href="/docs.docker.jp.onthefly/network/network-tutorial-host/">ホストネットワークのチュートリアル</a></li>
  <li><a href="/docs.docker.jp.onthefly/network/network-tutorial-overlay/">オーバーレイネットワークのチュートリアル</a></li>
  <li><a href="/docs.docker.jp.onthefly/network/network-tutorial-macvlan/">Macvlan ネットワークのチュートリアル</a></li>
</ul>
