
<p>Docker Compose コマンドラインの動作を設定するものとして、数種類の環境変数が利用できます。</p>

<p><code class="language-plaintext highlighter-rouge">DOCKER_</code> が先頭につく変数は、Docker コマンドラインクライアントの設定に用いられる環境変数と同じです。
<code class="language-plaintext highlighter-rouge">docker-machine</code> を利用している場合は、<code class="language-plaintext highlighter-rouge">eval "$(docker-machine env my-docker-vm)"</code> コマンドを実行することで、各環境変数に適切な値が設定されます。
（この例では <code class="language-plaintext highlighter-rouge">my-docker-vm</code> が生成されているマシン名です。）</p>

<blockquote>
  <p><strong>メモ</strong>： ここに示す環境変数の中には、<a href="/docs.docker.jp.onthefly/compose/env-file/">環境ファイル</a> を用いて設定できるものもあります。</p>
</blockquote>

<h2 id="compose_project_name">COMPOSE_PROJECT_NAME</h2>

<p>プロジェクト名を設定します。
この値は、コンテナーの起動時にサービス名の先頭につけられます。
たとえばプロジェクト名が <code class="language-plaintext highlighter-rouge">myapp</code> であり、2 つのサービス <code class="language-plaintext highlighter-rouge">db</code> と <code class="language-plaintext highlighter-rouge">web</code> があるとします。
Compose がコンテナーを起動したときにつける名前は、それぞれ <code class="language-plaintext highlighter-rouge">myapp_db_1</code>、<code class="language-plaintext highlighter-rouge">myapp_web_1</code> です。</p>

<p>この変数を設定するのは任意です。
変数を設定しなかった場合 <code class="language-plaintext highlighter-rouge">COMPOSE_PROJECT_NAME</code> のデフォルトは、プロジェクトディレクトリの <code class="language-plaintext highlighter-rouge">basename</code> となります。
<a href="/docs.docker.jp.onthefly/compose/reference/overview/">コマンドラインオプション</a> の <code class="language-plaintext highlighter-rouge">-p</code> も参照してください。</p>

<h2 id="compose_file">COMPOSE_FILE</h2>

<p>Compose ファイルへのパスを指定します。
指定されなかった場合、Compose はカレントディレクトリ内の <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> というファイルを探します。
そしてファイルが見つからなければ、この名前のファイルを見つけるまで親ディレクトリを順にたどって探します。</p>

<p>この変数は複数の Compose ファイルの指定をサポートしています。
複数のパスはセパレーターで区切ります（パスセパレーターは Linux や macOS では <code class="language-plaintext highlighter-rouge">:</code>、Windows では <code class="language-plaintext highlighter-rouge">;</code>）。
たとえば <code class="language-plaintext highlighter-rouge">COMPOSE_FILE=docker-compose.yml:docker-compose.prod.yml</code> とします。
パスセパレーターは <code class="language-plaintext highlighter-rouge">COMPOSE_PATH_SEPARATOR</code> を使って変更することもできます。</p>

<p><a href="/docs.docker.jp.onthefly/compose/reference/overview/">コマンドラインオプション</a> <code class="language-plaintext highlighter-rouge">-f</code> も参照してください。</p>

<h2 id="compose_api_version">COMPOSE_API_VERSION</h2>

<p>Docker API は、クライアントが特定のバージョンを返す場合に限って、クライアントからのリクエストに応じます。
<code class="language-plaintext highlighter-rouge">docker-compose</code> を利用する際に <code class="language-plaintext highlighter-rouge">client and server don't have same version</code> （クライアントとサーバーのバージョンが一致しません）というエラーが発生した場合は、その回避策として、本環境変数を設定する方法があります。
サーバーのバージョンに合致するようなバージョン値をこの変数に設定することです。</p>

<p>クライアントとサーバーのバージョンが一致しないときであっても、実行が必要になる状況があります。
この変数を用いるのは、そういった状況を一時的に解決するためです。
具体的には、クライアントをアップグレードしたものの、サーバーをまだアップグレードしていないような状況です。</p>

<p>この変数を設定したとしても、既知のバージョン不一致に該当していれば、Docker の機能が正常に動作しないことがあります。
動作しない機能は、Docker クライアントやサーバーのバージョンによって異なります。
このことから、本変数を設定して実行するのはあくまで一時的な回避策であり、公式にサポートされるものではありません。</p>

<p>本変数を設定することで問題が発生する場合は、アップグレードを行ってバージョンの不一致を解消してください。
そしてこの変数の定義を行わなかったらどうなるかを確認してください。
それでも問題が解決しない場合はサポートに問い合わせてください。</p>

<h2 id="docker_host">DOCKER_HOST</h2>

<p><code class="language-plaintext highlighter-rouge">docker</code> デーモンの URL を設定します。
Docker クライアントと同じように、このデフォルト値は <code class="language-plaintext highlighter-rouge">unix:///var/run/docker.sock</code> です。</p>

<h2 id="docker_tls_verify">DOCKER_TLS_VERIFY</h2>

<p>この変数が空文字以外であれば、<code class="language-plaintext highlighter-rouge">docker</code> デーモンとの TLS 通信を有効にします。</p>

<h2 id="docker_cert_path">DOCKER_CERT_PATH</h2>

<p>TLS 検証に用いられる各種ファイル、<code class="language-plaintext highlighter-rouge">ca.pem</code>, <code class="language-plaintext highlighter-rouge">cert.pem</code>, <code class="language-plaintext highlighter-rouge">key.pem</code> のパスを設定します。
デフォルトは <code class="language-plaintext highlighter-rouge">~/.docker</code> です。</p>

<h2 id="compose_http_timeout">COMPOSE_HTTP_TIMEOUT</h2>

<p>Docker デーモンへの処理要求にあたって、Compose の処理は失敗していなくても、デーモンをハングアップさせる所要時間を（秒単位で）指定します。
デフォルトは 60 秒です。</p>

<h2 id="compose_tls_version">COMPOSE_TLS_VERSION</h2>

<p><code class="language-plaintext highlighter-rouge">docker</code> デーモンとの TLS 通信に用いられる TLS バージョンを指定します。
デフォルトは <code class="language-plaintext highlighter-rouge">TLSv1</code> です。
対応する値は <code class="language-plaintext highlighter-rouge">TLSv1</code>, <code class="language-plaintext highlighter-rouge">TLSv1_1</code>, <code class="language-plaintext highlighter-rouge">TLSv1_2</code> です。</p>

<h2 id="compose_convert_windows_paths">COMPOSE_CONVERT_WINDOWS_PATHS</h2>

<p>ボリュームの定義において、パスの記述に関して Windows 書式と Unix 書式の変換を有効にします。
Windows 上の Docker Machine を利用するユーザーは、必ず本変数を設定しておきます。
デフォルトは <code class="language-plaintext highlighter-rouge">0</code> です。
対応する値は <code class="language-plaintext highlighter-rouge">true</code> または <code class="language-plaintext highlighter-rouge">1</code> が有効を意味し、<code class="language-plaintext highlighter-rouge">false</code> または <code class="language-plaintext highlighter-rouge">0</code> が無効を意味します。</p>

<h2 id="compose_path_separator">COMPOSE_PATH_SEPARATOR</h2>

<p>これが設定されている場合に、環境変数 <code class="language-plaintext highlighter-rouge">COMPOSE_FILE</code> の設定値に対して、パスを区切る文字として本変数の設定値を用います。</p>

<h2 id="compose_force_windows_host">COMPOSE_FORCE_WINDOWS_HOST</h2>

<p>これが設定されていて、<a href="/docs.docker.jp.onthefly/compose/compose-file/#short-syntax-3">短い文法</a> によってボリュームの宣言を行うと、ホストのパスは Windows パスとして扱われます。
Compose が UNIX ベースのシステム上で動作していても、そのようになります。
対応する値は <code class="language-plaintext highlighter-rouge">true</code> または <code class="language-plaintext highlighter-rouge">1</code> が有効を意味し、また <code class="language-plaintext highlighter-rouge">false</code> または <code class="language-plaintext highlighter-rouge">0</code> が無効を意味します。</p>

<h2 id="compose_ignore_orphans">COMPOSE_IGNORE_ORPHANS</h2>

<p>これが設定されている場合に、そのプロジェクト内で孤立したコンテナーを Compose が検出しないようにします。
対応する値は <code class="language-plaintext highlighter-rouge">true</code> または <code class="language-plaintext highlighter-rouge">1</code> が有効を意味し、<code class="language-plaintext highlighter-rouge">false</code> または <code class="language-plaintext highlighter-rouge">0</code> が無効を意味します。</p>

<h2 id="compose_parallel_limit">COMPOSE_PARALLEL_LIMIT</h2>

<p>Compose が並列で処理する操作数を設定します。
デフォルト値は <code class="language-plaintext highlighter-rouge">64</code> です。
<code class="language-plaintext highlighter-rouge">2</code> よりも小さな値を設定することはできません。</p>

<h2 id="compose_interactive_no_cli">COMPOSE_INTERACTIVE_NO_CLI</h2>

<p>これが設定されている場合に、Docker CLI の <code class="language-plaintext highlighter-rouge">run</code> や <code class="language-plaintext highlighter-rouge">exec</code> の処理において Compose は対話的処理を行わないようにします。
前もって操作を定めておく必要がある Windows の CLI では、このオプションを利用することはできません。
対応する値は <code class="language-plaintext highlighter-rouge">true</code> または <code class="language-plaintext highlighter-rouge">1</code> が有効を意味し、<code class="language-plaintext highlighter-rouge">false</code> または <code class="language-plaintext highlighter-rouge">0</code> が無効を意味します。</p>

<h2 id="related-information">関連情報</h2>

<ul>
  <li><a href="/docs.docker.jp.onthefly/compose/">ユーザーガイド</a></li>
  <li><a href="/docs.docker.jp.onthefly/compose/install/">Compose のインストール</a></li>
  <li><a href="/docs.docker.jp.onthefly/compose/compose-file/">Compose ファイルリファレンス</a></li>
  <li><a href="/docs.docker.jp.onthefly/compose/env-file/">環境ファイル</a></li>
</ul>
