<!-- Page generated 2020-05-27 22:44:58 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
      @charset "UTF-8";
      [ng\:cloak],
      [ng-cloak],
      [data-ng-cloak],
      [x-ng-cloak],
      .ng-cloak,
      .x-ng-cloak,
      .ng-hide:not(.ng-hide-animate) {
          display: none !important;
      }

      ng\:form {
          display: block;
      }
  </style>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>

  
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-05-27T22:44:58+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:title" itemprop="title name" content="Docker デーモンの設定とトラブルシュート"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="Docker を正常にインストールし Docker を起動すると、dockerd というデーモンがデフォルト設定により起動します。 ここではその設定のカスタマイズ方法、デーモンの手動起動、問題発生時のトラブルシュートやデバッグについて示します。 OS ユーティリティーによるデーモンの起動 標準的なインストールによる Docker デーモンは、ユーザーが手動で起動するものではなく、システムのユーティリティーによって起動されます。 これによりマシン再起動時に、Docker を自動起動させることが簡単になります。 Docker を起動させるコマンドはオペレーティングシステムによります。 Docker のインストール の中から適切なページを確認してください。 システム起動時に Docker を自動起動するように設定する場合は システムブート時の Docker 起動設定 を参照してください。 デーモンの手動起動 Docker デーモンをシステムユーティリティーによって管理することが望ましくない場合、あるいは何かをすぐにテストしたいといった場合、dockerd コマンドを利用してデーモンを手動起動することができます。 このときには..." />
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker Documentation"/>
  <meta property="article:published_time" itemprop="datePublished" content="2020-05-27T22:44:58+09:00"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="docker, daemon, configuration, troubleshooting">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
  <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

  <!-- Go get "Open Sans" font from Google -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <!-- SEO stuff -->
  <title>Docker デーモンの設定とトラブルシュート | Docker Documentation</title>
  <meta property="og:title" content="Docker デーモンの設定とトラブルシュート" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="description" content="Docker デーモンの設定とトラブルシュート" />
  <meta property="og:description" content="Docker デーモンの設定とトラブルシュート" />
  <link rel="canonical" href="/config/daemon/" />
  <meta property="og:url" content="https://docs.docker.com/config/daemon/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Docker デーモンの設定とトラブルシュート","description":"Docker デーモンの設定とトラブルシュート","url":"https://docs.docker.com/config/daemon/"}</script>
  <!-- END SEO STUFF -->
  
  <script>
  // Default to assuming this is an archive and hiding some stuff
  // See js/archive.js and js/docs.js for logic relating to this
  var isArchive = true;
  var dockerVersion = 'v19.03';
  </script>
</head>


    <body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/">
                <img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs">
            </a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="logo-mobile">
    <a href="/docs.docker.jp.onthefly/">
        <img src="/docs.docker.jp.onthefly/images/docker-icon.svg" alt="Docker Docs" title="Docker Docs">
    </a>
</div>
<div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container hidden-sm hidden-xs">
    <div id="tabs">
        <ul class="tabs jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (最新)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>Docker デーモンの設定とトラブルシュート</h1> 
                            <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    10 分
  
</span>

                            
                            
                            
<p>Docker を正常にインストールし Docker を起動すると、<code class="highlighter-rouge">dockerd</code> というデーモンがデフォルト設定により起動します。
ここではその設定のカスタマイズ方法、デーモンの手動起動、問題発生時のトラブルシュートやデバッグについて示します。</p>

<h2 id="start-the-daemon-using-operating-system-utilities">OS ユーティリティーによるデーモンの起動</h2>

<p>標準的なインストールによる Docker デーモンは、ユーザーが手動で起動するものではなく、システムのユーティリティーによって起動されます。
これによりマシン再起動時に、Docker を自動起動させることが簡単になります。</p>

<p>Docker を起動させるコマンドはオペレーティングシステムによります。
<a href="/docs.docker.jp.onthefly/engine/install/">Docker のインストール</a> の中から適切なページを確認してください。
システム起動時に Docker を自動起動するように設定する場合は <a href="/docs.docker.jp.onthefly/engine/install/linux-postinstall/#configure-docker-to-start-on-boot">システムブート時の Docker 起動設定</a> を参照してください。</p>

<h2 id="start-the-daemon-manually">デーモンの手動起動</h2>

<p>Docker デーモンをシステムユーティリティーによって管理することが望ましくない場合、あるいは何かをすぐにテストしたいといった場合、<code class="highlighter-rouge">dockerd</code> コマンドを利用してデーモンを手動起動することができます。
このときには <code class="highlighter-rouge">sudo</code> を必要とするかもしれませんが、そこはオペレーティングシステムでの設定によります。</p>

<p>この方法によって Docker を起動した場合、Docker はフォアグラウンド実行され、出力ログは端末に直接出力されます。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>dockerd

INFO[0000] +job init_networkdriver<span class="o">()</span>
INFO[0000] +job serveapi<span class="o">(</span>unix:///var/run/docker.sock<span class="o">)</span>
INFO[0000] Listening <span class="k">for </span>HTTP on unix <span class="o">(</span>/var/run/docker.sock<span class="o">)</span>
</code></pre></div></div>

<p>手動で起動させた Docker を停止するには、端末上で <code class="highlighter-rouge">Ctrl+C</code> を入力します。</p>

<h2 id="configure-the-docker-daemon">デーモンの設定</h2>

<p>Docker デーモンの設定には 2 つの方法があります。</p>

<ul>
  <li>JSON 形式の設定ファイルを利用します。
設定をすべて一箇所にとりまとめられるので、この方法が推奨されます。</li>
  <li><code class="highlighter-rouge">dockerd</code> 起動時のフラグを利用します。</li>
</ul>

<p>You can use both of these options together as long as you don’t specify the
same option both as a flag and in the JSON file. If that happens, the Docker
daemon won’t start and prints an error message.</p>

<p>To configure the Docker daemon using a JSON file, create a file at
<code class="highlighter-rouge">/etc/docker/daemon.json</code> on Linux systems, or <code class="highlighter-rouge">C:\ProgramData\docker\config\daemon.json</code>
on Windows. On MacOS go to the whale in the taskbar &gt; Preferences &gt; Daemon &gt; Advanced.</p>

<p>Here’s what the configuration file looks like:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"debug"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tls"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tlscert"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/var/docker/server.pem"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tlskey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/var/docker/serverkey.pem"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tcp://192.168.59.3:2376"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>With this configuration the Docker daemon runs in debug mode, uses TLS, and
listens for traffic routed to <code class="highlighter-rouge">192.168.59.3</code> on port <code class="highlighter-rouge">2376</code>.
You can learn what configuration options are available in the
<a href="/docs.docker.jp.onthefly/engine/reference/commandline/dockerd/#daemon-configuration-file">dockerd reference docs</a></p>

<p>You can also start the Docker daemon manually and configure it using flags.
This can be useful for troubleshooting problems.</p>

<p>Here’s an example of how to manually start the Docker daemon, using the same
configurations as above:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dockerd <span class="nt">--debug</span> <span class="se">\</span>
  <span class="nt">--tls</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--tlscert</span><span class="o">=</span>/var/docker/server.pem <span class="se">\</span>
  <span class="nt">--tlskey</span><span class="o">=</span>/var/docker/serverkey.pem <span class="se">\</span>
  <span class="nt">--host</span> tcp://192.168.59.3:2376
</code></pre></div></div>

<p>You can learn what configuration options are available in the
<a href="/docs.docker.jp.onthefly/engine/reference/commandline/dockerd/">dockerd reference docs</a>, or by running:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dockerd --help
</code></pre></div></div>

<p>Many specific configuration options are discussed throughout the Docker
documentation. Some places to go next include:</p>

<ul>
  <li><a href="/docs.docker.jp.onthefly/config/containers/start-containers-automatically/">Automatically start containers</a></li>
  <li><a href="/docs.docker.jp.onthefly/config/containers/resource_constraints/">Limit a container’s resources</a></li>
  <li><a href="/docs.docker.jp.onthefly/storage/storagedriver/select-storage-driver/">Configure storage drivers</a></li>
  <li><a href="/docs.docker.jp.onthefly/engine/security/">Container security</a></li>
</ul>

<h2 id="docker-daemon-directory">Docker daemon directory</h2>

<p>The Docker daemon persists all data in a single directory. This tracks everything
related to Docker, including containers, images, volumes, service definition,
and secrets.</p>

<p>By default this directory is:</p>

<ul>
  <li><code class="highlighter-rouge">/var/lib/docker</code> on Linux.</li>
  <li><code class="highlighter-rouge">C:\ProgramData\docker</code> on Windows.</li>
</ul>

<p>You can configure the Docker daemon to use a different directory, using the
<code class="highlighter-rouge">data-root</code> configuration option.</p>

<p>Since the state of a Docker daemon is kept on this directory, make sure
you use a dedicated directory for each daemon. If two daemons share the same
directory, for example, an NFS share, you are going to experience errors that
are difficult to troubleshoot.</p>

<h2 id="troubleshoot-the-daemon">Troubleshoot the daemon</h2>

<p>You can enable debugging on the daemon to learn about the runtime activity of
the daemon and to aid in troubleshooting. If the daemon is completely
non-responsive, you can also
<a href="#force-a-stack-trace-to-be-logged">force a full stack trace</a> of all
threads to be added to the daemon log by sending the <code class="highlighter-rouge">SIGUSR</code> signal to the
Docker daemon.</p>

<h3 id="troubleshoot-conflicts-between-the-daemonjson-and-startup-scripts">Troubleshoot conflicts between the <code class="highlighter-rouge">daemon.json</code> and startup scripts</h3>

<p>If you use a <code class="highlighter-rouge">daemon.json</code> file and also pass options to the <code class="highlighter-rouge">dockerd</code>
command manually or using start-up scripts, and these options conflict,
Docker fails to start with an error such as:</p>

<pre><code class="language-none">unable to configure the Docker daemon with file /etc/docker/daemon.json:
the following directives are specified both as a flag and in the configuration
file: hosts: (from flag: [unix:///var/run/docker.sock], from file: [tcp://127.0.0.1:2376])
</code></pre>

<p>If you see an error similar to this one and you are starting the daemon manually with flags,
you may need to adjust your flags or the <code class="highlighter-rouge">daemon.json</code> to remove the conflict.</p>

<blockquote>
  <p><strong>Note</strong>: If you see this specific error, continue to the
<a href="#use-the-hosts-key-in-daemonjson-with-systemd">next section</a> for a workaround.</p>
</blockquote>

<p>If you are starting Docker using your operating system’s init scripts, you may
need to override the defaults in these scripts in ways that are specific to the
operating system.</p>

<h4 id="use-the-hosts-key-in-daemonjson-with-systemd">Use the hosts key in daemon.json with systemd</h4>

<p>One notable example of a configuration conflict that is difficult to troubleshoot
is when you want to specify a different daemon address from
the default. Docker listens on a socket by default. On Debian and Ubuntu systems using <code class="highlighter-rouge">systemd</code>,
this means that a host flag <code class="highlighter-rouge">-H</code> is always used when starting <code class="highlighter-rouge">dockerd</code>. If you specify a
<code class="highlighter-rouge">hosts</code> entry in the <code class="highlighter-rouge">daemon.json</code>, this causes a configuration conflict (as in the above message)
and Docker fails to start.</p>

<p>To work around this problem, create a new file <code class="highlighter-rouge">/etc/systemd/system/docker.service.d/docker.conf</code> with
the following contents, to remove the <code class="highlighter-rouge">-H</code> argument that is used when starting the daemon by default.</p>

<pre><code class="language-none">[Service]
ExecStart=
ExecStart=/usr/bin/dockerd
</code></pre>

<p>There are other times when you might need to configure <code class="highlighter-rouge">systemd</code> with Docker, such as
<a href="/docs.docker.jp.onthefly/config/daemon/systemd/#httphttps-proxy">configuring a HTTP or HTTPS proxy</a>.</p>

<blockquote>
  <p><strong>Note</strong>: If you override this option and then do not specify a <code class="highlighter-rouge">hosts</code> entry in the <code class="highlighter-rouge">daemon.json</code>
or a <code class="highlighter-rouge">-H</code> flag when starting Docker manually, Docker fails to start.</p>
</blockquote>

<p>Run <code class="highlighter-rouge">sudo systemctl daemon-reload</code> before attempting to start Docker. If Docker starts
successfully, it is now listening on the IP address specified in the <code class="highlighter-rouge">hosts</code> key of the
<code class="highlighter-rouge">daemon.json</code> instead of a socket.</p>

<blockquote class="important">
  <p><strong>Important</strong>: Setting <code class="highlighter-rouge">hosts</code> in the <code class="highlighter-rouge">daemon.json</code> is not supported on Docker Desktop for Windows
or Docker Desktop for Mac.</p>
</blockquote>

<h3 id="out-of-memory-exceptions-oome">Out Of Memory Exceptions (OOME)</h3>

<p>If your containers attempt to use more memory than the system has available,
you may experience an Out Of Memory Exception (OOME) and a container, or the
Docker daemon, might be killed by the kernel OOM killer. To prevent this from
happening, ensure that your application runs on hosts with adequate memory and
see
<a href="/docs.docker.jp.onthefly/config/containers/resource_constraints/#understand-the-risks-of-running-out-of-memory">Understand the risks of running out of memory</a>.</p>

<h3 id="read-the-logs">Read the logs</h3>

<p>The daemon logs may help you diagnose problems. The logs may be saved in one of
a few locations, depending on the operating system configuration and the logging
subsystem used:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Operating system</th>
      <th style="text-align: left">Location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">RHEL, Oracle Linux</td>
      <td style="text-align: left"><code class="highlighter-rouge">/var/log/messages</code></td>
    </tr>
    <tr>
      <td style="text-align: left">Debian</td>
      <td style="text-align: left"><code class="highlighter-rouge">/var/log/daemon.log</code></td>
    </tr>
    <tr>
      <td style="text-align: left">Ubuntu 16.04+, CentOS</td>
      <td style="text-align: left">Use the command <code class="highlighter-rouge">journalctl -u docker.service</code></td>
    </tr>
    <tr>
      <td style="text-align: left">Ubuntu 14.10-</td>
      <td style="text-align: left"><code class="highlighter-rouge">/var/log/upstart/docker.log</code></td>
    </tr>
    <tr>
      <td style="text-align: left">macOS (Docker 18.01+)</td>
      <td style="text-align: left"><code class="highlighter-rouge">~/Library/Containers/com.docker.docker/Data/vms/0/console-ring</code></td>
    </tr>
    <tr>
      <td style="text-align: left">macOS (Docker &lt;18.01)</td>
      <td style="text-align: left"><code class="highlighter-rouge">~/Library/Containers/com.docker.docker/Data/com.docker.driver.amd64-linux/console-ring</code></td>
    </tr>
    <tr>
      <td style="text-align: left">Windows</td>
      <td style="text-align: left"><code class="highlighter-rouge">AppData\Local</code></td>
    </tr>
  </tbody>
</table>

<h3 id="enable-debugging">Enable debugging</h3>

<p>There are two ways to enable debugging. The recommended approach is to set the
<code class="highlighter-rouge">debug</code> key to <code class="highlighter-rouge">true</code> in the <code class="highlighter-rouge">daemon.json</code> file. This method works for every
Docker platform.</p>

<ol>
  <li>
    <p>Edit the <code class="highlighter-rouge">daemon.json</code> file, which is usually located in <code class="highlighter-rouge">/etc/docker/</code>.
You may need to create this file, if it does not yet exist. On macOS or
Windows, do not edit the file directly. Instead, go to
<strong>Preferences</strong> / <strong>Daemon</strong> / <strong>Advanced</strong>.</p>
  </li>
  <li>
    <p>If the file is empty, add the following:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"debug"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

    <p>If the file already contains JSON, just add the key <code class="highlighter-rouge">"debug": true</code>, being
careful to add a comma to the end of the line if it is not the last line
before the closing bracket. Also verify that if the <code class="highlighter-rouge">log-level</code> key is set,
it is set to either <code class="highlighter-rouge">info</code> or <code class="highlighter-rouge">debug</code>. <code class="highlighter-rouge">info</code> is the default, and possible
values are <code class="highlighter-rouge">debug</code>, <code class="highlighter-rouge">info</code>, <code class="highlighter-rouge">warn</code>, <code class="highlighter-rouge">error</code>, <code class="highlighter-rouge">fatal</code>.</p>
  </li>
  <li>
    <p>Send a <code class="highlighter-rouge">HUP</code> signal to the daemon to cause it to reload its configuration.
On Linux hosts, use the following command.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo kill</span> <span class="nt">-SIGHUP</span> <span class="k">$(</span>pidof dockerd<span class="k">)</span>
</code></pre></div>    </div>

    <p>On Windows hosts, restart Docker.</p>
  </li>
</ol>

<p>Instead of following this procedure, you can also stop the Docker daemon and
restart it manually with the debug flag <code class="highlighter-rouge">-D</code>. However, this may result in Docker
restarting with a different environment than the one the hosts’ startup scripts
create, and this may make debugging more difficult.</p>

<h3 id="force-a-stack-trace-to-be-logged">Force a stack trace to be logged</h3>

<p>If the daemon is unresponsive, you can force a full stack trace to be logged
by sending a <code class="highlighter-rouge">SIGUSR1</code> signal to the daemon.</p>

<ul>
  <li>
    <p><strong>Linux</strong>:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo kill</span> <span class="nt">-SIGUSR1</span> <span class="k">$(</span>pidof dockerd<span class="k">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>Windows Server</strong>:</p>

    <p>Download <a href="https://github.com/moby/docker-signal">docker-signal</a>.</p>

    <p>Get the process ID of dockerd <code class="highlighter-rouge">Get-Process dockerd</code>.</p>

    <p>Run the executable with the flag <code class="highlighter-rouge">--pid=&lt;PID of daemon&gt;</code>.</p>
  </li>
</ul>

<p>This forces a stack trace to be logged but does not stop the daemon.
Daemon logs show the stack trace or the path to a file containing the
stack trace if it was logged to a file.</p>

<p>The daemon continues operating after handling the <code class="highlighter-rouge">SIGUSR1</code> signal and
dumping the stack traces to the log. The stack traces can be used to determine
the state of all goroutines and threads within the daemon.</p>

<h3 id="view-stack-traces">View stack traces</h3>

<p>The Docker daemon log can be viewed by using one of the following methods:</p>

<ul>
  <li>By running <code class="highlighter-rouge">journalctl -u docker.service</code> on Linux systems using <code class="highlighter-rouge">systemctl</code></li>
  <li><code class="highlighter-rouge">/var/log/messages</code>, <code class="highlighter-rouge">/var/log/daemon.log</code>, or <code class="highlighter-rouge">/var/log/docker.log</code> on older
Linux systems</li>
</ul>

<blockquote>
  <p><strong>Note</strong>: It is not possible to manually generate a stack trace on Docker Desktop for
Mac or Docker Desktop for Windows. However, you can click the Docker taskbar icon and
choose <strong>Diagnose and feedback</strong> to send information to Docker if you run into
issues.</p>
</blockquote>

<p>Look in the Docker logs for a message like the following:</p>

<pre><code class="language-none">...goroutine stacks written to /var/run/docker/goroutine-stacks-2017-06-02T193336z.log
...daemon datastructure dump written to /var/run/docker/daemon-data-2017-06-02T193336z.log
</code></pre>

<p>The locations where Docker saves these stack traces and dumps depends on your
operating system and configuration. You can sometimes get useful diagnostic
information straight from the stack traces and dumps. Otherwise, you can provide
this information to Docker for help diagnosing the problem.</p>

<h2 id="check-whether-docker-is-running">Docker が起動しているかどうかの確認</h2>

<p>The operating-system independent way to check whether Docker is running is to
ask Docker, using the <code class="highlighter-rouge">docker info</code> command.</p>

<p>You can also use operating system utilities, such as
<code class="highlighter-rouge">sudo systemctl is-active docker</code> or <code class="highlighter-rouge">sudo status docker</code> or
<code class="highlighter-rouge">sudo service docker status</code>, or checking the service status using Windows
utilities.</p>

<p>Finally, you can check in the process list for the <code class="highlighter-rouge">dockerd</code> process, using
commands like <code class="highlighter-rouge">ps</code> or <code class="highlighter-rouge">top</code>.</p>

                            <!-- tags -->
                            
                            <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span
                                style="vertical-align: 2px"><a
                                    href="https://docs.docker.com/search/?q=docker">docker</a>, <a
                                    href="https://docs.docker.com/search/?q=daemon">daemon</a>, <a
                                    href="https://docs.docker.com/search/?q=configuration">configuration</a>, <a
                                    href="https://docs.docker.com/search/?q=troubleshooting">troubleshooting</a></span>
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "config/daemon/index.md",
                                        "title": "Docker デーモンの設定とトラブルシュート",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/master/config/daemon/index.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav jsTOCHorizontal hidden-md hidden-lg">
    </ul>
    <div class="divider hidden-md hidden-lg"></div>
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/config/daemon/index.md"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/issues/new?body=ファイル: [config/daemon/index.md](https://matsuand.github.io/docs.docker.jp.onthefly/config/daemon/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#start-the-daemon-using-operating-system-utilities" class="nomunge">OS ユーティリティーによるデーモンの起動</a></li>
  <li><a href="#start-the-daemon-manually" class="nomunge">デーモンの手動起動</a></li>
  <li><a href="#configure-the-docker-daemon" class="nomunge">デーモンの設定</a></li>
  <li><a href="#docker-daemon-directory" class="nomunge">Docker daemon directory</a></li>
  <li><a href="#troubleshoot-the-daemon" class="nomunge">Troubleshoot the daemon</a>
    <ul>
      <li><a href="#troubleshoot-conflicts-between-the-daemonjson-and-startup-scripts" class="nomunge">Troubleshoot conflicts between the daemon.json and startup scripts</a></li>
      <li><a href="#out-of-memory-exceptions-oome" class="nomunge">Out Of Memory Exceptions (OOME)</a></li>
      <li><a href="#read-the-logs" class="nomunge">Read the logs</a></li>
      <li><a href="#enable-debugging" class="nomunge">Enable debugging</a></li>
      <li><a href="#force-a-stack-trace-to-be-logged" class="nomunge">Force a stack trace to be logged</a></li>
      <li><a href="#view-stack-traces" class="nomunge">View stack traces</a></li>
    </ul>
  </li>
  <li><a href="#check-whether-docker-is-running" class="nomunge">Docker が起動しているかどうかの確認</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
    <script>
        // Default to assuming this is an archive and hiding some stuff
        // See js/archive.js and js/docs.js for logic relating to this
        var isArchive = true;
        var dockerVersion = 'v19.03';
        // In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
        var jekyllEnv = 'development';
        // If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
        if (jekyllEnv === 'development') {
            jekyllEnv = '';
        }
        var pageURL = jekyllEnv + '/config/daemon/';
    </script>
    <script src="/docs.docker.jp.onthefly/js/archive.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script>
        jQuery(document).ready(function () { hookupTOCEvents(); });
    </script>
</body>


</html>
