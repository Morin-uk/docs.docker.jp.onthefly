<!-- Page generated 2019-07-27 12:10:47 +0900 -->
<!-- relative link basehrefs -->

	


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-07-27T12:10:47+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="ストレージドライバーについて"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="ストレージドライバーを効率よく利用するためには、Docker がどのようにしてイメージをビルドし保存するのか、またそのイメージをコンテナーがどのように利用するのかを理解しておくことが重要です。 これがわかっていれば、その知識に基づいた判断として、アプリケーションデータの適切な保存方法や、アプリケーション稼動中のパフォーマンス問題に対して、最良の方策をとることができます。 ストレージドライバーは、コンテナー内の書き込み可能なレイヤーにデータを保存するものです。 これがファイルデータであると、コンテナーが削除された後にデータは維持されず、通常のファイルシステム上でのパフォーマンスに比べて、読み書きの速度は低下します。 メモ: 問題が発生すると言われる処理として、書き込みを重点的に行うデータベースストレージの利用があります。 特に書き込み専用レイヤーに既にデータが存在している場合が挙げられます。 詳しくは本文にて説明します。 ボリューム利用方法について学ぶ を参照してデータ保存方法やパフォーマンス改善について確認してください。 イメージとレイヤー Docker イメージは一連のレイヤーから構成されます。 個々のレイヤーは、そのイメージの Dockerfile 内にある 1 つの命令に対応づいています。 一番最後にあるレイヤーを除き、これ以外はすべて読み込み専用のレイヤーです。 たとえば以下のような Dockerfile を考えてみます。 FROM ubuntu:18.04 COPY . /app RUN make..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker Documentation"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-07-27T12:10:47+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="container, storage, driver, AUFS, btfs, devicemapper,zvfs">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>ストレージドライバーについて | Docker Documentation</title>
<meta property="og:title" content="ストレージドライバーについて" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Learn the technologies that support storage drivers." />
<meta property="og:description" content="Learn the technologies that support storage drivers." />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/" />
<meta property="og:site_name" content="Docker Documentation" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"ストレージドライバーについて","description":"Learn the technologies that support storage drivers.","url":"https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)         <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>ストレージドライバーについて</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    10 分
  
</span>

							
							
							
<p>ストレージドライバーを効率よく利用するためには、Docker がどのようにしてイメージをビルドし保存するのか、またそのイメージをコンテナーがどのように利用するのかを理解しておくことが重要です。
これがわかっていれば、その知識に基づいた判断として、アプリケーションデータの適切な保存方法や、アプリケーション稼動中のパフォーマンス問題に対して、最良の方策をとることができます。</p>

<p>ストレージドライバーは、コンテナー内の書き込み可能なレイヤーにデータを保存するものです。
これがファイルデータであると、コンテナーが削除された後にデータは維持されず、通常のファイルシステム上でのパフォーマンスに比べて、読み書きの速度は低下します。</p>

<blockquote>
  <p><strong>メモ</strong>: 問題が発生すると言われる処理として、書き込みを重点的に行うデータベースストレージの利用があります。
特に書き込み専用レイヤーに既にデータが存在している場合が挙げられます。
詳しくは本文にて説明します。</p>
</blockquote>

<p><a href="https://matsuand.github.io/docs.docker.jp.onthefly/storage/volumes/">ボリューム利用方法について学ぶ</a> を参照してデータ保存方法やパフォーマンス改善について確認してください。</p>

<h2 id="images-and-layers">イメージとレイヤー</h2>

<p>Docker イメージは一連のレイヤーから構成されます。
個々のレイヤーは、そのイメージの Dockerfile 内にある 1 つの命令に対応づいています。
一番最後にあるレイヤーを除き、これ以外はすべて読み込み専用のレイヤーです。
たとえば以下のような Dockerfile を考えてみます。</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FROM</span> <span class="n">ubuntu</span>:<span class="m">18</span>.<span class="m">04</span>
<span class="n">COPY</span> . /<span class="n">app</span>
<span class="n">RUN</span> <span class="n">make</span> /<span class="n">app</span>
<span class="n">CMD</span> <span class="n">python</span> /<span class="n">app</span>/<span class="n">app</span>.<span class="n">py</span>
</code></pre></div></div>

<p>この Dockerfile には 4 つのコマンドがあります。
コマンドのそれぞれが 1 つのレイヤーを生成します。
まずは <code class="highlighter-rouge">FROM</code> 命令によって <code class="highlighter-rouge">ubuntu:18.04</code> イメージから 1 つのレイヤーが生成されるところから始まります。
<code class="highlighter-rouge">COPY</code> 命令は Docker クライアントのカレントディレクトリから複数のファイルを追加します。
<code class="highlighter-rouge">RUN</code> 命令は <code class="highlighter-rouge">make</code> コマンドを実行してアプリケーションをビルドします。
そして最後のレイヤーが、コンテナー内にて実行するべきコマンドを指定しています。</p>

<p>各レイヤーは、その直前のレイヤーからの差異だけを保持します。
そしてレイヤーは順に積み上げられていきます。
新しいコンテナーを生成したときには、それまで存在していたレイヤー群の最上部に、新たな書き込み可能なレイヤーが加えられます。
このレイヤーは「コンテナーレイヤー」と呼ばれることがあります。
実行中のコンテナーに対して実行される変更処理すべて、たとえば新規ファイル生成、既存ファイル修正、ファイル削除といったことは、その薄い皮のような書き込み可能なコンテナーレイヤーに対して書き込まれます。
以下の図は Ubuntu 18.04 イメージに基づいて生成されたコンテナーを表わしています。</p>

<p><img src="https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/images/container-layers.jpg" alt="Ubuntu イメージに基づくコンテナーのレイヤー" /></p>

<p><strong>ストレージドライバー</strong> というものは、そういった各レイヤーが互いにやり取りできるようにします。
さまざまなストレージドライバーが利用可能であり、利用状況に応じて一長一短があります。</p>

<h2 id="container-and-layers">コンテナーとレイヤー</h2>

<p>コンテナーとイメージの最大の違いは、最上部に書き込みレイヤーがあるかどうかです。
コンテナーに対して新たに加えられたり修正されたりしたデータは、すべてこの書き込みレイヤーに保存されます。
コンテナーが削除されると、その書き込みレイヤーも同じく削除されます。
ただしその元にあったイメージは、変更されずに残ります。</p>

<p>複数のコンテナーを見た場合、そのコンテナーごとに個々の書き込み可能なコンテナーレイヤーがあって、データ更新はそのコンテナーレイヤーに保存されます。
したがって複数コンテナーでは、同一のイメージを共有しながらアクセスすることができ、しかも個々に見れば独自の状態を持つことができることになります。
以下の図は、Ubuntu 18.04 という同一のイメージを共有する複数コンテナーを示しています。</p>

<p><img src="https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/images/sharing-layers.jpg" alt="同一のイメージを共有する複数コンテナー" /></p>

<blockquote>
  <p><strong>メモ</strong>: 複数イメージを必要としていて、さらに同一のデータを共有してアクセスしたい場合は、そのデータを Docker ボリュームに保存して、コンテナー内でそれをマウントします。</p>
</blockquote>

<p>Docker はストレージドライバーを利用して、イメージレイヤーと書き込み可能なコンテナーレイヤーの各内容を管理します。
さまざまなストレージドライバーでは、異なる実装によりデータを扱います。
しかしどのようなドライバーであっても、積み上げ可能な（stackable）イメージレイヤーを取り扱い、コピーオンライト（copy-on-write; CoW）方式を採用します。</p>

<h2 id="container-size-on-disk">ディスク上のコンテナーサイズ</h2>

<p>稼働中コンテナーの概算サイズを確認するには <code class="highlighter-rouge">docker ps -s</code> コマンドを実行します。
サイズに関連した 2 つのデータがカラム表示されます。</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">size</code>: （ディスク上の）データ総量。各コンテナーの書き込み可能レイヤーに対して利用されるデータ部分です。</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">virtual size</code>: コンテナーにおいて利用されている読み込み専用のイメージデータと、コンテナーの書き込み可能レイヤーの <code class="highlighter-rouge">size</code> を足し合わせたデータ総量。
複数コンテナーにおいては、読み込み専用イメージデータの全部または一部を共有しているかもしれません。
Two containers started from the same image share 100% of the
read-only data, while two containers with different images which have layers
in common share those common layers. Therefore, you can’t just total the
virtual sizes. This over-estimates the total disk usage by a potentially
non-trivial amount.</p>
  </li>
</ul>

<p>The total disk space used by all of the running containers on disk is some
combination of each container’s <code class="highlighter-rouge">size</code> and the <code class="highlighter-rouge">virtual size</code> values. If
multiple containers started from the same exact image, the total size on disk for
these containers would be SUM (<code class="highlighter-rouge">size</code> of containers) plus one image size
(<code class="highlighter-rouge">virtual size</code>- <code class="highlighter-rouge">size</code>).</p>

<p>This also does not count the following additional ways a container can take up
disk space:</p>

<ul>
  <li>Disk space used for log files if you use the <code class="highlighter-rouge">json-file</code> logging driver. This
can be non-trivial if your container generates a large amount of logging data
and log rotation is not configured.</li>
  <li>Volumes and bind mounts used by the container.</li>
  <li>Disk space used for the container’s configuration files, which are typically
small.</li>
  <li>Memory written to disk (if swapping is enabled).</li>
  <li>Checkpoints, if you’re using the experimental checkpoint/restore feature.</li>
</ul>

<h2 id="the-copy-on-write-cow-strategy">コピーオンライト方式</h2>

<p>Copy-on-write is a strategy of sharing and copying files for maximum efficiency.
If a file or directory exists in a lower layer within the image, and another
layer (including the writable layer) needs read access to it, it just uses the
existing file. The first time another layer needs to modify the file (when
building the image or running the container), the file is copied into that layer
and modified. This minimizes I/O and the size of each of the subsequent layers.
These advantages are explained in more depth below.</p>

<h3 id="sharing-promotes-smaller-images">共有によりイメージサイズはより小さく</h3>

<p><code class="highlighter-rouge">docker pull</code> を実行してリポジトリからイメージをプルするとき、あるいはイメージから新たにコンテナーを生成するにあたってそのイメージがまだローカルに生成されていないとき、各レイヤーはプルによって個別に取得されて、Docker のローカル保存領域、たとえば Linux では通常 <code class="highlighter-rouge">/var/lib/docker/</code> に保存されます。
取得された各レイヤーは、以下の例のようにして確認することができます。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker pull ubuntu:18.04
18.04: Pulling from library/ubuntu
f476d66f5408: Pull <span class="nb">complete
</span>8882c27f669e: Pull <span class="nb">complete
</span>d9af21273955: Pull <span class="nb">complete
</span>f5029279ec12: Pull <span class="nb">complete
</span>Digest: sha256:ab6cb8de3ad7bb33e2534677f865008535427390b117d7939193f8d1a6613e34
Status: Downloaded newer image <span class="k">for </span>ubuntu:18.04
</code></pre></div></div>

<p>各レイヤーは、Docker ホストのローカル保存領域内にて、それぞれのディレクトリ配下に保存されます。
ファイルシステム上のレイヤーデータを確認するなら、<code class="highlighter-rouge">/var/lib/docker/&lt;storage-driver&gt;</code> の内容を一覧表示します。
以下は <code class="highlighter-rouge">overlay2</code> ストレージドライバーに対する例です。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">ls</span> /var/lib/docker/overlay2
16802227a96c24dcbeab5b37821e2b67a9f921749cd9a2e386d5a6d5bc6fc6d3
377d73dbb466e0bc7c9ee23166771b35ebdbe02ef17753d79fd3571d4ce659d7
3f02d96212b03e3383160d31d7c6aeca750d2d8a1879965b89fe8146594c453d
ec1ec45792908e90484f7e629330666e7eee599f08729c93890a7205a6ba35f5
l
</code></pre></div></div>

<p>ディレクトリ名はレイヤー ID に対応するものではありません。
（Docker 1.10 以降は、対応づくものになりました。）</p>

<p>ここで 2 つの異なる Dockerfile を利用している状況を考えます。
1 つめの Dockerfile からは <code class="highlighter-rouge">acme/my-base-image:1.0</code> というイメージが作られるものとします。</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FROM</span> <span class="n">ubuntu</span>:<span class="m">18</span>.<span class="m">04</span>
<span class="n">COPY</span> . /<span class="n">app</span>
</code></pre></div></div>

<p>2 つめの Dockerfile は <code class="highlighter-rouge">acme/my-base-image:1.0</code> をベースとして、さらにレイヤーを追加するものとします。</p>

<div class="language-conf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">FROM</span> <span class="n">acme</span>/<span class="n">my</span>-<span class="n">base</span>-<span class="n">image</span>:<span class="m">1</span>.<span class="m">0</span>
<span class="n">CMD</span> /<span class="n">app</span>/<span class="n">hello</span>.<span class="n">sh</span>
</code></pre></div></div>

<p>2 つめのイメージには 1 つめのイメージが持つレイヤーがすべて含まれ、さらに <code class="highlighter-rouge">CMD</code> 命令による新たなレイヤーと、読み書き可能なコンテナーレイヤーが加わっています。
Docker にとって 1 つめのイメージにおけるレイヤーはすべて取得済であるため、再度プルによって取得する必要がありません。
2 つのイメージにおいて共通して存在しているレイヤーは、すべて共有します。</p>

<p>この 2 つの Dockerfile からイメージをビルドした場合、<code class="highlighter-rouge">docker image ls</code> や <code class="highlighter-rouge">docker history</code> コマンドを使ってみると、共有されているレイヤーに対する暗号化 ID は同一になっていることがわかります。</p>

<ol>
  <li>
    <p>新規に <code class="highlighter-rouge">cow-test/</code> というディレクトリを生成して移動します。</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">cow-test/</code> ディレクトリにて、以下の内容で新規ファイルを生成します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
<span class="nb">echo</span> <span class="s2">"Hello world"</span>
</code></pre></div>    </div>

    <p>ファイルを保存して実行可能にします。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>chmod +x hello.sh
</code></pre></div>    </div>
  </li>
  <li>
    <p>前述した 1 つめの Dockerfile の内容を、新規ファイル <code class="highlighter-rouge">Dockerfile.base</code> にコピーします。</p>
  </li>
  <li>
    <p>前述した 2 つめの Dockerfile の内容を、新規ファイル <code class="highlighter-rouge">Dockerfile</code> にコピーします。</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">cow-test/</code> ディレクトリ内にて 1 つめのイメージをビルドします。
コマンドでは最後の <code class="highlighter-rouge">.</code> を記述するのを忘れないでください。
これは <code class="highlighter-rouge">PATH</code> を指定するものであり、イメージに対してファイルの追加が必要となる場合に、そのファイルを探し出す場所を Docker に指示するものです。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker build <span class="nt">-t</span> acme/my-base-image:1.0 <span class="nt">-f</span> Dockerfile.base <span class="nb">.</span>
Sending build context to Docker daemon  812.4MB
Step 1/2 : FROM ubuntu:18.04
 <span class="nt">---</span><span class="o">&gt;</span> d131e0fa2585
Step 2/2 : COPY <span class="nb">.</span> /app
 <span class="nt">---</span><span class="o">&gt;</span> Using cache
 <span class="nt">---</span><span class="o">&gt;</span> bd09118bcef6
Successfully built bd09118bcef6
Successfully tagged acme/my-base-image:1.0
</code></pre></div>    </div>
  </li>
  <li>
    <p>2 つめのイメージをビルドします。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker build <span class="nt">-t</span> acme/my-final-image:1.0 <span class="nt">-f</span> Dockerfile <span class="nb">.</span>

Sending build context to Docker daemon  4.096kB
Step 1/2 : FROM acme/my-base-image:1.0
 <span class="nt">---</span><span class="o">&gt;</span> bd09118bcef6
Step 2/2 : CMD /app/hello.sh
 <span class="nt">---</span><span class="o">&gt;</span> Running <span class="k">in </span>a07b694759ba
 <span class="nt">---</span><span class="o">&gt;</span> dbf995fc07ff
Removing intermediate container a07b694759ba
Successfully built dbf995fc07ff
Successfully tagged acme/my-final-image:1.0
</code></pre></div>    </div>
  </li>
  <li>
    <p>2 つのイメージのサイズを確認します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker image <span class="nb">ls

</span>REPOSITORY                         TAG                     IMAGE ID            CREATED             SIZE
acme/my-final-image                1.0                     dbf995fc07ff        58 seconds ago      103MB
acme/my-base-image                 1.0                     bd09118bcef6        3 minutes ago       103MB
</code></pre></div>    </div>
  </li>
  <li>
    <p>それぞれのイメージに含まれるレイヤーを確認します。</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">history </span>bd09118bcef6
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
bd09118bcef6        4 minutes ago       /bin/sh <span class="nt">-c</span> <span class="c">#(nop) COPY dir:35a7eb158c1504e...   100B</span>
d131e0fa2585        3 months ago        /bin/sh <span class="nt">-c</span> <span class="c">#(nop)  CMD ["/bin/bash"]            0B</span>
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> mkdir <span class="nt">-p</span> /run/systemd <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">'...   7B
&lt;missing&gt;           3 months ago        /bin/sh -c sed -i '</span>s/^#<span class="se">\s</span><span class="k">*</span><span class="se">\(</span>deb.<span class="k">*</span>universe<span class="se">\.</span>..   2.78kB
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> rm <span class="nt">-rf</span> /var/lib/apt/lists/<span class="k">*</span>          0B
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> <span class="nb">set</span> <span class="nt">-xe</span>   <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">'#!/bin/sh'</span> <span class="o">&gt;</span>...   745B
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> <span class="c">#(nop) ADD file:eef57983bd66e3a...   103MB</span>
</code></pre></div>    </div>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker <span class="nb">history </span>dbf995fc07ff

IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
dbf995fc07ff        3 minutes ago       /bin/sh <span class="nt">-c</span> <span class="c">#(nop)  CMD ["/bin/sh" "-c" "/a...   0B</span>
bd09118bcef6        5 minutes ago       /bin/sh <span class="nt">-c</span> <span class="c">#(nop) COPY dir:35a7eb158c1504e...   100B</span>
d131e0fa2585        3 months ago        /bin/sh <span class="nt">-c</span> <span class="c">#(nop)  CMD ["/bin/bash"]            0B</span>
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> mkdir <span class="nt">-p</span> /run/systemd <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">'...   7B
&lt;missing&gt;           3 months ago        /bin/sh -c sed -i '</span>s/^#<span class="se">\s</span><span class="k">*</span><span class="se">\(</span>deb.<span class="k">*</span>universe<span class="se">\.</span>..   2.78kB
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> rm <span class="nt">-rf</span> /var/lib/apt/lists/<span class="k">*</span>          0B
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> <span class="nb">set</span> <span class="nt">-xe</span>   <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">'#!/bin/sh'</span> <span class="o">&gt;</span>...   745B
&lt;missing&gt;           3 months ago        /bin/sh <span class="nt">-c</span> <span class="c">#(nop) ADD file:eef57983bd66e3a...   103MB</span>
</code></pre></div>    </div>

    <p>ほぼすべてのレイヤーが同一であって、ただ 2 つめのイメージの最上位レイヤーだけが違うのがわかります。
これを除けば、すべてのレイヤーが 2 つのイメージ間で共有されているので、各レイヤーは <code class="highlighter-rouge">/var/lib/docker/</code> には一度しか保存されません。
新たにできたレイヤーは、まったくと言ってよいほどに容量をとっていません。
というのも、そのレイヤーは何かのファイルを変更するわけでなく、単にコマンドを実行するだけのものであるからです。</p>

    <blockquote>
      <p><strong>メモ</strong>: <code class="highlighter-rouge">docker history</code> の出力において <code class="highlighter-rouge">&lt;missing&gt;</code> として示される行は、そのレイヤーが他のシステムにおいてビルドされていることを示しています。
したがってローカルシステム上では利用することができません。
この表示は無視して構いません。</p>
    </blockquote>
  </li>
</ol>

<h3 id="copying-makes-containers-efficient">コピーによりコンテナーを効率的に</h3>

<p>When you start a container, a thin writable container layer is added on top of
the other layers. Any changes the container makes to the filesystem are stored
here. Any files the container does not change do not get copied to this writable
layer. This means that the writable layer is as small as possible.</p>

<p>When an existing file in a container is modified, the storage driver performs a
copy-on-write operation. The specifics steps involved depend on the specific
storage driver. For the <code class="highlighter-rouge">aufs</code>, <code class="highlighter-rouge">overlay</code>, and <code class="highlighter-rouge">overlay2</code> drivers, the
copy-on-write operation follows this rough sequence:</p>

<ul>
  <li>
    <p>Search through the image layers for the file to update. The process starts
at the newest layer and works down to the base layer one layer at a time.
When results are found, they are added to a cache to speed future operations.</p>
  </li>
  <li>
    <p>Perform a <code class="highlighter-rouge">copy_up</code> operation on the first copy of the file that is found, to
copy the file to the container’s writable layer.</p>
  </li>
  <li>
    <p>Any modifications are made to this copy of the file, and the container cannot
see the read-only copy of the file that exists in the lower layer.</p>
  </li>
</ul>

<p>Btrfs, ZFS, and other drivers handle the copy-on-write differently. You can
read more about the methods of these drivers later in their detailed
descriptions.</p>

<p>Containers that write a lot of data consume more space than containers
that do not. This is because most write operations consume new space in the
container’s thin writable top layer.</p>

<blockquote>
  <p><strong>Note</strong>: for write-heavy applications, you should not store the data in
the container. Instead, use Docker volumes, which are independent of the
running container and are designed to be efficient for I/O. In addition,
volumes can be shared among containers and do not increase the size of your
container’s writable layer.</p>
</blockquote>

<p>A <code class="highlighter-rouge">copy_up</code> operation can incur a noticeable performance overhead. This overhead
is different depending on which storage driver is in use. Large files,
lots of layers, and deep directory trees can make the impact more noticeable.
This is mitigated by the fact that each <code class="highlighter-rouge">copy_up</code> operation only occurs the first
time a given file is modified.</p>

<p>To verify the way that copy-on-write works, the following procedures spins up 5
containers based on the <code class="highlighter-rouge">acme/my-final-image:1.0</code> image we built earlier and
examines how much room they take up.</p>

<blockquote>
  <p><strong>Note</strong>: This procedure doesn’t work on Docker Desktop for Mac or Docker Desktop for Windows.</p>
</blockquote>

<ol>
  <li>
    <p>From a terminal on your Docker host, run the following <code class="highlighter-rouge">docker run</code> commands.
The strings at the end are the IDs of each container.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">-dit</span> <span class="nt">--name</span> my_container_1 acme/my-final-image:1.0 bash <span class="se">\</span>
  <span class="o">&amp;&amp;</span> docker run <span class="nt">-dit</span> <span class="nt">--name</span> my_container_2 acme/my-final-image:1.0 bash <span class="se">\</span>
  <span class="o">&amp;&amp;</span> docker run <span class="nt">-dit</span> <span class="nt">--name</span> my_container_3 acme/my-final-image:1.0 bash <span class="se">\</span>
  <span class="o">&amp;&amp;</span> docker run <span class="nt">-dit</span> <span class="nt">--name</span> my_container_4 acme/my-final-image:1.0 bash <span class="se">\</span>
  <span class="o">&amp;&amp;</span> docker run <span class="nt">-dit</span> <span class="nt">--name</span> my_container_5 acme/my-final-image:1.0 bash

  c36785c423ec7e0422b2af7364a7ba4da6146cbba7981a0951fcc3fa0430c409
  dcad7101795e4206e637d9358a818e5c32e13b349e62b00bf05cd5a4343ea513
  1e7264576d78a3134fbaf7829bc24b1d96017cf2bc046b7cd8b08b5775c33d0c
  38fa94212a419a082e6a6b87a8e2ec4a44dd327d7069b85892a707e3fc818544
  1a174fc216cccf18ec7d4fe14e008e30130b11ede0f0f94a87982e310cf2e765
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run the <code class="highlighter-rouge">docker ps</code> command to verify the 5 containers are running.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONTAINER ID      IMAGE                     COMMAND     CREATED              STATUS              PORTS      NAMES
1a174fc216cc      acme/my-final-image:1.0   <span class="s2">"bash"</span>      About a minute ago   Up About a minute              my_container_5
38fa94212a41      acme/my-final-image:1.0   <span class="s2">"bash"</span>      About a minute ago   Up About a minute              my_container_4
1e7264576d78      acme/my-final-image:1.0   <span class="s2">"bash"</span>      About a minute ago   Up About a minute              my_container_3
dcad7101795e      acme/my-final-image:1.0   <span class="s2">"bash"</span>      About a minute ago   Up About a minute              my_container_2
c36785c423ec      acme/my-final-image:1.0   <span class="s2">"bash"</span>      About a minute ago   Up About a minute              my_container_1
</code></pre></div>    </div>
  </li>
  <li>
    <p>List the contents of the local storage area.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo ls</span> /var/lib/docker/containers

1a174fc216cccf18ec7d4fe14e008e30130b11ede0f0f94a87982e310cf2e765
1e7264576d78a3134fbaf7829bc24b1d96017cf2bc046b7cd8b08b5775c33d0c
38fa94212a419a082e6a6b87a8e2ec4a44dd327d7069b85892a707e3fc818544
c36785c423ec7e0422b2af7364a7ba4da6146cbba7981a0951fcc3fa0430c409
dcad7101795e4206e637d9358a818e5c32e13b349e62b00bf05cd5a4343ea513
</code></pre></div>    </div>
  </li>
  <li>
    <p>Now check out their sizes:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>du <span class="nt">-sh</span> /var/lib/docker/containers/<span class="k">*</span>

32K  /var/lib/docker/containers/1a174fc216cccf18ec7d4fe14e008e30130b11ede0f0f94a87982e310cf2e765
32K  /var/lib/docker/containers/1e7264576d78a3134fbaf7829bc24b1d96017cf2bc046b7cd8b08b5775c33d0c
32K  /var/lib/docker/containers/38fa94212a419a082e6a6b87a8e2ec4a44dd327d7069b85892a707e3fc818544
32K  /var/lib/docker/containers/c36785c423ec7e0422b2af7364a7ba4da6146cbba7981a0951fcc3fa0430c409
32K  /var/lib/docker/containers/dcad7101795e4206e637d9358a818e5c32e13b349e62b00bf05cd5a4343ea513
</code></pre></div>    </div>

    <p>Each of these containers only takes up 32k of space on the filesystem.</p>
  </li>
</ol>

<p>Not only does copy-on-write save space, but it also reduces start-up time.
When you start a container (or multiple containers from the same image), Docker
only needs to create the thin writable container layer.</p>

<p>If Docker had to make an entire copy of the underlying image stack each time it
started a new container, container start times and disk space used would be
significantly increased. This would be similar to the way that virtual machines
work, with one or more virtual disks per virtual machine.</p>

<h2 id="related-information">関連情報</h2>

<ul>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/storage/volumes.md">ボリューム</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/select-storage-driver/">ストレージドライバーの選定</a></li>
</ul>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=container">container</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=storage">storage</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=driver">driver</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=AUFS">AUFS</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=btfs">btfs</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=devicemapper">devicemapper</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=zvfs">zvfs</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/storage/storagedriver/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "storage/storagedriver/index.md",
										"title": "ストレージドライバーについて",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/storage/storagedriver/index.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/storage/storagedriver/index.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [storage/storagedriver/index.md](https://matsuand.github.io/docs.docker.jp.onthefly/storage/storagedriver/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#images-and-layers" class="nomunge">イメージとレイヤー</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#container-and-layers" class="nomunge">コンテナーとレイヤー</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#container-size-on-disk" class="nomunge">ディスク上のコンテナーサイズ</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#the-copy-on-write-cow-strategy" class="nomunge">コピーオンライト方式</a>
    <ul>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#sharing-promotes-smaller-images" class="nomunge">共有によりイメージサイズはより小さく</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#copying-makes-containers-efficient" class="nomunge">コピーによりコンテナーを効率的に</a></li>
    </ul>
  </li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/index.md#related-information" class="nomunge">関連情報</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/storage/storagedriver/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/collections_tocs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
