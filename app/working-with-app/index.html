<!-- Page generated 2019-07-26 10:17:30 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/app/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-07-26T10:17:30+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="Working with Docker App (experimental)"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="This is an experimental feature. 試験的な機能は、将来の製品に搭載される機能をいち早く試すことができるものです。 ただし現段階でのこの機能は、テストとフィードバックのためだけを意図しています。 したがってリリース時には予告なく変更される場合があり、将来のリリースでは完全に削除されることもあります。 試験的な機能は本番環境では利用しないでください。 Docker ではこの試験的機能に対するサポートは行っていません。 詳しくは Experimental features を参照してください。 To enable experimental features in the Docker CLI, edit the config.json file and set experimental..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker Documentation"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-07-26T10:17:30+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="Docker App, applications, compose, orchestration">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>Working with Docker App (experimental) | Docker Documentation</title>
<meta property="og:title" content="Working with Docker App (experimental)" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Learn about Docker App" />
<meta property="og:description" content="Learn about Docker App" />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/app/working-with-app/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/app/working-with-app/" />
<meta property="og:site_name" content="Docker Documentation" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Working with Docker App (experimental)","description":"Learn about Docker App","url":"https://matsuand.github.io/docs.docker.jp.onthefly/app/working-with-app/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03.1';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)         <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Working with Docker App (experimental)</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    14 分
  
</span>

							
							
							<blockquote>
  <p>This is an experimental feature.</p>

  <!-- This text will be included in the CLI plugin docs that are marked as experimental in Docker Enterprise 3.0 release -->
  <p>試験的な機能は、将来の製品に搭載される機能をいち早く試すことができるものです。
ただし現段階でのこの機能は、テストとフィードバックのためだけを意図しています。
したがってリリース時には予告なく変更される場合があり、将来のリリースでは完全に削除されることもあります。
試験的な機能は本番環境では利用しないでください。
Docker ではこの試験的機能に対するサポートは行っていません。
詳しくは <a href="https://success.docker.com/article/experimental-features">Experimental features</a> を参照してください。</p>

  <p>To enable experimental features in the Docker CLI, edit the <code class="highlighter-rouge">config.json</code> file and set <code class="highlighter-rouge">experimental</code> to enabled.</p>

  <p>To enable experimental features from the Docker Desktop menu, click <strong>Settings</strong> (<strong>Preferences</strong> on macOS) &gt; <strong>Daemon</strong> and then select the <strong>Experimental features</strong> check box.</p>
</blockquote>

<h2 id="overview">Overview</h2>

<p>Docker App is a CLI plug-in that introduces a top-level <code class="highlighter-rouge">docker app</code> command to bring
the <em>container experience</em> to applications. The following table compares Docker containers with Docker applications.</p>

<table>
  <thead>
    <tr>
      <th>Object</th>
      <th>Config file</th>
      <th>Build with</th>
      <th>Execute with</th>
      <th>Share with</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Container</td>
      <td>Dockerfile</td>
      <td>docker image build</td>
      <td>docker container run</td>
      <td>docker image push</td>
    </tr>
    <tr>
      <td>App</td>
      <td>App Package</td>
      <td>docker app bundle</td>
      <td>docker app install</td>
      <td>docker app push</td>
    </tr>
  </tbody>
</table>

<p>With Docker App, entire applications can now be managed as easily as images and containers. For example,
Docker App lets you  <em>build</em>, <em>validate</em> and <em>deploy</em> applications with the <code class="highlighter-rouge">docker app</code> command. You can
even leverage secure supply-chain features such as signed <code class="highlighter-rouge">push</code> and <code class="highlighter-rouge">pull</code> operations.</p>

<blockquote>
  <p><strong>NOTE</strong>: <code class="highlighter-rouge">docker app</code> works with <code class="highlighter-rouge">Engine - Community 19.03</code> or higher and <code class="highlighter-rouge">Engine - Enterprise 19.03</code> or higher.</p>
</blockquote>

<p>This guide walks you through two scenarios:</p>

<ol>
  <li>Initialize and deploy a new Docker App project from scratch.</li>
  <li>Convert an existing Compose app into a Docker App project (added later in the beta process).</li>
</ol>

<p>The first scenario describes basic components of a Docker App with tools and workflow.</p>

<h2 id="initialize-and-deploy-a-new-docker-app-project-from-scratch">Initialize and deploy a new Docker App project from scratch</h2>

<p>This section describes the steps for creating a new Docker App project to familiarize you with the workflow and most important commands.</p>

<ol>
  <li>Prerequisites</li>
  <li>Initialize an empty new project</li>
  <li>Populate the project</li>
  <li>Validate the app</li>
  <li>Deploy the app</li>
  <li>Push the app to Docker Hub or Docker Trusted Registry</li>
  <li>Install the app directly from Docker Hub</li>
</ol>

<h3 id="prerequisites">Prerequisites</h3>

<p>You need at least one Docker node operating in Swarm mode. You also need the latest build of the Docker CLI
with the App CLI plugin included.</p>

<p>Depending on your Linux distribution and your security context, you might need to prepend commands with <code class="highlighter-rouge">sudo</code>.</p>

<h3 id="initialize-a-new-empty-project">Initialize a new empty project</h3>

<p>The <code class="highlighter-rouge">docker app init</code> command is used to initialize a new Docker application project. If you run it on
its own, it initializes a new empty project. If you point it to an existing <code class="highlighter-rouge">docker-compose.yml</code> file,
it initializes a new project based on the Compose file.</p>

<p>Use the following command to initialize a new empty project called “hello-world”.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app init --single-file hello-world
Created "hello-world.dockerapp"
</code></pre></div></div>

<p>The command produces a single file in your current directory called <code class="highlighter-rouge">hello-world.dockerapp</code>.
The format of the file name is   <project-name> appended with `.dockerapp`.</project-name>
</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ls
hello-world.dockerapp
</code></pre></div></div>

<p>If you run <code class="highlighter-rouge">docker app init</code> without the <code class="highlighter-rouge">--single-file</code> flag, you get a new directory containing three YAML files.
The name of the directory is the name of the project with <code class="highlighter-rouge">.dockerapp</code> appended, and the three YAML files are:</p>

<ul>
  <li><code class="highlighter-rouge">docker-compose.yml</code></li>
  <li><code class="highlighter-rouge">metadata.yml</code></li>
  <li><code class="highlighter-rouge">parameters.yml</code></li>
</ul>

<p>However, the <code class="highlighter-rouge">--single-file</code> option merges the three YAML files into a single YAML file with three sections.
Each of these sections relates to one of the three YAML files mentioned previously: <code class="highlighter-rouge">docker-compose.yml</code>,
<code class="highlighter-rouge">metadata.yml</code>, and <code class="highlighter-rouge">parameters.yml</code>. Using the <code class="highlighter-rouge">--single-file</code> option enables you to share your application
using a single configuration file.</p>

<p>Inspect the YAML with the following command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat hello-world.dockerapp
# Application metadata - equivalent to metadata.yml.
version: 0.1.0
name: hello-world
description:
---
# Application services - equivalent to docker-compose.yml.
version: "3.6"
services: {}
---
# Default application parameters - equivalent to parameters.yml.
</code></pre></div></div>

<p>Your file might be more verbose.</p>

<p>Notice that each of the three sections is separated by a set of three dashes (“---“). Let’s quickly describe each section.</p>

<p>The first section of the file specifies identification metadata such as name, version,
description and maintainers. It accepts key-value pairs. This part of the file can be a separate file called <code class="highlighter-rouge">metadata.yml</code></p>

<p>The second section of the file describes the application. It can be a separate file called <code class="highlighter-rouge">docker-compose.yml</code>.</p>

<p>The final section specifies default values for application parameters. It can be a separate file called <code class="highlighter-rouge">parameters.yml</code></p>

<h3 id="populate-the-project">Populate the project</h3>

<p>This section describes editing the project YAML file so that it runs a simple web app.</p>

<p>Use your preferred editor to edit the <code class="highlighter-rouge">hello-world.dockerapp</code> YAML file and update the application section with
the following information:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>version: "3.6"
services:
  hello:
    image: hashicorp/http-echo
    command: ["-text", "${hello.text}"]
    ports:
      - ${hello.port}:5678
</code></pre></div></div>

<p>Update the <code class="highlighter-rouge">Parameters</code> section to the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hello:
  port: 8080
  text: Hello world!
</code></pre></div></div>

<p>The sections of the YAML file are currently order-based. This means it’s important they remain in the order we’ve explained, with the <em>metadata</em> section being first, the <em>app</em> section being second, and the <em>parameters</em> section being last. This may change to name-based sections in future releases.</p>

<p>Save the changes.</p>

<p>The application is updated to run a single-container application based on the <code class="highlighter-rouge">hashicorp/http-echo</code> web server image.
This image has it execute a single command that displays some text and exposes itself on a network port.</p>

<p>Following best practices, the configuration of the application is decoupled from the application itself using variables.
In this case, the text displayed by the app and the port on which it will be published are controlled by two variables defined in the <code class="highlighter-rouge">Parameters</code> section of the file.</p>

<p>Docker App provides the <code class="highlighter-rouge">inspect</code> subcommand to provide a prettified summary of the application configuration.
It is a quick way to check how to configure the application before deployment, without having to read
the <code class="highlighter-rouge">Compose file</code>. It’s important to note that the application is not running at this point, and that
the <code class="highlighter-rouge">inspect</code> operation inspects the configuration file(s).</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app inspect hello-world.dockerapp
hello-world 0.1.0

Service (1) Replicas Ports Image
----------- -------- ----- -----
hello       1        8080  hashicorp/http-echo

Parameters (2) Value
-------------- -----
hello.port     8080
hello.text     Hello world!
</code></pre></div></div>

<p><code class="highlighter-rouge">docker app inspect</code> operations fail if the <code class="highlighter-rouge">Parameters</code> section doesn’t specify a default value for
every parameter expressed in the app section.</p>

<p>The application is ready to be validated and rendered.</p>

<h3 id="validate-the-app">Validate the app</h3>

<p>Docker App provides the <code class="highlighter-rouge">validate</code> subcommand to check syntax and other aspects of the configuration.
If the app passes validation, the command returns no arguments.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app validate hello-world.dockerapp
Validated "hello-world.dockerapp"
</code></pre></div></div>

<p><code class="highlighter-rouge">docker app validate</code> operations fail if the <code class="highlighter-rouge">Parameters</code> section doesn’t specify a default value for
every parameter expressed in the app section.</p>

<p>As the <code class="highlighter-rouge">validate</code> operation has returned no problems, the app is ready to be deployed.</p>

<h3 id="deploy-the-app">Deploy the app</h3>

<p>There are several options for deploying a Docker App project.</p>

<ul>
  <li>Deploy as a native Docker App application</li>
  <li>Deploy as a Compose app application</li>
  <li>Deploy as a Docker Stack application</li>
</ul>

<p>All three options are discussed, starting with deploying as a native Dock App application.</p>

<h4 id="deploy-as-a-native-docker-app">Deploy as a native Docker App</h4>

<p>The process for deploying as a native Docker app is as follows:</p>

<p>Use <code class="highlighter-rouge">docker app install</code> to deploy the application.</p>

<p>Use the following command to deploy (install) the application.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app install hello-world.dockerapp --name my-app
Creating network my-app_default
Creating service my-app_hello
Application "my-app" installed on context "default"
</code></pre></div></div>

<p>By default, <code class="highlighter-rouge">docker app</code> uses the <a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/context/working-with-contexts">current context</a> to run the
installation container and as a target context to deploy the application. You can override the second context
using the flag <code class="highlighter-rouge">--target-context</code> or by using the environment variable <code class="highlighter-rouge">DOCKER_TARGET_CONTEXT</code>. This flag is also
available for the commands <code class="highlighter-rouge">status</code>, <code class="highlighter-rouge">upgrade</code>, and <code class="highlighter-rouge">uninstall</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app install hello-world.dockerapp --name my-app --target-context=my-big-production-cluster
Creating network my-app_default
Creating service my-app_hello
Application "my-app" installed on context "my-big-production-cluster"
</code></pre></div></div>

<blockquote>
  <p><strong>Note</strong>: Two applications deployed on the same target context cannot share the same name, but this is
valid if they are deployed on different target contexts.</p>
</blockquote>

<p>You can check the status of the app with the <code class="highlighter-rouge">docker app status &lt;app-name&gt;</code> command.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app status my-app
INSTALLATION
------------
Name:         my-app
Created:      35 seconds
Modified:     31 seconds
Revision:     01DCMY7MWW67AY03B029QATXFF
Last Action:  install
Result:       SUCCESS
Orchestrator: swarm

APPLICATION
-----------
Name:      hello-world
Version:   0.1.0
Reference:

PARAMETERS
----------
hello.port: 8080
hello.text: Hello, World!

STATUS
------
ID              NAME            MODE          REPLICAS    IMAGE             PORTS
miqdk1v7j3zk    my-app_hello    replicated    1/1         hashicorp/http-echo:latest   *:8080-&gt;5678/tcp
</code></pre></div></div>

<p>The app is deployed using the stack orchestrator. This means you can also inspect it using the regular <code class="highlighter-rouge">docker stack</code> commands.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker stack ls
NAME                SERVICES            ORCHESTRATOR
my-app              1                   Swarm
</code></pre></div></div>

<p>Now that the app is running, you can point a web browser at the DNS name or public IP of the Docker node on
port 8080 and see the app. You must ensure traffic to port 8080 is allowed on
the connection form your browser to your Docker host.</p>

<p>Now change the port of the application using <code class="highlighter-rouge">docker app upgrade &lt;app-name&gt;</code> command.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app upgrade my-app --hello.port=8181
Upgrading service my-app_hello
Application "my-app" upgraded on context "default"
</code></pre></div></div>

<p>You can uninstall the app with <code class="highlighter-rouge">docker app uninstall my-app</code>.</p>

<h4 id="deploy-as-a-docker-compose-app">Deploy as a Docker Compose app</h4>

<p>The process for deploying as a Compose app comprises two major steps:</p>

<ol>
  <li>Render the Docker app project as a <code class="highlighter-rouge">docker-compose.yml</code> file.</li>
  <li>Deploy the app using <code class="highlighter-rouge">docker-compose up</code>.</li>
</ol>

<p>You need a recent version of Docker Compose to complete these steps.</p>

<p>Rendering is the process of reading the entire application configuration and outputting it as a single <code class="highlighter-rouge">docker-compose.yml</code> file. This creates a Compose file with hard-coded values wherever a parameter was specified as a variable.</p>

<p>Use the following command to render the app to a Compose file called <code class="highlighter-rouge">docker-compose.yml</code> in the current directory.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app render --output docker-compose.yml hello-world.dockerapp
</code></pre></div></div>

<p>Check the contents of the resulting <code class="highlighter-rouge">docker-compose.yml</code> file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat docker-compose.yml
version: "3.6"
services:
  hello:
    command:
    - -text
    - Hello world!
    image: hashicorp/http-echo
    ports:
    - mode: ingress
      target: 5678
      published: 8080
      protocol: tcp
</code></pre></div></div>

<p>Notice that the file contains hard-coded values that were expanded based on the contents of the <code class="highlighter-rouge">Parameters</code>
section of the project’s YAML file. For example, <code class="highlighter-rouge">${hello.text}</code> has been expanded to “Hello world!”.</p>

<blockquote>
  <p><strong>Note</strong>: Almost all the <code class="highlighter-rouge">docker app</code> commands propose the <code class="highlighter-rouge">--set key=value</code> flag to override a default parameter.</p>
</blockquote>

<p>Try to render the application with a different text:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app render hello-world.dockerapp --set hello.text="Hello whales!"
version: "3.6"
services:
  hello:
    command:
    - -text
    - Hello whales!
    image: hashicorp/http-echo
    ports:
    - mode: ingress
      target: 5678
      published: 8080
      protocol: tcp
</code></pre></div></div>

<p>Use <code class="highlighter-rouge">docker-compose up</code> to deploy the app.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker-compose up --detach
WARNING: The Docker Engine you're using is running in swarm mode.
&lt;Snip&gt;
</code></pre></div></div>

<p>The application is now running as a Docker Compose app and should be reachable on port <code class="highlighter-rouge">8080</code> on your Docker host.
You must ensure traffic to port <code class="highlighter-rouge">8080</code> is allowed on the connection form your browser to your Docker host.</p>

<p>You can use <code class="highlighter-rouge">docker-compose down</code> to stop and remove the application.</p>

<h4 id="deploy-as-a-docker-stack">Deploy as a Docker Stack</h4>

<p>Deploying the app as a Docker stack is a two-step process very similar to deploying it as a Docker Compose app.</p>

<ol>
  <li>Render the Docker app project as a <code class="highlighter-rouge">docker-compose.yml</code> file.</li>
  <li>Deploy the app using <code class="highlighter-rouge">docker stack deploy</code>.</li>
</ol>

<p>Complete the steps in the previous section to render the Docker app project as a Compose file and make sure
you’re ready to deploy it as a Docker Stack. Your Docker host must be in Swarm mode.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker stack deploy hello-world-app -c docker-compose.yml
Creating network hello-world-app_default
Creating service hello-world-app_hello
</code></pre></div></div>

<p>The app is now deployed as a Docker stack and can be reached on port <code class="highlighter-rouge">8080</code> on your Docker host.</p>

<p>Use the <code class="highlighter-rouge">docker stack rm hello-world-app</code> command to stop and remove the stack. You must ensure traffic to
port <code class="highlighter-rouge">8080</code> is allowed on the connection form your browser to your Docker host.</p>

<h3 id="push-the-app-to-docker-hub">Push the app to Docker Hub</h3>

<p>As mentioned in the introduction, <code class="highlighter-rouge">docker app</code> lets you manage entire applications the same way that you
currently manage container images. For example, you can push and pull entire applications from registries like
Docker Hub with <code class="highlighter-rouge">docker app push</code> and <code class="highlighter-rouge">docker app pull</code>. Other <code class="highlighter-rouge">docker app</code> commands, such
as <code class="highlighter-rouge">install</code>, <code class="highlighter-rouge">upgrade</code>, <code class="highlighter-rouge">inspect</code> and <code class="highlighter-rouge">render</code> can be performed directly on applications while they are
stored in a registry.</p>

<p>The following section contains some examples.</p>

<p>Push the application to Docker Hub. To complete this step, you need a valid Docker ID and you must be
logged in to the registry to which you are pushing the app.</p>

<p>Be sure to replace the registry ID in the following example with your own.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app push my-app --tag nigelpoulton/app-test:0.1.0
docker app push hello-world.dockerapp --tag nigelpoulton/app-test:0.1.0
docker.io/nigelpoulton/app-test:0.1.0-invoc
hashicorp/http-echo
 application/vnd.docker.distribution.manifest.v2+json [2/2] (sha256:ba27d460...)
&lt;Snip&gt;
</code></pre></div></div>

<p>The app is now stored in the container registry.</p>

<h3 id="push-the-app-to-dtr">Push the app to DTR</h3>

<p>Pushing an app to Docker Trusted Registry (DTR) involves the same procedure as <a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#push-the-app-to-docker-hub">pushing an app to Docker Hub</a> except that you need your DTR user credentials and <a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/dtr/user/manage-images/review-repository-info/">your DTR repository information</a>. To use client certificates for DTR authentication, see <a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/enable-client-certificate-authentication/">Enable Client Certificate Authentication</a>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker app push my-app <span class="nt">--tag</span> &lt;dtr-fqdn&gt;/nigelpoulton/app-test:0.1.0
&lt;dtr-fqdn&gt;/nigelpoulton/app-test:0.1.0-invoc
hashicorp/http-echo
 application/vnd.docker.distribution.manifest.v2+json <span class="o">[</span>2/2] <span class="o">(</span>sha256:bd1a813b...<span class="o">)</span>
Successfully pushed bundle to &lt;dtr-fqdn&gt;/nigelpoulton/app-test:0.1.0.
Digest is sha256:bd1a813b6301939fa46e617f96711e0cca1e4065d2d724eb86abde6ef7b18e23.
</code></pre></div></div>

<p>The app is now stored in your DTR.</p>

<h3 id="install-the-app-directly-from-docker-hub-or-dtr">Install the app directly from Docker Hub or DTR</h3>

<p>Now that the app is pushed to the registry, try an <code class="highlighter-rouge">inspect</code> and <code class="highlighter-rouge">install</code> command against it.
The location of your app is different from the one provided in the examples.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app inspect nigelpoulton/app-test:0.1.0
hello-world 0.1.0

Service (1) Replicas Ports Image
----------- -------- ----- -----
hello       1        8080  nigelpoulton/app-test@sha256:ba27d460cd1f22a1a4331bdf74f4fccbc025552357e8a3249c40ae216275de96

Parameters (2) Value
-------------- -----
hello.port     8080
hello.text     Hello world!
</code></pre></div></div>

<p>This action was performed directly against the app in the registry. Note that for DTR, the application will be prefixed with the Fully Qualified Domain Name (FQDN) of your trusted registry.</p>

<p>Now install it as a native Docker App by referencing the app in the registry, with a different port.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app install nigelpoulton/app-test:0.1.0 --set hello.port=8181
Creating network hello-world_default
Creating service hello-world_hello
Application "hello-world" installed on context "default"
</code></pre></div></div>

<p>Test that the app is working.</p>

<p>The app used in these examples is a simple web server that displays the text “Hello world!” on port 8181,
your app might be different.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl http://localhost:8181
Hello world!
</code></pre></div></div>

<p>Uninstall the app.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker app uninstall hello-world
Removing service hello-world_hello
Removing network hello-world_default
Application "hello-world" uninstalled on context "default"
</code></pre></div></div>

<p>You can see the name of your Docker App with the <code class="highlighter-rouge">docker stack ls</code> command.</p>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=Docker App">Docker App</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=applications">applications</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=compose">compose</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=orchestration">orchestration</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/app/working-with-app/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "app/working-with-app.md",
										"title": "Working with Docker App (experimental)",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/app/working-with-app.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/app/working-with-app.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [app/working-with-app.md](https://matsuand.github.io/docs.docker.jp.onthefly/app/working-with-app/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#overview" class="nomunge">Overview</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#initialize-and-deploy-a-new-docker-app-project-from-scratch" class="nomunge">Initialize and deploy a new Docker App project from scratch</a>
    <ul>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#prerequisites" class="nomunge">Prerequisites</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#initialize-a-new-empty-project" class="nomunge">Initialize a new empty project</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#populate-the-project" class="nomunge">Populate the project</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#validate-the-app" class="nomunge">Validate the app</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#deploy-the-app" class="nomunge">Deploy the app</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#push-the-app-to-docker-hub" class="nomunge">Push the app to Docker Hub</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#push-the-app-to-dtr" class="nomunge">Push the app to DTR</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/working-with-app.md#install-the-app-directly-from-docker-hub-or-dtr" class="nomunge">Install the app directly from Docker Hub or DTR</a></li>
    </ul>
  </li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03.1';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/app/working-with-app/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/collections_tocs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
