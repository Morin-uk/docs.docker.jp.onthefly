<!-- Page generated 2019-11-16 14:25:28 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
	<!-- End Google Tag Manager -->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-11-16T14:25:28+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="Upgrade Docker Enterprise"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="To upgrade Docker Enterprise, you must individually upgrade each of the following components: Docker Engine - Enterprise. Universal Control Plane (UCP). Docker Trusted Registry (DTR). Because some components become temporarily..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker ドキュメント"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-11-16T14:25:28+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="enterprise, upgrade">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>Upgrade Docker Enterprise | Docker ドキュメント</title>
<meta property="og:title" content="Upgrade Docker Enterprise" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Learn how to upgrade your Docker Enterprise to start using the latest features and security patches." />
<meta property="og:description" content="Learn how to upgrade your Docker Enterprise to start using the latest features and security patches." />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/upgrade/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/ee/upgrade/" />
<meta property="og:site_name" content="Docker ドキュメント" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Upgrade Docker Enterprise","description":"Learn how to upgrade your Docker Enterprise to start using the latest features and security patches.","url":"https://matsuand.github.io/docs.docker.jp.onthefly/ee/upgrade/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)         <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Upgrade Docker Enterprise</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    9 分
  
</span>

							
							
							<p>To upgrade Docker Enterprise, you must individually upgrade each of the
following components:</p>

<ol>
  <li>Docker Engine - Enterprise.</li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/ucp/admin/install/upgrade/">Universal Control Plane (UCP)</a>.</li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/dtr/admin/upgrade/">Docker Trusted Registry (DTR)</a>.</li>
</ol>

<p>Because some components become temporarily unavailable during an upgrade, schedule upgrades to occur outside of
peak business hours to minimize impact to your business.</p>

<h2 id="cluster-upgrade-best-practices">Cluster upgrade best practices</h2>
<p>Docker Engine - Enterprise upgrades in Swarm clusters should follow these guidelines in order to avoid IP address
space exhaustion and associated application downtime.</p>

<ul>
  <li>New workloads should not be actively scheduled in the cluster during upgrades.</li>
  <li>Differences in the major (X.y.z.) or minor (x.Y.z) version numbers between the managers and workers can cause unintended consequences when new workloads are scheduled.</li>
  <li>Manager nodes should all be upgraded first before upgrading worker nodes. Upgrading manager nodes sequentially is recommended if live workloads are running in the cluster during the upgrade.</li>
  <li>Once manager nodes are upgraded worker nodes should be upgraded next and then the Swarm cluster upgrade is complete.</li>
  <li>If running UCP, the UCP upgrade should follow once all of the Swarm engines have been upgraded.</li>
</ul>

<h2 id="create-a-backup">Create a backup</h2>

<p>Before upgrading Docker Engine - Enterprise, you should make sure you <a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/backup/">create a backup</a>.
This makes it possible to recover if anything goes wrong during the upgrade.</p>

<h2 id="check-the-compatibility-matrix">Check the compatibility matrix</h2>

<p>You should also check the <a href="https://success.docker.com/Policies/Compatibility_Matrix">compatibility matrix</a>,
to make sure all Docker EE components are certified to work with one another.
You may also want to check the
<a href="https://success.docker.com/Policies/Maintenance_Lifecycle">Docker EE maintenance lifecycle</a>,
to understand until when your version may be supported.</p>

<h2 id="apply-firewall-rules">Apply firewall rules</h2>

<p>Before you upgrade, make sure:</p>

<ul>
  <li>Your firewall rules are configured to allow traffic in the ports UCP uses
for communication. Learn about <a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/ucp/admin/install/system-requirements/#ports-used">UCP port requirements</a>.</li>
  <li>Make sure you don’t have containers or services that are listening on ports
used by UCP.</li>
  <li>Configure your load balancer to forward TCP traffic to the Kubernetes API
server port (6443/TCP by default) running on manager nodes.</li>
</ul>

<blockquote class="important">
  <p>Certificates</p>

  <p>Externally signed certificates are used by the Kubernetes API server and
the UCP controller.</p>
</blockquote>

<h2 id="ip-address-consumption-in-1809">IP address consumption in 18.09+</h2>

<p>In Swarm overlay networks, each task connected to a network consumes an IP address on that network. Swarm networks have a
finite amount of IPs based on the <code class="highlighter-rouge">--subnet</code> configured when the network is created. If no subnet is specified then Swarm
defaults to a <code class="highlighter-rouge">/24</code> network with 254 available IP addresses. When the IP space of a network is fully consumed, Swarm tasks
can no longer be scheduled on that network.</p>

<p>Starting with Docker Engine - Enterprise 18.09 and later, each Swarm node will consume an IP address from every Swarm
network. This IP address is consumed by the Swarm internal load balancer on the network. Swarm networks running on Engine
versions 18.09 or greater must be configured to account for this increase in IP usage. Networks at or near consumption
prior to engine version 18.09 may have a risk of reaching full utilization that will prevent tasks from being scheduled
on to the network.</p>

<p>Maximum IP consumption per network at any given moment follows the following formula:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Max IP Consumed per Network = Number of Tasks on a Swarm Network + 1 IP for each node where these tasks are scheduled
</code></pre></div></div>

<p>To prevent this from happening, overlay networks should have enough capacity prior to an upgrade to 18.09, such that the network will have enough capacity after the upgrade. The below instructions offer tooling and steps to ensure capacity is measured before performing an upgrade.</p>

<blockquote>
  <p>The above following only applies to containers running on Swarm overlay networks. This does not impact bridge, macvlan, host, or 3rd party docker networks.</p>
</blockquote>

<h2 id="upgrade-docker-engine---enterprise">Upgrade Docker Engine - Enterprise</h2>

<p>To avoid application downtime, you should be running Docker Engine - Enterprise in
Swarm mode and deploying your workloads as Docker services. That way you can
drain the nodes of any workloads before starting the upgrade.</p>

<p>If you have workloads running as containers as opposed to swarm services,
make sure they are configured with a <a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/admin/start-containers-automatically/">restart policy</a>.
This ensures that your containers are started automatically after the upgrade.</p>

<p>To ensure that workloads running as Swarm services have no downtime, you need to:</p>

<ol>
  <li>Determine if the network is in danger of exhaustion; and remediate to a new, larger network prior to upgrading.</li>
  <li>Drain the node you want to upgrade so that services get scheduled in another node.</li>
  <li>Upgrade the Docker Engine on that node.</li>
  <li>Make the node available again.</li>
</ol>

<p>If you do this sequentially for every node, you can upgrade with no application downtime.
When upgrading manager nodes, make sure the upgrade of a node finishes before
you start upgrading the next node. Upgrading multiple manager nodes at the same
time can lead to a loss of quorum, and possible data loss.</p>

<h3 id="determine-if-the-network-is-in-danger-of-exhaustion">Determine if the network is in danger of exhaustion</h3>

<p>Starting with a cluster with one or more services configured, determine whether some networks
may require updating the IP address space in order to function correctly after an Docker
Engine - Enterprise 18.09 upgrade.</p>

<ol>
  <li>
    <p>SSH into a manager node on a cluster where your applications are running.</p>
  </li>
  <li>
    <p>Run the following:</p>
  </li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker run -it --rm -v /var/run/docker.sock:/var/run/docker.sock docker/ip-util-check
</code></pre></div></div>

<p>If the network is in danger of exhaustion, the output will show similar warnings or errors:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Overlay IP Utilization Report
    ----
    Network ex_net1/XXXXXXXXXXXX has an IP address capacity of 29 and uses 28 addresses
            ERROR: network will be over capacity if upgrading Docker engine version 18.09
                   or later.
    ----
    Network ex_net2/YYYYYYYYYYYY has an IP address capacity of 29 and uses 24 addresses
            WARNING: network could exhaust IP addresses if the cluster scales to 5 or more nodes
    ----
    Network ex_net3/ZZZZZZZZZZZZ has an IP address capacity of 61 and uses 52 addresses
            WARNING: network could exhaust IP addresses if the cluster scales to 9 or more nodes
</code></pre></div></div>

<ol>
  <li>Once you determine all networks are sized appropriately, start the upgrade on the Swarm managers.</li>
</ol>

<h4 id="triage-and-fix-an-upgrade-that-exhausted-ip-address-space">Triage and fix an upgrade that exhausted IP address space</h4>

<p>With an exhausted network, you can triage it using the following steps.</p>

<ol>
  <li>
    <p>SSH into a manager node on a cluster where your applications are running.</p>
  </li>
  <li>
    <p>Check the <code class="highlighter-rouge">docker service ls</code> output. It will display the service that is  unable to completely fill all its replicas such as:</p>
  </li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ID                  NAME                MODE                REPLICAS   IMAGE               PORTS
wn3x4lu9cnln        ex_service          replicated          19/24      nginx:latest
</code></pre></div></div>

<ol>
  <li>Use <code class="highlighter-rouge">docker service ps ex_service</code> to find a failed replica such as:</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ID                  NAME                IMAGE               NODE                DESIRED STATE       CURRENT STATE              ERROR               PORTS
    ...
i64lee19ia6s         \_ ex_service.11   nginx:latest        tk1706-ubuntu-1     Shutdown            Rejected 7 minutes ago     "node is missing network attac…"
    ...
</code></pre></div></div>

<ol>
  <li>Examine the error using <code class="highlighter-rouge">docker inspect</code>. In this example, the  <code class="highlighter-rouge">docker inspect i64lee19ia6s</code> output shows the error in the <code class="highlighter-rouge">Status.Err</code> field:</li>
</ol>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
            "Status": {
                "Timestamp": "2018-08-24T21:03:37.885405884Z",
                "State": "rejected",
                "Message": "preparing",
                **"Err": "node is missing network attachments, ip addresses may be exhausted",**
                "ContainerStatus": {
                    "ContainerID": "",
                    "PID": 0,
                    "ExitCode": 0
                },
                "PortStatus": {}
            },
    ...
</code></pre></div></div>

<ol>
  <li>
    <p>Adjust your network subnet in the deployment manifest, such that it has enough IPs required by the application.</p>
  </li>
  <li>
    <p>Redeploy the application.</p>
  </li>
  <li>
    <p>Confirm the adjusted service deployed successfully.</p>
  </li>
</ol>

<h3 id="manager-upgrades-when-moving-to-docker-engine---enterprise-1809-and-later">Manager upgrades when moving to Docker Engine - Enterprise 18.09 and later</h3>

<p>The following is a constraint introduced by architectural changes to the Swarm overlay networking when
upgrading to Docker Engine - Enterprise 18.09 or later. It only applies to this one-time upgrade and to workloads
that are using the Swarm overlay driver. Once upgraded to Docker Engine - Enterprise 18.09, this
constraint does not impact future upgrades.</p>

<p>When upgrading to Docker Engine - Enterprise 18.09, manager nodes cannot reschedule new workloads on the
managers until all managers have been upgraded to the Docker Engine - Enterprise 18.09 (or higher) version.
During the upgrade of the managers, there is a possibility that any new workloads that are scheduled on
the managers will fail to schedule until all of the managers have been upgraded.</p>

<p>In order to avoid any impactful application downtime, it is advised to reschedule any critical workloads
on to Swarm worker nodes during the upgrade of managers. Worker nodes and their network functionality
will continue to operate independently during any upgrades or outages on the managers. Note that this
restriction only applies to managers and not worker nodes.</p>

<h3 id="drain-the-node">Drain the node</h3>

<p>If you are running live application on the cluster while upgrading, remove applications from nodes being upgrades
as to not create unplanned outages.</p>

<p>Start by draining the node so that services get scheduled in another node and
continue running without downtime.</p>

<p>For that, run this command on a manager node:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker node update --availability drain &lt;node&gt;
</code></pre></div></div>

<h3 id="perform-the-upgrade">Perform the upgrade</h3>

<p>To upgrade a node individually by operating system, please follow the instructions
listed below:</p>

<ul>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/install/windows/docker-ee.md#update-docker-ee">Windows Server</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/install/linux/docker-ee/ubuntu.md#upgrade-docker-ee">Ubuntu</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/install/linux/docker-ee/rhel.md#upgrade-docker-ee">RHEL</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/install/linux/docker-ee/centos.md#upgrade-docker-ee">CentOS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/install/linux/docker-ee/oracle.md#upgrade-docker-ee">Oracle Linux</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/install/linux/docker-ee/suse.md#upgrade-docker-ee">SLES</a></li>
</ul>

<h3 id="post-upgrade-steps-for-docker-engine---enterprise">Post-Upgrade steps for Docker Engine - Enterprise</h3>

<p>After all manager and worker nodes have been upgrades, the Swarm cluster can be used again to schedule new
workloads. If workloads were previously scheduled off of the managers, they can be rescheduled again.
If any worker nodes were drained, they can be undrained again by setting <code class="highlighter-rouge">--availability active</code>.</p>

<h2 id="upgrade-ucp">Upgrade UCP</h2>

<p>Once you’ve upgraded the Docker Engine - Enterprise running on all the nodes,
<a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/ucp/admin/install/upgrade.md">upgrade UCP</a>.</p>

<h2 id="upgrade-dtr">Upgrade DTR</h2>

<p>After you upgrade Docker Engine - Enterprise and UCP, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/dtr/admin/upgrade.md">upgrade DTR</a>.</p>

<p>After the DTR upgrade is finished, the Docker Enterprise upgrade is complete.</p>

<h2 id="where-to-go-next">Where to go next</h2>

<ul>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/ee/backup/">Backup Docker EE</a></li>
</ul>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=enterprise">enterprise</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=upgrade">upgrade</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/ee/upgrade/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "ee/upgrade.md",
										"title": "Upgrade Docker Enterprise",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/ee/upgrade.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/ee/upgrade.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [ee/upgrade.md](https://matsuand.github.io/docs.docker.jp.onthefly/ee/upgrade/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#cluster-upgrade-best-practices" class="nomunge">Cluster upgrade best practices</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#create-a-backup" class="nomunge">Create a backup</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#check-the-compatibility-matrix" class="nomunge">Check the compatibility matrix</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#apply-firewall-rules" class="nomunge">Apply firewall rules</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#ip-address-consumption-in-1809" class="nomunge">IP address consumption in 18.09+</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#upgrade-docker-engine---enterprise" class="nomunge">Upgrade Docker Engine - Enterprise</a>
    <ul>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#determine-if-the-network-is-in-danger-of-exhaustion" class="nomunge">Determine if the network is in danger of exhaustion</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#manager-upgrades-when-moving-to-docker-engine---enterprise-1809-and-later" class="nomunge">Manager upgrades when moving to Docker Engine - Enterprise 18.09 and later</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#drain-the-node" class="nomunge">Drain the node</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#perform-the-upgrade" class="nomunge">Perform the upgrade</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#post-upgrade-steps-for-docker-engine---enterprise" class="nomunge">Post-Upgrade steps for Docker Engine - Enterprise</a></li>
    </ul>
  </li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#upgrade-ucp" class="nomunge">Upgrade UCP</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#upgrade-dtr" class="nomunge">Upgrade DTR</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/upgrade.md#where-to-go-next" class="nomunge">Where to go next</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/ee/upgrade/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
