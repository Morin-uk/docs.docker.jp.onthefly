<!-- Page generated 2020-04-29 18:02:58 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <style type="text/css">
        @charset "UTF-8";
        [ng\:cloak],
        [ng-cloak],
        [data-ng-cloak],
        [x-ng-cloak],
        .ng-cloak,
        .x-ng-cloak,
        .ng-hide:not(.ng-hide-animate) {
            display: none !important;
        }

        ng\:form {
            display: block;
        }
    </style>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- favicon -->
    <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
    <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
    <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
    <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
    <!-- metadata -->
    <meta property="og:type" content="website"/>
    <meta property="og:updated_time" itemprop="dateUpdated" content="2020-04-29T18:02:58+09:00"/>
    <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:domain" content="docs.docker.com"/>
    <meta name="twitter:site" content="@docker_docs"/>
    <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
    <meta name="twitter:title" itemprop="title name" content="Deploy a DTR cache with Kubernetes"/>
    <meta name="twitter:description" property="og:description" itemprop="description" content="This topic applies to Docker Enterprise. The Docker Enterprise platform business, including products, customers, and employees, has been acquired by Mirantis, inc., effective 13-November-2019. For more information on the acquisition..." />
    <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
    <meta name="twitter:image:alt" content="Docker ドキュメント"/>
    <meta property="article:published_time" itemprop="datePublished" content="2020-04-29T18:02:58+09:00"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="DTR, cache, kubernetes">
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
    <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
    <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

    <!-- Go get "Open Sans" font from Google -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <!-- SEO stuff -->
    <title>Deploy a DTR cache with Kubernetes | Docker ドキュメント</title>
    <meta property="og:title" content="Deploy a DTR cache with Kubernetes" />
    <meta property="og:locale" content="ja_JP" />
    <meta name="description" content="Deploy a DTR cache to allow users in remote geographical locations to pull images faster." />
    <meta property="og:description" content="Deploy a DTR cache to allow users in remote geographical locations to pull images faster." />
    <link rel="canonical" href="/docs.docker.jp.onthefly/ee/dtr/admin/configure/deploy-caches/simple-kube/" />
    <meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/ee/dtr/admin/configure/deploy-caches/simple-kube/" />
    <meta property="og:site_name" content="Docker ドキュメント" />
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Deploy a DTR cache with Kubernetes","description":"Deploy a DTR cache to allow users in remote geographical locations to pull images faster.","url":"https://docs.docker.com/ee/dtr/admin/configure/deploy-caches/simple-kube/"}</script>
    <!-- END SEO STUFF -->
    
    <script>
    // Default to assuming this is an archive and hiding some stuff
    // See js/archive.js and js/docs.js for logic relating to this
    var isArchive = true;
    var dockerVersion = 'v19.03';
    </script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        
            <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/"><img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (最新)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

        
    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                                
                            <h1>Deploy a DTR cache with Kubernetes</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    8 分
  
</span>

                            
                            
                            <blockquote>
  <!-- This text will be included on all Docker pages that document Enterprise products, features, and technologies that are transitioning to Mirantis. -->
  <p>This topic applies to Docker Enterprise.</p>

  <p>The Docker Enterprise platform business, including products, customers, and employees, has been acquired by Mirantis, inc., effective 13-November-2019. For more information on the acquisition and how it may affect you and your business, refer to the <a href="https://www.docker.com/faq-for-docker-enterprise-customers-and-partners">Docker Enterprise Customer FAQ</a>.</p>
</blockquote>

<p>This example guides you through deploying a DTR cache, assuming that you’ve got
a DTR deployment up and running. The below guide has been tested on
Universal Control Plane 3.1, however it should work on any Kubernetes Cluster
1.8 or higher.</p>

<p>The DTR cache is going to be deployed as a Kubernetes Deployment, so that
Kubernetes automatically takes care of scheduling and restarting the service if
something goes wrong.</p>

<p>We’ll manage the cache configuration using a Kubernetes Config Map, and the TLS
certificates using Kubernetes secrets. This allows you to manage the
configurations securely and independently of the node where the cache is
actually running.</p>

<h2 id="prepare-the-cache-deployment">Prepare the cache deployment</h2>

<p>At the end of this exercise you should have the following file structure on your
workstation:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── dtrcache.yaml        # Yaml file to deploy cache with a single command
├── config.yaml          # The cache configuration file
└── certs
    ├── cache.cert.pem   # The cache public key certificate, including any intermediaries
    ├── cache.key.pem    # The cache private key
    └── dtr.cert.pem     # DTR CA certificate
</code></pre></div></div>

<h3 id="create-the-dtr-cache-certificates">Create the DTR Cache certificates</h3>

<p>The DTR cache will be deployed with a TLS endpoint. For this you will need to
generate a TLS ceritificate and key from a certificate authority. The way you
expose the DTR Cache will change the SANs required for
this certificate.</p>

<p>For example:</p>

<ul>
  <li>If you are deploying the DTR Cache with an
<a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress Object</a>
you will need to use an external DTR cache address which resolves to your
ingress controller as part of your certificate.</li>
  <li>If you are exposing the DTR cache through a Kubernetes
<a href="https://kubernetes.io/docs/concepts/services-networking/#loadbalancer">Cloud Provider</a>
then you will need the external Loadbalancer address as part of your
certificate.</li>
  <li>If you are exposing the DTR Cache through a
<a href="https://kubernetes.io/docs/concepts/services-networking/#nodeport">Node Port</a>
 or a Host Port you will need to use a node’s FQDN as a SAN in your
 certificate.</li>
</ul>

<p>On your workstation, create a directory called <code class="highlighter-rouge">certs</code>. Within it place the
newly created certificate <code class="highlighter-rouge">cache.cert.pem</code> and key <code class="highlighter-rouge">cache.key.pem</code> for your DTR
cache. Also place the certificate authority (including any intermedite
certificate authorities) of the certificate from your DTR deployment. This could
be sourced from the main DTR deployment using curl.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl -s https://&lt;dtr-fqdn&gt;/ca -o certs/dtr.cert.pem`.
</code></pre></div></div>

<h3 id="create-the-dtr-config">Create the DTR Config</h3>

<p>The DTR Cache will take its configuration from a file mounted into the container.
Below is an example configuration file for the DTR Cache. This yaml should be
customised for your environment with the relevant external dtr cache, worker
node or external loadbalancer FQDN.</p>

<p>With this configuration, the cache fetches image layers from DTR and keeps a
local copy for 24 hours. After that, if a user requests that image layer, the
cache will fetch it again from DTR.</p>

<p>The cache, by default, is configured to store image data inside its container.
Therefore if something goes wrong with the cache service, and Kubernetes deploys
a new pod, cached data is not persisted. Data will not be lost as it is still
stored in the primary DTR. You can
<a href="/registry/configuration/#storage">customize the storage parameters</a>,
if you want the cached images to be backended by persistent storage.</p>

<blockquote>
  <p><strong>Note</strong>: Kubernetes Peristent Volumes or Persistent Volume Claims would have to be
used to provide persistent backend storage capabilities for the cache.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &gt; config.yaml &lt;&lt;EOF
version: 0.1
log:
  level: info
storage:
  delete:
    enabled: true
  filesystem:
    rootdirectory: /var/lib/registry
http:
  addr: 0.0.0.0:443
  secret: generate-random-secret
  host: https://&lt;external-fqdn-dtrcache&gt; # Could be DTR Cache / Loadbalancer / Worker Node external FQDN
  tls:
    certificate: /certs/cache.cert.pem
    key: /certs/cache.key.pem
middleware:
  registry:
      - name: downstream
        options:
          blobttl: 24h
          upstreams:
            - https://&lt;dtr-url&gt; # URL of the Main DTR Deployment
          cas:
            - /certs/dtr.cert.pem
EOF
</code></pre></div></div>

<p>See <a href="/registry/configuration/#list-of-configuration-options">Configuration Options</a> for a full list of registry configuration options.</p>

<h3 id="define-kubernetes-resources">Define Kubernetes Resources</h3>

<p>The Kubernetes Manifest file to deploy the DTR Cache is independent of how you
choose to expose the DTR cache within your environment. The below example has
been tested to work on Universal Control Plane 3.1, however it should work on
any Kubernetes Cluster 1.8 or higher.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &gt; dtrcache.yaml &lt;&lt;EOF
apiVersion: apps/v1beta2
kind: Deployment
metadata:
  name: dtr-cache
  namespace: dtr
spec:
  replicas: 1
  selector:
    matchLabels:
      app: dtr-cache
  template:
    metadata:
      labels:
        app: dtr-cache
      annotations:
       seccomp.security.alpha.kubernetes.io/pod: docker/default
    spec:
      containers:
        - name: dtr-cache
          image: docker/dtr-content-cache:2.7.6
          command: ["bin/sh"]
          args:
            - start.sh
            - /config/config.yaml
          ports:
          - name: https
            containerPort: 443
          volumeMounts:
          - name: dtr-certs
            readOnly: true
            mountPath: /certs/
          - name: dtr-cache-config
            readOnly: true
            mountPath: /config
      volumes:
      - name: dtr-certs
        secret:
          secretName: dtr-certs
      - name: dtr-cache-config
        configMap:
          defaultMode: 0666
          name: dtr-cache-config
EOF
</code></pre></div></div>

<h2 id="create-kubernetes-resources">Create Kubernetes Resources</h2>

<p>At this point you should have a file structure on your workstation which looks
like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── dtrcache.yaml        # Yaml file to deploy cache with a single command
├── config.yaml          # The cache configuration file
└── certs
    ├── cache.cert.pem   # The cache public key certificate
    ├── cache.key.pem    # The cache private key
    └── dtr.cert.pem     # DTR CA certificate
</code></pre></div></div>

<p>You will also need the <code class="highlighter-rouge">kubectl</code> command line tool configured to talk to your
Kubernetes cluster, either through a Kubernetes Config file or a <a href="/ee/ucp/user-access/kubectl/">Universal
Control Plane client bundle</a>.</p>

<p>First we will create a Kubernetes namespace to logically separate all of our
DTR cache components.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ kubectl create namespace dtr
</code></pre></div></div>

<p>Create the Kubernetes Secrets, containing the DTR cache TLS certificates, and a
Kubernetes ConfigMap containing the DTR cache configuration file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ kubectl -n dtr create secret generic dtr-certs \
    --from-file=certs/dtr.cert.pem \
    --from-file=certs/cache.cert.pem \
    --from-file=certs/cache.key.pem

$ kubectl -n dtr create configmap dtr-cache-config \
    --from-file=config.yaml
</code></pre></div></div>

<p>Finally create the Kubernetes Deployment.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ kubectl create -f dtrcache.yaml
</code></pre></div></div>

<p>You can check if the deployment has been successful by checking the running pods
in your cluster: <code class="highlighter-rouge">kubectl -n dtr get pods </code></p>

<p>If you need to troubleshoot your deployment, you can use
<code class="highlighter-rouge">kubectl -n dtr describe pods &lt;pods&gt;</code> and / or <code class="highlighter-rouge">kubectl -n dtr logs &lt;pods&gt;</code>.</p>

<h3 id="exposing-the-dtr-cache">Exposing the DTR Cache</h3>

<p>For external access to the DTR cache we need to expose the Cache Pods to the
outside world. In Kubernetes there are multiple ways for you to expose a service,
dependent on your infrastructure and your environment. For more information,
see <a href="https://kubernetes.io/docs/concepts/services-networking/#publishing-services-service-types">Publishing services - service types
</a> on the Kubernetes docs.
It is important though that you are consistent in exposing the cache through the
same interface you created a certificate for <a href="#create-the-dtr-cache-certificates">previously</a>.
Otherwise the TLS certificate may not be valid through this alternative
interface.</p>

<blockquote>
  <h4 id="dtr-cache-exposure">DTR Cache Exposure</h4>

  <p>You only need to expose your DTR cache through <strong><em>one</em></strong> external interface.</p>
</blockquote>

<h4 id="nodeport">NodePort</h4>

<p>The first example exposes the DTR cache through <strong>NodePort</strong>. In this example you would
have added a worker node’s FQDN to the TLS Certificate in <a href="#create-the-dtr-cache-certificates">step 1</a>.
Here you will be accessing the DTR cache through an exposed port on a worker
node’s FQDN.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &gt; dtrcacheservice.yaml &lt;&lt;EOF
apiVersion: v1
kind: Service
metadata:
  name: dtr-cache
  namespace: dtr
spec:
  type: NodePort
  ports:
  - name: https
    port: 443
    targetPort: 443
    protocol: TCP
  selector:
    app: dtr-cache
EOF

kubectl create -f dtrcacheservice.yaml
</code></pre></div></div>

<p>To find out which port the DTR cache has been exposed on, you will need to run:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ kubectl -n dtr get services
</code></pre></div></div>

<p>You can test that your DTR cache is externally reachable by using <code class="highlighter-rouge">curl</code> to hit
the API endpoint, using both a worker node’s external address, and the <strong>NodePort</strong>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X GET https://&lt;workernodefqdn&gt;:&lt;nodeport&gt;/v2/_catalog
{"repositories":[]}
</code></pre></div></div>

<h4 id="ingress-controller">Ingress Controller</h4>

<p>This second example will expose the DTR cache through an <strong>ingress</strong> object. In
this example you will need to create a DNS rule in your environment that will
resolve a DTR cache external FQDN address to the address of your ingress
controller. You should have also specified the same DTR cache external FQDN
address within the DTR cache certificate in <a href="#create-the-dtr-cache-certificates">step 1</a>.</p>

<blockquote>
  <p>Note an ingress controller is a prerequisite for this example. If you have not
deployed an ingress controller on your cluster, see <a href="/ee/ucp/kubernetes/layer-7-routing">Layer 7 Routing for UCP</a>. This
ingress controller will also need to support SSL passthrough.</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat &gt; dtrcacheservice.yaml &lt;&lt;EOF
kind: Service
apiVersion: v1
metadata:
  name: dtr-cache
  namespace: dtr
spec:
  selector:
    app: dtr-cache
  ports:
  - protocol: TCP
    port: 443
    targetPort: 443
---
apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: dtr-cache
  namespace: dtr
  annotations:
    nginx.ingress.kubernetes.io/ssl-passthrough: "true"
    nginx.ingress.kubernetes.io/secure-backends: "true"
spec:
  tls:
  - hosts:
    - &lt;external-dtr-cache-fqdn&gt; # Replace this value with your external DTR Cache address
  rules:
  - host: &lt;external-dtr-cache-fqdn&gt; # Replace this value with your external DTR Cache address
    http:
      paths:
      - backend:
          serviceName: dtr-cache
          servicePort: 443
EOF

kubectl create -f dtrcacheservice.yaml
</code></pre></div></div>

<p>You can test that your DTR cache is externally reachable by using curl to hit
the API endpoint. The address should be the one you have defined above in the
serivce definition file.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X GET https://external-dtr-cache-fqdn/v2/_catalog
{"repositories":[]}
</code></pre></div></div>

<h2 id="next-steps">Next Steps</h2>

<p><a href="simple#register-the-cache-with-dtr">Integrate your cache into DTR and configure users</a></p>

                            <!-- tags -->
                            
                                <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=DTR">DTR</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=cache">cache</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=kubernetes">kubernetes</a></span>
                                
                            
                            <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "ee/dtr/admin/configure/deploy-caches/simple-kube.md",
                                        "title": "Deploy a DTR cache with Kubernetes",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/master/ee/dtr/admin/configure/deploy-caches/simple-kube.md"
                                    };
                                    (function(d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                        <div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li style="visibility: hidden"><a href="https://github.com/docker/docker.github.io/edit/master/ee/dtr/admin/configure/deploy-caches/simple-kube.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/docker/docker.github.io/issues/new?body=File: [ee/dtr/admin/configure/deploy-caches/simple-kube.md](https://docs.docker.com/ee/dtr/admin/configure/deploy-caches/simple-kube/)"
                                                            class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                   
                                <div id="side-toc-title">本ページ内:</div>
                                    
<ul id="my_toc" class="inline_toc">
  <li><a href="#prepare-the-cache-deployment" class="nomunge">Prepare the cache deployment</a>
    <ul>
      <li><a href="#create-the-dtr-cache-certificates" class="nomunge">Create the DTR Cache certificates</a></li>
      <li><a href="#create-the-dtr-config" class="nomunge">Create the DTR Config</a></li>
      <li><a href="#define-kubernetes-resources" class="nomunge">Define Kubernetes Resources</a></li>
    </ul>
  </li>
  <li><a href="#create-kubernetes-resources" class="nomunge">Create Kubernetes Resources</a>
    <ul>
      <li><a href="#exposing-the-dtr-cache" class="nomunge">Exposing the DTR Cache</a></li>
    </ul>
  </li>
  <li><a href="#next-steps" class="nomunge">Next Steps</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
    <script>
    // Default to assuming this is an archive and hiding some stuff
    // See js/archive.js and js/docs.js for logic relating to this
    var isArchive = true;
    var dockerVersion = 'v19.03';
    // In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
    var jekyllEnv = 'development';
    // If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
    if (jekyllEnv === 'development') {
        jekyllEnv = '';
    }
    var pageURL = jekyllEnv + '/ee/dtr/admin/configure/deploy-caches/simple-kube/';
    </script>
    <script src="/docs.docker.jp.onthefly/js/archive.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script>
    jQuery(document).ready(function(){hookupTOCEvents();});
    </script>
</body>
</html>
