<!-- Page generated 2020-05-17 15:36:56 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
      @charset "UTF-8";
      [ng\:cloak],
      [ng-cloak],
      [data-ng-cloak],
      [x-ng-cloak],
      .ng-cloak,
      .x-ng-cloak,
      .ng-hide:not(.ng-hide-animate) {
          display: none !important;
      }

      ng\:form {
          display: block;
      }
  </style>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
  <!-- End Google Tag Manager -->
  
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-05-17T15:36:56+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:title" itemprop="title name" content="Deploy application infrastructure"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="In this step, you create several Docker hosts to run your application stack on. Before you continue, make sure you have taken the time to learn the application architecture. About..." />
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker Documentation"/>
  <meta property="article:published_time" itemprop="datePublished" content="2020-05-17T15:36:56+09:00"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="docker, swarm, scale, voting, application, certificates">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
  <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

  <!-- Go get "Open Sans" font from Google -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <!-- SEO stuff -->
  <title>Deploy application infrastructure | Docker Documentation</title>
  <meta property="og:title" content="Deploy application infrastructure" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="description" content="Try Swarm at scale" />
  <meta property="og:description" content="Try Swarm at scale" />
  <link rel="canonical" href="/swarm/swarm_at_scale/deploy-infra/" />
  <meta property="og:url" content="https://docs.docker.com/swarm/swarm_at_scale/deploy-infra/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Deploy application infrastructure","description":"Try Swarm at scale","url":"https://docs.docker.com/swarm/swarm_at_scale/deploy-infra/"}</script>
  <!-- END SEO STUFF -->
  <meta name="robots" content="noindex" />
  <script>
  // Default to assuming this is an archive and hiding some stuff
  // See js/archive.js and js/docs.js for logic relating to this
  var isArchive = true;
  var dockerVersion = 'v19.03';
  </script>
</head>


    <body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/"><img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (最新)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>Deploy application infrastructure</h1> 
                            <blockquote><p><strong>この文書は古いスタンドアロン版の Swarm に関するものです。</strong> ここではスタンドアロン版 Docker Swarm について説明しています。Docker 1.12 およびそれ以降においては、Docker Engine に対して<a href="/engine/swarm/">スウォームモード</a>が組み入れられました。たいていのユーザーは、統合されたスウォームモードを利用してください。これに関して読み進めるべきドキュメントは、<a href="/engine/swarm/swarm-tutorial/">スウォームモードをはじめよう</a>、<a href="/engine/swarm/#swarm-mode-cli-commands">スウォームモード CLI コマンド</a>、<a href="/get-started/">Docker ウォークスルー</a> です。スタンドアロン版の Docker Swarm は Docker Engine API や CLI コマンドには統合されていません。</p>
</blockquote>
                            
                            <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    13 分
  
</span>

                            
                            
                            <p>In this step, you create several Docker hosts to run your application stack on.
Before you continue, make sure you have taken the time to
<a href="/docs.docker.jp.onthefly/swarm/swarm_at_scale/about/">learn the application architecture</a>.</p>

<h2 id="about-these-instructions">About these instructions</h2>

<p>This example assumes you are running on a Mac or Windows system and enabling
Docker Engine <code class="highlighter-rouge">docker</code> commands by provisioning local VirtualBox virtual
machines using Docker Machine. For this evaluation installation, you need 6 (six)
VirtualBox VMs.</p>

<p>While this example uses Docker Machine, this is only one example of an
infrastructure you can use. You can create the environment design on whatever
infrastructure you wish. For example, you could place the application on another
public cloud platform such as Azure or DigitalOcean, on premises in your data
center, or even in a test environment on your laptop.</p>

<p>Finally, these instructions use some common <code class="highlighter-rouge">bash</code> command substitution techniques to
resolve some values, for example:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env keystore<span class="k">)</span>
</code></pre></div></div>

<p>In a Windows environment, these substitution fail. If you are running in
Windows, replace the substitution <code class="highlighter-rouge">$(docker-machine env keystore)</code> with the
actual value.</p>

<h2 id="task-1-create-the-keystore-server">Task 1. Create the keystore server</h2>

<p>To enable a Docker container network and Swarm discovery, you must
deploy (or supply) a key-value store. As a discovery backend, the key-value store
maintains an up-to-date list of cluster members and shares that list with the
Swarm manager. The Swarm manager uses this list to assign tasks to the nodes.</p>

<p>An overlay network requires a key-value store. The key-value store holds
information about the network state which includes discovery, networks,
endpoints, IP addresses, and more.</p>

<p><a href="/docs.docker.jp.onthefly/swarm/discovery/">Several different backends are supported</a>. This example uses <a href="https://www.consul.io/" target="blank">Consul</a> container.</p>

<ol>
  <li>
    <p>Create a “machine” named <code class="highlighter-rouge">keystore</code>.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=consul"</span>  keystore
</code></pre></div>    </div>

    <p>You can set options for the Engine daemon with the <code class="highlighter-rouge">--engine-opt</code> flag. In
this command, you use it to label this Engine instance.</p>
  </li>
  <li>
    <p>Set your local shell to the <code class="highlighter-rouge">keystore</code> Docker host.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env keystore<span class="k">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Run <a href="https://hub.docker.com/r/progrium/consul/" target="_blank" class="_">the consul container</a>.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">--restart</span><span class="o">=</span>unless-stopped <span class="nt">-d</span> <span class="nt">-p</span> 8500:8500 <span class="nt">-h</span> consul progrium/consul <span class="nt">-server</span> <span class="nt">-bootstrap</span>
</code></pre></div>    </div>

    <p>The <code class="highlighter-rouge">-p</code> flag publishes port 8500 on the container which is where the Consul
server listens. The server also has several other ports exposed which you can
see by running <code class="highlighter-rouge">docker ps</code>.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker ps
CONTAINER ID        IMAGE               ...       PORTS                                                                            NAMES
372ffcbc96ed        progrium/consul     ...       53/tcp, 53/udp, 8300-8302/tcp, 8400/tcp, 8301-8302/udp, 0.0.0.0:8500-&gt;8500/tcp   dreamy_ptolemy
</code></pre></div>    </div>
  </li>
  <li>
    <p>Use a <code class="highlighter-rouge">curl</code> command to test the server by listing the nodes.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="k">$(</span>docker-machine ip keystore<span class="k">)</span>:8500/v1/catalog/nodes
<span class="o">[{</span><span class="s2">"Node"</span>:<span class="s2">"consul"</span>,<span class="s2">"Address"</span>:<span class="s2">"172.17.0.2"</span><span class="o">}]</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="task-2-create-the-swarm-manager">Task 2. Create the Swarm manager</h2>

<p>In this step, you create the Swarm manager and connect it to the <code class="highlighter-rouge">keystore</code>
instance. The Swarm manager container is the heart of your Swarm cluster.
It is responsible for receiving all Docker commands sent to the cluster, and for
scheduling resources against the cluster. In a real-world production deployment,
you should configure additional replica Swarm managers as secondaries for high
availability (HA).</p>

<p>Use the <code class="highlighter-rouge">--eng-opt</code> flag to set the <code class="highlighter-rouge">cluster-store</code> and
<code class="highlighter-rouge">cluster-advertise</code> options to refer to the <code class="highlighter-rouge">keystore</code> server. These options
support the container network you create later.</p>

<ol>
  <li>
    <p>Create the <code class="highlighter-rouge">manager</code> host.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=manager"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-store=consul://</span><span class="k">$(</span>docker-machine ip keystore<span class="k">)</span><span class="s2">:8500"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-advertise=eth1:2376"</span> manager
</code></pre></div>    </div>

    <p>You also give the daemon a <code class="highlighter-rouge">manager</code> label.</p>
  </li>
  <li>
    <p>Set your local shell to the <code class="highlighter-rouge">manager</code> Docker host.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env manager<span class="k">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start the Swarm manager process.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">--restart</span><span class="o">=</span>unless-stopped <span class="nt">-d</span> <span class="nt">-p</span> 3376:2375 <span class="se">\</span>
<span class="nt">-v</span> /var/lib/boot2docker:/certs:ro <span class="se">\</span>
swarm manage <span class="nt">--tlsverify</span> <span class="se">\</span>
<span class="nt">--tlscacert</span><span class="o">=</span>/certs/ca.pem <span class="se">\</span>
<span class="nt">--tlscert</span><span class="o">=</span>/certs/server.pem <span class="se">\</span>
<span class="nt">--tlskey</span><span class="o">=</span>/certs/server-key.pem <span class="se">\</span>
consul://<span class="k">$(</span>docker-machine ip keystore<span class="k">)</span>:8500
</code></pre></div>    </div>

    <p>This command uses the TLS certificates created for the <code class="highlighter-rouge">boot2docker.iso</code> or
the manager. This is key for the manager when it connects to other machines
in the cluster.</p>
  </li>
  <li>
    <p>Test your work by displaying the Docker daemon logs from the host.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine ssh manager
&lt;<span class="nt">--</span> output snipped <span class="nt">--</span><span class="o">&gt;</span>
docker@manager:~<span class="nv">$ </span>tail /var/lib/boot2docker/docker.log
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:11:56.481947896Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Calling GET /v1.15/version"</span>
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:11:56.481984742Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"GET /v1.15/version"</span>
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:12:13.070231761Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:12:33.069387215Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:12:53.069471308Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:13:13.069512320Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:13:33.070021418Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:13:53.069395005Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:14:13.071417551Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
<span class="nb">time</span><span class="o">=</span><span class="s2">"2016-04-06T23:14:33.069843647Z"</span> <span class="nv">level</span><span class="o">=</span>debug <span class="nv">msg</span><span class="o">=</span><span class="s2">"Watch triggered with 1 nodes"</span> <span class="nv">discovery</span><span class="o">=</span>consul
</code></pre></div>    </div>

    <p>The output indicates that the <code class="highlighter-rouge">consul</code> and the <code class="highlighter-rouge">manager</code> are communicating correctly.</p>
  </li>
  <li>
    <p>Exit the Docker host.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker@manager:~<span class="nv">$ </span><span class="nb">exit</span>
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="task-3-add-the-load-balancer">Task 3. Add the load balancer</h2>

<p>The application uses <a href="https://github.com/ehazlett/interlock">Interlock</a> and Nginx as a
loadbalancer. Before you build the load balancer host, create the
configuration for Nginx.</p>

<ol>
  <li>
    <p>On your local host, create a <code class="highlighter-rouge">config</code> directory.</p>
  </li>
  <li>
    <p>Change directories to the <code class="highlighter-rouge">config</code> directory.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd </span>config
</code></pre></div>    </div>
  </li>
  <li>
    <p>Get the IP address of the Swarm manager host.</p>

    <p>For example:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine ip manager
192.168.99.101
</code></pre></div>    </div>
  </li>
  <li>
    <p>Use your favorite editor to create a <code class="highlighter-rouge">config.toml</code> file and add this content
to the file:</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">ListenAddr</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">":8080"</span><span class="w">
</span><span class="err">DockerURL</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"tcp://SWARM_MANAGER_IP:3376"</span><span class="w">
</span><span class="err">TLSCACert</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"/var/lib/boot2docker/ca.pem"</span><span class="w">
</span><span class="err">TLSCert</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"/var/lib/boot2docker/server.pem"</span><span class="w">
</span><span class="err">TLSKey</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"/var/lib/boot2docker/server-key.pem"</span><span class="w">

</span><span class="p">[[</span><span class="err">Extensions</span><span class="p">]]</span><span class="w">
</span><span class="err">Name</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"nginx"</span><span class="w">
</span><span class="err">ConfigPath</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"/etc/nginx/nginx.conf"</span><span class="w">
</span><span class="err">PidPath</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="s2">"/var/run/nginx.pid"</span><span class="w">
</span><span class="err">MaxConn</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1024</span><span class="w">
</span><span class="err">Port</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">80</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>
    <p>In the configuration, replace the <code class="highlighter-rouge">SWARM_MANAGER_IP</code> with the <code class="highlighter-rouge">manager</code> IP you got
in Step 4.</p>

    <p>You use this value because the load balancer listens on the manager’s event
stream.</p>
  </li>
  <li>
    <p>Save and close the <code class="highlighter-rouge">config.toml</code> file.</p>
  </li>
  <li>
    <p>Create a machine for the load balancer.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=interlock"</span> loadbalancer
</code></pre></div>    </div>
  </li>
  <li>
    <p>Switch the environment to the <code class="highlighter-rouge">loadbalancer</code>.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env loadbalancer<span class="k">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>Start an <code class="highlighter-rouge">interlock</code> container running.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="se">\</span>
    <span class="nt">-P</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="se">\</span>
    <span class="nt">-ti</span> <span class="se">\</span>
    <span class="nt">-v</span> nginx:/etc/conf <span class="se">\</span>
    <span class="nt">-v</span> /var/lib/boot2docker:/var/lib/boot2docker:ro <span class="se">\</span>
    <span class="nt">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="se">\</span>
    <span class="nt">-v</span> <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/config.toml:/etc/config.toml <span class="se">\</span>
    <span class="nt">--name</span> interlock <span class="se">\</span>
    ehazlett/interlock:1.0.1 <span class="se">\</span>
    <span class="nt">-D</span> run <span class="nt">-c</span> /etc/config.toml
</code></pre></div>    </div>

    <p>This command relies on the <code class="highlighter-rouge">config.toml</code> file being in the current directory.  After running the command, confirm the image is running:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker ps
CONTAINER ID        IMAGE                      COMMAND                  CREATED             STATUS              PORTS                     NAMES
d846b801a978        ehazlett/interlock:1.0.1   <span class="s2">"/bin/interlock -D ru"</span>   2 minutes ago       Up 2 minutes        0.0.0.0:32770-&gt;8080/tcp   interlock
</code></pre></div>    </div>

    <p>If you don’t see the image running, use <code class="highlighter-rouge">docker ps -a</code> to list all images to make sure the system attempted to start the image. Then, get the logs to see why the container failed to start.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker logs interlock
INFO[0000] interlock 1.0.1 <span class="o">(</span>000291d<span class="o">)</span>
DEBU[0000] loading config from: /etc/config.toml
FATA[0000] <span class="nb">read</span> /etc/config.toml: is a directory
</code></pre></div>    </div>

    <p>This error usually means you weren’t starting the <code class="highlighter-rouge">docker run</code> from the same
<code class="highlighter-rouge">config</code> directory where the <code class="highlighter-rouge">config.toml</code> file is. If you run the command
and get a Conflict error such as:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker: Error response from daemon: Conflict. The name <span class="s2">"/interlock"</span> is already <span class="k">in </span>use by container d846b801a978c76979d46a839bb05c26d2ab949ff9f4f740b06b5e2564bae958. You have to remove <span class="o">(</span>or rename<span class="o">)</span> that container to reuse that name.
</code></pre></div>    </div>

    <p>Remove the interlock container with the <code class="highlighter-rouge">docker container rm interlock</code> and try again.</p>
  </li>
  <li>
    <p>Start an <code class="highlighter-rouge">nginx</code> container on the load balancer.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker run <span class="nt">-ti</span> <span class="nt">-d</span> <span class="se">\</span>
  <span class="nt">-p</span> 80:80 <span class="se">\</span>
  <span class="nt">--label</span> interlock.ext.name<span class="o">=</span>nginx <span class="se">\</span>
  <span class="nt">--link</span><span class="o">=</span>interlock:interlock <span class="se">\</span>
  <span class="nt">-v</span> nginx:/etc/conf <span class="se">\</span>
  <span class="nt">--name</span> nginx <span class="se">\</span>
  nginx nginx <span class="nt">-g</span> <span class="s2">"daemon off;"</span> <span class="nt">-c</span> /etc/conf/nginx.conf
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="task-4-create-the-other-swarm-nodes">Task 4. Create the other Swarm nodes</h2>

<p>A host in a Swarm cluster is called a <em>node</em>. You’ve already created the manager
node. Here, the task is to create each virtual host for each node. There are
three commands required:</p>

<ul>
  <li>create the host with Docker Machine</li>
  <li>point the local environment to the new host</li>
  <li>join the host to the Swarm cluster</li>
</ul>

<p>If you were building this in a non-Mac/Windows environment, you’d only need to
run the <code class="highlighter-rouge">join</code> command to add a node to the Swarm cluster and register it with
the Consul discovery service. When you create a node, you also give it a label,
for example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--engine-opt="label=com.function=frontend01"
</code></pre></div></div>

<p>These labels are used later when starting application containers. In the
commands below, notice the label you are applying to each node.</p>

<ol>
  <li>
    <p>Create the <code class="highlighter-rouge">frontend01</code> host and add it to the Swarm cluster.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=frontend01"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-store=consul://</span><span class="k">$(</span>docker-machine ip keystore<span class="k">)</span><span class="s2">:8500"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-advertise=eth1:2376"</span> frontend01
<span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env frontend01<span class="k">)</span>
<span class="nv">$ </span>docker run <span class="nt">-d</span> swarm join <span class="nt">--addr</span><span class="o">=</span><span class="k">$(</span>docker-machine ip frontend01<span class="k">)</span>:2376 consul://<span class="k">$(</span>docker-machine ip keystore<span class="k">)</span>:8500
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create the <code class="highlighter-rouge">frontend02</code> VM.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=frontend02"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-store=consul://</span><span class="k">$(</span>docker-machine ip keystore<span class="k">)</span><span class="s2">:8500"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-advertise=eth1:2376"</span> frontend02
<span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env frontend02<span class="k">)</span>
<span class="nv">$ </span>docker run <span class="nt">-d</span> swarm join <span class="nt">--addr</span><span class="o">=</span><span class="k">$(</span>docker-machine ip frontend02<span class="k">)</span>:2376 consul://<span class="k">$(</span>docker-machine ip keystore<span class="k">)</span>:8500
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create the <code class="highlighter-rouge">worker01</code> VM.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=worker01"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-store=consul://</span><span class="k">$(</span>docker-machine ip keystore<span class="k">)</span><span class="s2">:8500"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-advertise=eth1:2376"</span> worker01
<span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env worker01<span class="k">)</span>
<span class="nv">$ </span>docker run <span class="nt">-d</span> swarm join <span class="nt">--addr</span><span class="o">=</span><span class="k">$(</span>docker-machine ip worker01<span class="k">)</span>:2376 consul://<span class="k">$(</span>docker-machine ip keystore<span class="k">)</span>:8500
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create the <code class="highlighter-rouge">dbstore</code> VM.</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine create <span class="nt">-d</span> virtualbox <span class="nt">--virtualbox-memory</span> <span class="s2">"2000"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"label=com.function=dbstore"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-store=consul://</span><span class="k">$(</span>docker-machine ip keystore<span class="k">)</span><span class="s2">:8500"</span> <span class="se">\</span>
<span class="nt">--engine-opt</span><span class="o">=</span><span class="s2">"cluster-advertise=eth1:2376"</span> dbstore
<span class="nv">$ </span><span class="nb">eval</span> <span class="k">$(</span>docker-machine env dbstore<span class="k">)</span>
<span class="nv">$ </span>docker run <span class="nt">-d</span> swarm join <span class="nt">--addr</span><span class="o">=</span><span class="k">$(</span>docker-machine ip dbstore<span class="k">)</span>:2376 consul://<span class="k">$(</span>docker-machine ip keystore<span class="k">)</span>:8500
</code></pre></div>    </div>
  </li>
  <li>
    <p>Check your work.</p>

    <p>At this point, you have deployed on the infrastructure you need to run the
application. Test this now by listing the running machines:</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker-machine <span class="nb">ls
</span>NAME           ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER    ERRORS
dbstore        -        virtualbox   Running   tcp://192.168.99.111:2376           v1.10.3
frontend01     -        virtualbox   Running   tcp://192.168.99.108:2376           v1.10.3
frontend02     -        virtualbox   Running   tcp://192.168.99.109:2376           v1.10.3
keystore       -        virtualbox   Running   tcp://192.168.99.100:2376           v1.10.3
loadbalancer   -        virtualbox   Running   tcp://192.168.99.107:2376           v1.10.3
manager        -        virtualbox   Running   tcp://192.168.99.101:2376           v1.10.3
worker01       <span class="k">*</span>        virtualbox   Running   tcp://192.168.99.110:2376           v1.10.3
</code></pre></div>    </div>
  </li>
  <li>
    <p>Make sure the Swarm manager sees all your nodes.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker -H $(docker-machine ip manager):3376 info
Containers: 4
 Running: 4
 Paused: 0
 Stopped: 0
Images: 3
Server Version: swarm/1.1.3
Role: primary
Strategy: spread
Filters: health, port, dependency, affinity, constraint
Nodes: 4
 dbstore: 192.168.99.111:2376
  └ Status: Healthy
  └ Containers: 1
  └ Reserved CPUs: 0 / 1
  └ Reserved Memory: 0 B / 2.004 GiB
  └ Labels: com.function=dbstore, executiondriver=native-0.2, kernelversion=4.1.19-boot2docker, operatingsystem=Boot2Docker 1.10.3 (TCL 6.4.1); master : 625117e - Thu Mar 10 22:09:02 UTC 2016, provider=virtualbox, storagedriver=aufs
  └ Error: (none)
  └ UpdatedAt: 2016-04-07T18:25:37Z
 frontend01: 192.168.99.108:2376
  └ Status: Healthy
  └ Containers: 1
  └ Reserved CPUs: 0 / 1
  └ Reserved Memory: 0 B / 2.004 GiB
  └ Labels: com.function=frontend01, executiondriver=native-0.2, kernelversion=4.1.19-boot2docker, operatingsystem=Boot2Docker 1.10.3 (TCL 6.4.1); master : 625117e - Thu Mar 10 22:09:02 UTC 2016, provider=virtualbox, storagedriver=aufs
  └ Error: (none)
  └ UpdatedAt: 2016-04-07T18:26:10Z
 frontend02: 192.168.99.109:2376
  └ Status: Healthy
  └ Containers: 1
  └ Reserved CPUs: 0 / 1
  └ Reserved Memory: 0 B / 2.004 GiB
  └ Labels: com.function=frontend02, executiondriver=native-0.2, kernelversion=4.1.19-boot2docker, operatingsystem=Boot2Docker 1.10.3 (TCL 6.4.1); master : 625117e - Thu Mar 10 22:09:02 UTC 2016, provider=virtualbox, storagedriver=aufs
  └ Error: (none)
  └ UpdatedAt: 2016-04-07T18:25:43Z
 worker01: 192.168.99.110:2376
  └ Status: Healthy
  └ Containers: 1
  └ Reserved CPUs: 0 / 1
  └ Reserved Memory: 0 B / 2.004 GiB
  └ Labels: com.function=worker01, executiondriver=native-0.2, kernelversion=4.1.19-boot2docker, operatingsystem=Boot2Docker 1.10.3 (TCL 6.4.1); master : 625117e - Thu Mar 10 22:09:02 UTC 2016, provider=virtualbox, storagedriver=aufs
  └ Error: (none)
  └ UpdatedAt: 2016-04-07T18:25:56Z
Plugins:
 Volume:
 Network:
Kernel Version: 4.1.19-boot2docker
Operating System: linux
Architecture: amd64
CPUs: 4
Total Memory: 8.017 GiB
Name: bb13b7cf80e8
</code></pre></div>    </div>

    <p>The command is acting on the Swarm port, so it returns information about the
entire cluster. You have a manager and no nodes.</p>
  </li>
</ol>

<h2 id="next-step">Next step</h2>

<p>Your key-value store, load balancer, and Swarm cluster infrastructure are up. You are
ready to <a href="/docs.docker.jp.onthefly/swarm/swarm_at_scale/deploy-app/">build and run the voting application</a> on it.</p>

                            <!-- tags -->
                            
                            <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span
                                style="vertical-align: 2px"><a
                                    href="https://docs.docker.com/search/?q=docker">docker</a>, <a
                                    href="https://docs.docker.com/search/?q=swarm">swarm</a>, <a
                                    href="https://docs.docker.com/search/?q=scale">scale</a>, <a
                                    href="https://docs.docker.com/search/?q=voting">voting</a>, <a
                                    href="https://docs.docker.com/search/?q=application">application</a>, <a
                                    href="https://docs.docker.com/search/?q=certificates">certificates</a></span>
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "swarm/swarm_at_scale/deploy-infra.md",
                                        "title": "Deploy application infrastructure",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/master/swarm/swarm_at_scale/deploy-infra.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li style="visibility: hidden"><a href="https://github.com/docker/docker.github.io/edit/master/swarm/swarm_at_scale/deploy-infra.md"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/docker/docker.github.io/issues/new?body=File: [swarm/swarm_at_scale/deploy-infra.md](https://docs.docker.com/swarm/swarm_at_scale/deploy-infra/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#about-these-instructions" class="nomunge">About these instructions</a></li>
  <li><a href="#task-1-create-the-keystore-server" class="nomunge">Task 1. Create the keystore server</a></li>
  <li><a href="#task-2-create-the-swarm-manager" class="nomunge">Task 2. Create the Swarm manager</a></li>
  <li><a href="#task-3-add-the-load-balancer" class="nomunge">Task 3. Add the load balancer</a></li>
  <li><a href="#task-4-create-the-other-swarm-nodes" class="nomunge">Task 4. Create the other Swarm nodes</a></li>
  <li><a href="#next-step" class="nomunge">Next step</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
    <script>
        // Default to assuming this is an archive and hiding some stuff
        // See js/archive.js and js/docs.js for logic relating to this
        var isArchive = true;
        var dockerVersion = 'v19.03';
        // In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
        var jekyllEnv = 'development';
        // If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
        if (jekyllEnv === 'development') {
            jekyllEnv = '';
        }
        var pageURL = jekyllEnv + '/swarm/swarm_at_scale/deploy-infra/';
    </script>
    <script src="/docs.docker.jp.onthefly/js/archive.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script>
        jQuery(document).ready(function () { hookupTOCEvents(); });
    </script>
</body>


</html>
