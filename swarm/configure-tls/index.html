<!-- Page generated 2019-07-26 10:17:30 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-07-26T10:17:30+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="Configure Docker Swarm for TLS"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="In this procedure you create a two-node swarm cluster, a Docker Engine CLI, a swarm manager, and a Certificate Authority as shown below. All the Docker Engine hosts (client, swarm,..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker Documentation"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-07-26T10:17:30+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="docker, swarm, TLS, discovery, security, certificates">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>Configure Docker Swarm for TLS | Docker Documentation</title>
<meta property="og:title" content="Configure Docker Swarm for TLS" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Swarm and transport layer security" />
<meta property="og:description" content="Swarm and transport layer security" />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/" />
<meta property="og:site_name" content="Docker Documentation" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Configure Docker Swarm for TLS","description":"Swarm and transport layer security","url":"https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/"}</script>
	<!-- END SEO STUFF -->
	<meta name="robots" content="noindex" />
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03.1';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)         <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Configure Docker Swarm for TLS</h1> 
							<blockquote><p><strong>この文書は古いスタンドアロン版の Swarm に関するものです。</strong> ここではスタンドアロン版 Docker Swarm について説明しています。Docker 1.12 およびそれ以降においては、Docker Engine に対して<a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/swarm/">スウォームモード</a>が組み入れられました。たいていのユーザーは、統合されたスウォームモードを利用してください。これに関して読み進めるべきドキュメントは、<a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/swarm/swarm-tutorial/">スウォームモードをはじめよう</a>、<a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/swarm/index.md#swarm-mode-cli-commands">スウォームモード CLI コマンド</a>、<a href="https://matsuand.github.io/docs.docker.jp.onthefly/get-started/">Docker ウォークスルー</a> です。スタンドアロン版の Docker Swarm は Docker Engine API や CLI コマンドには統合されていません。</p>
</blockquote> <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    17 分
  
</span>

							
							
							<p>In this procedure you create a two-node swarm cluster, a Docker Engine CLI, a
swarm manager, and a Certificate Authority as shown below. All the Docker Engine
hosts (<code class="highlighter-rouge">client</code>, <code class="highlighter-rouge">swarm</code>, <code class="highlighter-rouge">node1</code>, and <code class="highlighter-rouge">node2</code>) have a copy of the
CA’s certificate as well as their own key-pair signed by the CA.</p>

<p><img src="images/tls-1.jpg" alt="Swarm cluster, Docker client, CA server, Swarm manager" /></p>

<p>This procedure includes the following steps:</p>

<ul>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-1-set-up-the-prerequisites">Step 1: Set up the prerequisites</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-2-create-a-certificate-authority-ca-server">Step 2: Create a Certificate Authority (CA) server</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-3-create-and-sign-keys">Step 3: Create and sign keys</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-4-install-the-keys">Step 4: Install the keys</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-5-configure-the-engine-daemon-for-tls">Step 5: Configure the Engine daemon for TLS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-6-create-a-swarm-cluster">Step 6: Create a swarm cluster</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-7-create-the-swarm-manager-using-tls">Step 7: Create the swarm manager using TLS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-8-test-the-swarm-manager-configuration">Step 8: Test the swarm manager configuration</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/#step-9-configure-the-engine-cli-to-use-tls">Step 9: Configure the Engine CLI to use TLS</a></li>
</ul>

<h3 id="before-you-begin">Before you begin</h3>
<p>The article includes steps to create your own CA using OpenSSL. This is similar
to operating your own internal corporate CA and PKI. However, this <code class="highlighter-rouge">must not</code>
be used as a guide to building a production-worthy internal CA and PKI. These
steps are included for demonstration purposes only - so that readers without
access to an existing CA and set of certificates can follow along and configure
Docker Swarm to use TLS.</p>

<h2 id="step-1-set-up-the-prerequisites">Step 1: Set up the prerequisites</h2>

<p>To complete this procedure you must stand up 5 (five) Linux servers. These
servers can be any mix of physical and virtual servers; they may be on premises
or in the public cloud. The following table lists each server name and its purpose.</p>

<table>
  <thead>
    <tr>
      <th>Server name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">ca</code></td>
      <td>Acts as the Certificate Authority (CA) server.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">swarm</code></td>
      <td>Acts as the swarm manager.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node1</code></td>
      <td>Acts as a swarm node.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">node2</code></td>
      <td>Acts as a swarm node.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">client</code></td>
      <td>Acts as a remote Docker Engine client.</td>
    </tr>
  </tbody>
</table>

<p>Make sure that you have SSH access to all 5 servers and that they can communicate with each other using DNS name resolution. In particular:</p>

<ul>
  <li>Open TCP port 2376 between the swarm manager and swarm nodes</li>
  <li>Open TCP port 3376 between the Docker Engine client and the swarm manager</li>
</ul>

<p>You can choose different ports if these are already in use. This example assumes
you use these ports though.</p>

<p>Each server must run an operating system compatible with Docker Engine. For
simplicity, the steps that follow assume all servers are running Ubuntu 14.04
LTS.</p>

<h2 id="step-2-create-a-certificate-authority-ca-server">Step 2: Create a Certificate Authority (CA) server</h2>

<blockquote>
  <p><strong>Note</strong>: If you already have access to a CA and certificates, and are comfortable working with them, you should skip this step and go to the next.</p>
</blockquote>

<p>In this step, you configure a Linux server as a CA. You use this CA to create
and sign keys. This step included so that readers without access to an existing
CA (external or corporate) and certificates can follow along and complete the
later steps that require installing and using certificates. It is <code class="highlighter-rouge">not</code>
intended as a model for how to deploy production-worthy CA.</p>

<ol>
  <li>
    <p>Logon to the terminal of your CA server and elevate to root.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo su
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a private key called <code class="highlighter-rouge">ca-priv-key.pem</code> for the CA:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl genrsa -out ca-priv-key.pem 2048
Generating RSA private key, 2048 bit long modulus
...........................................................+++
.....+++
e is 65537 (0x10001)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a public key called <code class="highlighter-rouge">ca.pem</code> for the CA.</p>

    <p>The public key is based on the private key created in the previous step.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl req -config /usr/lib/ssl/openssl.cnf -new -key ca-priv-key.pem -x509 -days 1825 -out ca.pem
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
&lt;output truncated&gt;
</code></pre></div>    </div>
  </li>
</ol>

<p>You have now configured a CA server with a public and private keypair. You can inspect the contents of each key. To inspect the private key:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl rsa -in ca-priv-key.pem -noout -text
</code></pre></div></div>

<p>To inspect the public key (cert):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl x509 -in ca.pem -noout -text
</code></pre></div></div>

<p>The following command shows the partial contents of the CA’s public key.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl x509 -in ca.pem -noout -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 17432010264024107661 (0xf1eaf0f9f41eca8d)
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: C=US, ST=CA, L=Sanfrancisco, O=Docker Inc
        Validity
            Not Before: Jan 16 18:28:12 2016 GMT
            Not After : Jan 13 18:28:12 2026 GMT
        Subject: C=US, ST=CA, L=San Francisco, O=Docker Inc
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:d1:fe:6e:55:d4:93:fc:c9:8a:04:07:2d:ba:f0:
                    55:97:c5:2c:f5:d7:1d:6a:9b:f0:f0:55:6c:5d:90:
&lt;output truncated&gt;
</code></pre></div></div>

<p>Later, you use this certificate to sign keys for other servers in the
infrastructure.</p>

<h2 id="step-3-create-and-sign-keys">Step 3: Create and sign keys</h2>

<p>Now that you have a working CA, you need to create key pairs for the swarm
manager, swarm nodes, and remote Docker Engine client. The commands and process
to create key pairs is identical for all servers. You create the following keys:</p>

<table>
  <thead>
    <tr>
      <th>Key</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">ca-priv-key.pem</code></td>
      <td>The CA’s private key and must be kept secure. It is used later to sign new keys for the other nodes in the environment. Together with the <code class="highlighter-rouge">ca.pem</code> file, this makes up the CA’s key pair.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">ca.pem</code></td>
      <td>The CA’s public key (also called certificate). This is installed on all nodes in the environment so that all nodes trust certificates signed by the CA. Together with the <code class="highlighter-rouge">ca-priv-key.pem</code> file, this makes up the CA’s key pair.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">NODE_NAME.csr</code></td>
      <td>A certificate signing request (CSR). A CSR is effectively an application to the CA to create a new key pair for a particular node. The CA takes the information provided in the CSR and generates the public and private key pair for that node.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">NODE_NAME-priv-key.pem</code></td>
      <td>A private key signed by the CA. The node uses this key to authenticate itself with remote Docker Engines. Together with the <code class="highlighter-rouge">NODE_NAME-cert.pem</code> file, this makes up a node’s key pair.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">NODE_NAME-cert.pem</code></td>
      <td>A certificate signed by the CA. This is not used in this example. Together with the <code class="highlighter-rouge">NODE_NAME-priv-key.pem</code> file, this makes up a node’s key pair.</td>
    </tr>
  </tbody>
</table>

<p>The commands below show how to create keys for all of your nodes. You perform this procedure in a working directory located on your CA server.</p>

<ol>
  <li>
    <p>Logon to the terminal of your CA server and elevate to root.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo su
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a private key <code class="highlighter-rouge">swarm-priv-key.pem</code> for your swarm manager</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl genrsa -out swarm-priv-key.pem 2048
Generating RSA private key, 2048 bit long modulus
............................................................+++
........+++
e is 65537 (0x10001)
</code></pre></div>    </div>
  </li>
  <li>
    <p>Generate a certificate signing request (CSR) <code class="highlighter-rouge">swarm.csr</code> using the private key you create in the previous step.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl req -subj "/CN=swarm" -new -key swarm-priv-key.pem -out swarm.csr
</code></pre></div>    </div>

    <p>Remember, this is only for demonstration purposes. The process to create a
CSR is slightly different in real-world production environments.</p>
  </li>
  <li>
    <p>Create the certificate <code class="highlighter-rouge">swarm-cert.pem</code> based on the CSR created in the previous step.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl x509 -req -days 1825 -in swarm.csr -CA ca.pem -CAkey ca-priv-key.pem -CAcreateserial -out swarm-cert.pem -extensions v3_req -extfile /usr/lib/ssl/openssl.cnf
&lt;snip&gt;
# openssl rsa -in swarm-priv-key.pem -out swarm-priv-key.pem
</code></pre></div>    </div>

    <p>You now have a keypair for the swarm manager.</p>
  </li>
  <li>
    <p>Repeat the steps above for the remaining nodes in your infrastructure (<code class="highlighter-rouge">node1</code>, <code class="highlighter-rouge">node2</code>, and <code class="highlighter-rouge">client</code>).</p>

    <p>Remember to replace the <code class="highlighter-rouge">swarm</code> specific values with the values relevant to the node you are creating the key pair for.</p>

    <table>
      <thead>
        <tr>
          <th>Server name</th>
          <th>Private key</th>
          <th>CSR</th>
          <th>Certificate</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code class="highlighter-rouge">node1</code></td>
          <td><code class="highlighter-rouge">node1-priv-key.pem</code></td>
          <td><code class="highlighter-rouge">node1.csr</code></td>
          <td><code class="highlighter-rouge">node1-cert.pem</code></td>
        </tr>
        <tr>
          <td><code class="highlighter-rouge">node2</code></td>
          <td><code class="highlighter-rouge">node2-priv-key.pem</code></td>
          <td><code class="highlighter-rouge">node2.csr</code></td>
          <td><code class="highlighter-rouge">node2-cert.pem</code></td>
        </tr>
        <tr>
          <td><code class="highlighter-rouge">client</code></td>
          <td><code class="highlighter-rouge">client-priv-key.pem</code></td>
          <td><code class="highlighter-rouge">client.csr</code></td>
          <td><code class="highlighter-rouge">client-cert.pem</code></td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>Verify that your working directory contains the following files:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ls -l
total 64
-rw-r--r-- 1 root   root   1679 Jan 16 18:27 ca-priv-key.pem
-rw-r--r-- 1 root   root   1229 Jan 16 18:28 ca.pem
-rw-r--r-- 1 root   root     17 Jan 18 09:56 ca.srl
-rw-r--r-- 1 root   root   1086 Jan 18 09:56 client-cert.pem
-rw-r--r-- 1 root   root    887 Jan 18 09:55 client.csr
-rw-r--r-- 1 root   root   1679 Jan 18 09:56 client-priv-key.pem
-rw-r--r-- 1 root   root   1082 Jan 18 09:44 node1-cert.pem
-rw-r--r-- 1 root   root    887 Jan 18 09:43 node1.csr
-rw-r--r-- 1 root   root   1675 Jan 18 09:44 node1-priv-key.pem
-rw-r--r-- 1 root   root   1082 Jan 18 09:49 node2-cert.pem
-rw-r--r-- 1 root   root    887 Jan 18 09:49 node2.csr
-rw-r--r-- 1 root   root   1675 Jan 18 09:49 node2-priv-key.pem
-rw-r--r-- 1 root   root   1082 Jan 18 09:42 swarm-cert.pem
-rw-r--r-- 1 root   root    887 Jan 18 09:41 swarm.csr
-rw-r--r-- 1 root   root   1679 Jan 18 09:42 swarm-priv-key.pem
</code></pre></div>    </div>
  </li>
</ol>

<p>You can inspect the contents of each of the keys. To inspect a private key:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl rsa -in &lt;key-name&gt; -noout -text
</code></pre></div></div>

<p>To inspect a public key (cert):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>openssl x509 -in &lt;key-name&gt; -noout -text
</code></pre></div></div>

<p>The following command shows the partial contents of the swarm manager’s public
 <code class="highlighter-rouge">swarm-cert.pem</code> key.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># openssl x509 -in ca.pem -noout -text
Certificate:
Data:
    Version: 3 (0x2)
    Serial Number: 9590646456311914051 (0x8518d2237ad49e43)
Signature Algorithm: sha256WithRSAEncryption
    Issuer: C=US, ST=CA, L=Sanfrancisco, O=Docker Inc
    Validity
        Not Before: Jan 18 09:42:16 2016 GMT
        Not After : Jan 15 09:42:16 2026 GMT
    Subject: CN=swarm

&lt;output truncated&gt;
</code></pre></div></div>

<h2 id="step-4-install-the-keys">Step 4: Install the keys</h2>

<p>In this step, you install the keys on the relevant servers in the
infrastructure. Each server needs three files:</p>

<ul>
  <li>A copy of the Certificate Authority’s public key (<code class="highlighter-rouge">ca.pem</code>)</li>
  <li>Its own private key</li>
  <li>Its own public key (cert)</li>
</ul>

<p>The procedure below shows you how to copy these files from the CA server to each
server using <code class="highlighter-rouge">scp</code>. As part of the copy procedure, rename each file as
follows on each node:</p>

<table>
  <thead>
    <tr>
      <th>Original name</th>
      <th>Copied name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">ca.pem</code></td>
      <td><code class="highlighter-rouge">ca.pem</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&lt;server&gt;-cert.pem</code></td>
      <td><code class="highlighter-rouge">cert.pem</code></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&lt;server&gt;-priv-key.pem</code></td>
      <td><code class="highlighter-rouge">key.pem</code></td>
    </tr>
  </tbody>
</table>

<ol>
  <li>
    <p>Logon to the terminal of your CA server and elevate to root.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo su
</code></pre></div>    </div>
  </li>
  <li>
    <p>Create a<code class="highlighter-rouge"> ~/.certs</code> directory on the swarm manager. Here we assume user account is ubuntu.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ssh ubuntu@swarm 'mkdir -p /home/ubuntu/.certs'
</code></pre></div>    </div>
  </li>
  <li>
    <p>Copy the keys from the CA to the swarm manager server.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ scp ./ca.pem ubuntu@swarm:/home/ubuntu/.certs/ca.pem
$ scp ./swarm-cert.pem ubuntu@swarm:/home/ubuntu/.certs/cert.pem
$ scp ./swarm-priv-key.pem ubuntu@swarm:/home/ubuntu/.certs/key.pem
</code></pre></div>    </div>

    <blockquote>
      <p><strong>Note</strong>: You may need to provide authentication for the <code class="highlighter-rouge">scp</code> commands to work. For example, AWS EC2 instances use certificate-based authentication. To copy the files to an EC2 instance associated with a public key called <code class="highlighter-rouge">nigel.pem</code>, modify the <code class="highlighter-rouge">scp</code> command as follows: <code class="highlighter-rouge">scp -i /path/to/nigel.pem ./ca.pem ubuntu@swarm:/home/ubuntu/.certs/ca.pem</code>.</p>
    </blockquote>
  </li>
  <li>
    <p>Repeat step 2 for each remaining server in the infrastructure.</p>

    <ul>
      <li><code class="highlighter-rouge">node1</code></li>
      <li><code class="highlighter-rouge">node2</code></li>
      <li><code class="highlighter-rouge">client</code></li>
    </ul>
  </li>
  <li>
    <p>Verify your work.</p>

    <p>When the copying is complete, each machine should have the following keys.</p>

    <p><img src="images/tls-2.jpeg" alt="List of keys on each machine" /></p>

    <p>Each node in your infrastructure should have the following files in the
<code class="highlighter-rouge">/home/ubuntu/.certs/</code> directory:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ls -l /home/ubuntu/.certs/
total 16
-rw-r--r-- 1 ubuntu ubuntu 1229 Jan 18 10:03 ca.pem
-rw-r--r-- 1 ubuntu ubuntu 1082 Jan 18 10:06 cert.pem
-rw-r--r-- 1 ubuntu ubuntu 1679 Jan 18 10:06 key.pem
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="step-5-configure-the-engine-daemon-for-tls">Step 5: Configure the Engine daemon for TLS</h2>

<p>In the last step, you created and installed the necessary keys on each of your
swarm nodes. In this step, you configure them to listen on the network and only
accept connections using TLS. Once you complete this step, your swarm nodes
listen on TCP port 2376, and only accept connections using TLS.</p>

<p>On <code class="highlighter-rouge">node1</code> and <code class="highlighter-rouge">node2</code> (your swarm nodes), do the following:</p>

<ol>
  <li>
    <p>Open a terminal on <code class="highlighter-rouge">node1</code> and elevate to root.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo su
</code></pre></div>    </div>
  </li>
  <li>
    <p>Add the following configuration keys to the <code class="highlighter-rouge">/etc/docker/daemon.json</code>. If the
file does not yet exist, create it.</p>

    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tcp://0.0.0.0:2376"</span><span class="p">],</span><span class="w">
  </span><span class="s2">"tlsverify"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tlscacert"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/ubuntu/.certs/ca.pem"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tlscert"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/ubuntu/.certs/cert.pem"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tlskey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/home/ubuntu/.certs/key.pem"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>

    <p>Restart Docker for the changes to take effect. If the file is not valid JSON,
Docker fails to start and emits an error.</p>
  </li>
  <li>
    <p>Repeat the procedure on <code class="highlighter-rouge">node2</code> as well.</p>
  </li>
</ol>

<h2 id="step-6-create-a-swarm-cluster">Step 6: Create a swarm cluster</h2>

<p>Next create a swarm cluster. In this procedure you create a two-node swarm
cluster using the default <em>hosted discovery</em> backend. The default hosted
discovery backend uses Docker Hub and is not recommended for production use.</p>

<ol>
  <li>
    <p>Logon to the terminal of your swarm manager node.</p>
  </li>
  <li>
    <p>Create the cluster and export it’s unique ID to the <code class="highlighter-rouge">TOKEN</code> environment variable.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo export TOKEN=$(docker run --rm swarm create)
 Unable to find image 'swarm:latest' locally
 latest: Pulling from library/swarm
 d681c900c6e3: Pulling fs layer
 &lt;snip&gt;
 986340ab62f0: Pull complete
 a9975e2cc0a3: Pull complete
 Digest: sha256:c21fd414b0488637b1f05f13a59b032a3f9da5d818d31da1a4ca98a84c0c781b
 Status: Downloaded newer image for swarm:latest
</code></pre></div>    </div>
  </li>
  <li>
    <p>Join <code class="highlighter-rouge">node1</code> to the cluster.</p>

    <p>Be sure to specify TCP port <code class="highlighter-rouge">2376</code> and not <code class="highlighter-rouge">2375</code>.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo docker run -d swarm join --addr=node1:2376 token://$TOKEN
 7bacc98536ed6b4200825ff6f4004940eb2cec891e1df71c6bbf20157c5f9761
</code></pre></div>    </div>
  </li>
  <li>
    <p>Join <code class="highlighter-rouge">node2</code> to the cluster.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo docker run -d swarm join --addr=node2:2376 token://$TOKEN
 db3f49d397bad957202e91f0679ff84f526e74d6c5bf1b6734d834f5edcbca6c
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="step-7-start-the-swarm-manager-using-tls">Step 7: Start the swarm manager using TLS</h2>

<ol>
  <li>
    <p>Launch a new container with TLS enables</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker run -d -p 3376:3376 -v /home/ubuntu/.certs:/certs:ro swarm manage --tlsverify --tlscacert=/certs/ca.pem --tlscert=/certs/cert.pem --tlskey=/certs/key.pem --host=0.0.0.0:3376 token://$TOKEN
</code></pre></div>    </div>

    <p>The command above launches a new container based on the <code class="highlighter-rouge">swarm</code> image
 and it maps port <code class="highlighter-rouge">3376</code> on the server to port <code class="highlighter-rouge">3376</code> inside the
 container. This mapping ensures that Docker Engine commands sent to the host
 on port <code class="highlighter-rouge">3376</code> are passed on to port <code class="highlighter-rouge">3376</code> inside the container. The
 container runs the swarm <code class="highlighter-rouge">manage</code> process with the <code class="highlighter-rouge">--tlsverify</code>,
 <code class="highlighter-rouge">--tlscacert</code>, <code class="highlighter-rouge">--tlscert</code> and <code class="highlighter-rouge">--tlskey</code> options specified. These options
 force TLS verification and specify the location of the swarm manager’s TLS
 keys.</p>
  </li>
  <li>
    <p>Run a <code class="highlighter-rouge">docker ps</code> command to verify that your swarm manager container is up
and running.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ docker ps
 CONTAINER ID   IMAGE               COMMAND                  CREATED          STATUS          PORTS                              NAMES
 035dbf57b26e   swarm               "/swarm manage --tlsv"   7 seconds ago    Up 7 seconds    2375/tcp, 0.0.0.0:3376-&gt;3376/tcp   compassionate_lovelace
</code></pre></div>    </div>
  </li>
</ol>

<p>Your swarm cluster is now configured to use TLS.</p>

<h2 id="step-8-test-the-swarm-manager-configuration">Step 8: Test the swarm manager configuration</h2>

<p>Now that you have a swarm cluster built and configured to use TLS, test that it works with a Docker Engine CLI.</p>

<ol>
  <li>
    <p>Open a terminal onto your <code class="highlighter-rouge">client</code> server.</p>
  </li>
  <li>
    <p>Issue the <code class="highlighter-rouge">docker version</code> command.</p>

    <p>When issuing the command, you must pass it the location of the clients certifications.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $ sudo docker --tlsverify --tlscacert=/home/ubuntu/.certs/ca.pem --tlscert=/home/ubuntu/.certs/cert.pem --tlskey=/home/ubuntu/.certs/key.pem -H swarm:3376 version
 Client:
  Version:      1.9.1
  API version:  1.21
  Go version:   go1.4.2
  Git commit:   a34a1d5
  Built:        Fri Nov 20 13:12:04 UTC 2015
  OS/Arch:      linux/amd64

 Server:
  Version:      swarm/1.0.1
  API version:  1.21
  Go version:   go1.5.2
  Git commit:   744e3a3
  Built:
  OS/Arch:      linux/amd64
</code></pre></div>    </div>

    <p>The output above shows the <code class="highlighter-rouge">Server</code> version as “swarm/1.0.1”. This means
 that the command was successfully issued against the swarm manager.</p>
  </li>
  <li>
    <p>Verify that the same command does not work without TLS.</p>

    <p>This time, do not pass your certs to the swarm manager.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo docker -H swarm:3376 version
:
 Version:      1.9.1
 API version:  1.21
 Go version:   go1.4.2
 Git commit:   a34a1d5
 Built:        Fri Nov 20 13:12:04 UTC 2015
 OS/Arch:      linux/amd64
Get http://swarm:3376/v1.21/version: malformed HTTP response "\x15\x03\x01\x00\x02\x02".
* Are you trying to connect to a TLS-enabled daemon without TLS?
</code></pre></div>    </div>

    <p>The output above shows that the command was rejected by the server. This is
because the server (swarm manager) is configured to only accept connections
from authenticated clients using TLS.</p>
  </li>
</ol>

<h2 id="step-9-configure-the-engine-cli-to-use-tls">Step 9: Configure the Engine CLI to use TLS</h2>

<p>You can configure the Engine so that you don’t need to pass the TLS options when
you issue a command. To do this, configure the <code class="highlighter-rouge">Docker Engine host</code> and
<code class="highlighter-rouge">TLS</code> settings as defaults on your Docker Engine client.</p>

<p>To do this, you place the client’s keys in your <code class="highlighter-rouge">~/.docker</code> configuration
folder. If you have other users on your system using the Engine command line,
configure their account’s <code class="highlighter-rouge">~/.docker</code> as well. The procedure below shows how to
do this for the <code class="highlighter-rouge">ubuntu</code> user on your Docker Engine client.</p>

<ol>
  <li>
    <p>Open a terminal onto your <code class="highlighter-rouge">client</code> server.</p>
  </li>
  <li>
    <p>If it doesn’t exist, create a <code class="highlighter-rouge">.docker</code> directory in the <code class="highlighter-rouge">ubuntu</code> user’s home directory.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ mkdir /home/ubuntu/.docker
</code></pre></div>    </div>
  </li>
  <li>
    <p>Copy the Docker Engine client’s keys from <code class="highlighter-rouge">/home/ubuntu/.certs</code> to
<code class="highlighter-rouge">/home/ubuntu/.docker</code></p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cp /home/ubuntu/.certs/{ca,cert,key}.pem /home/ubuntu/.docker
</code></pre></div>    </div>
  </li>
  <li>
    <p>Edit the account’s <code class="highlighter-rouge">~/.bash_profile</code>.</p>
  </li>
  <li>
    <p>Set the following variables:</p>

    <table>
      <thead>
        <tr>
          <th>Variable</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code class="highlighter-rouge">DOCKER_HOST</code></td>
          <td>Sets the Docker host and TCP port to send all Engine commands to.</td>
        </tr>
        <tr>
          <td><code class="highlighter-rouge">DOCKER_TLS_VERIFY</code></td>
          <td>Tells Engine to use TLS.</td>
        </tr>
        <tr>
          <td><code class="highlighter-rouge">DOCKER_CERT_PATH</code></td>
          <td>Specifies the location of TLS keys.</td>
        </tr>
      </tbody>
    </table>

    <p>For example:</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export DOCKER_HOST=tcp://swarm:3376
export DOCKER_TLS_VERIFY=1
export DOCKER_CERT_PATH=/home/ubuntu/.docker/
</code></pre></div>    </div>
  </li>
  <li>
    <p>Save and close the file.</p>
  </li>
  <li>
    <p>Source the file to pick up the new variables.</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ source ~/.bash_profile
</code></pre></div>    </div>
  </li>
  <li>
    <p>Verify that the procedure worked by issuing a <code class="highlighter-rouge">docker version</code> command</p>

    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ docker version
Client:
 Version:      1.9.1
 API version:  1.21
 Go version:   go1.4.2
 Git commit:   a34a1d5
 Built:        Fri Nov 20 13:12:04 UTC 2015
 OS/Arch:      linux/amd64

Server:
 Version:      swarm/1.0.1
 API version:  1.21
 Go version:   go1.5.2
 Git commit:   744e3a3
 Built:
 OS/Arch:      linux/amd64
</code></pre></div>    </div>

    <p>The server portion of the output above command shows that your Docker
client is issuing commands to the swarm manager and using TLS.</p>
  </li>
</ol>

<p>Congratulations! You have configured a Docker swarm cluster to use TLS.</p>

<h2 id="related-information">Related information</h2>

<ul>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/swarm/secure-swarm-tls/">Secure Docker Swarm with TLS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/engine/security/security/">Docker security</a></li>
</ul>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=docker">docker</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=swarm">swarm</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=TLS">TLS</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=discovery">discovery</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=security">security</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=certificates">certificates</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/swarm/configure-tls/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "swarm/configure-tls.md",
										"title": "Configure Docker Swarm for TLS",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/swarm/configure-tls.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/swarm/configure-tls.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [swarm/configure-tls.md](https://matsuand.github.io/docs.docker.jp.onthefly/swarm/configure-tls/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#before-you-begin" class="nomunge">Before you begin</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-1-set-up-the-prerequisites" class="nomunge">Step 1: Set up the prerequisites</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-2-create-a-certificate-authority-ca-server" class="nomunge">Step 2: Create a Certificate Authority (CA) server</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-3-create-and-sign-keys" class="nomunge">Step 3: Create and sign keys</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-4-install-the-keys" class="nomunge">Step 4: Install the keys</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-5-configure-the-engine-daemon-for-tls" class="nomunge">Step 5: Configure the Engine daemon for TLS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-6-create-a-swarm-cluster" class="nomunge">Step 6: Create a swarm cluster</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-7-start-the-swarm-manager-using-tls" class="nomunge">Step 7: Start the swarm manager using TLS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-8-test-the-swarm-manager-configuration" class="nomunge">Step 8: Test the swarm manager configuration</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#step-9-configure-the-engine-cli-to-use-tls" class="nomunge">Step 9: Configure the Engine CLI to use TLS</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/configure-tls.md#related-information" class="nomunge">Related information</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03.1';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/swarm/configure-tls/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/collections_tocs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
