<!-- Page generated 2020-05-27 13:03:45 +0900 -->
<!-- Logic for 'edit this button'


    

    

    

    

    

    

    

    

-->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <style type="text/css">
      @charset "UTF-8";
      [ng\:cloak],
      [ng-cloak],
      [data-ng-cloak],
      [x-ng-cloak],
      .ng-cloak,
      .x-ng-cloak,
      .ng-hide:not(.ng-hide-animate) {
          display: none !important;
      }

      ng\:form {
          display: block;
      }
  </style>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WL2QLG5');</script>

  
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
  <link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
  <meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
  <!-- metadata -->
  <meta property="og:type" content="website"/>
  <meta property="og:updated_time" itemprop="dateUpdated" content="2020-05-27T13:03:45+09:00"/>
  <meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:domain" content="docs.docker.com"/>
  <meta name="twitter:site" content="@docker_docs"/>
  <meta name="twitter:url" content="https://twitter.com/docker_docs"/>
  <meta name="twitter:title" itemprop="title name" content="Backups and disaster recovery"/>
  <meta name="twitter:description" property="og:description" itemprop="description" content="When you decide to start using Docker Universal Control Plane on a production setting, you should configure it for high availability. The next step is creating a backup policy and..." />
  <meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
  <meta name="twitter:image:alt" content="Docker Documentation"/>
  <meta property="article:published_time" itemprop="datePublished" content="2020-05-27T13:03:45+09:00"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="ucp, backup, restore, recovery">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
  <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
  <link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
  <link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

  <!-- Go get "Open Sans" font from Google -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <!-- SEO stuff -->
  <title>Backups and disaster recovery | Docker Documentation</title>
  <meta property="og:title" content="Backups and disaster recovery" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="description" content="Learn how to backup your Docker Universal Control Plane swarm, and to recover your swarm from an existing backup." />
  <meta property="og:description" content="Learn how to backup your Docker Universal Control Plane swarm, and to recover your swarm from an existing backup." />
  <link rel="canonical" href="/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery/" />
  <meta property="og:url" content="https://docs.docker.com/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery/" />
  <meta property="og:site_name" content="Docker ドキュメント" />
  <script type="application/ld+json">{"@context":"http://schema.org","@type":"WebPage","headline":"Backups and disaster recovery","description":"Learn how to backup your Docker Universal Control Plane swarm, and to recover your swarm from an existing backup.","url":"https://docs.docker.com/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery/"}</script>
  <!-- END SEO STUFF -->
  <meta name="robots" content="noindex" />
  <script>
  // Default to assuming this is an archive and hiding some stuff
  // See js/archive.js and js/docs.js for logic relating to this
  var isArchive = true;
  var dockerVersion = 'v19.03';
  </script>
</head>


    <body ng-app="Docker" ng-controller="DockerController" class="colums">
    <header>
        <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/"><img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (最新)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

    </header>
    <div class="wrapper right-open">
        <div class="container-fluid">
            <div class="row">
                <div class="col-body">
                    <main class="col-content content">
                        <section class="section">
                            
                            
                            <h1>Backups and disaster recovery</h1> 
                            <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    7 分
  
</span>

                            


<blockquote><p>The documentation herein is for UCP version 3.1.12.</p>
<p>Use the drop-down below to access documentation for the current version or for a different past version.</p>
<p>
  <div class="dropdown">
    <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">3.1.12
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      
        <li><a href="/ee/ucp/">3.2 (latest)</a></li>
      
        
      
        <li><a href="/datacenter/ucp/3.0/guides/">3.0</a></li>
      
        <li><a href="/datacenter/ucp/2.2/guides/">2.2</a></li>
      
        <li><a href="/datacenter/ucp/2.1/guides/">2.1</a></li>
      
        <li><a href="/datacenter/ucp/2.0/guides/">2.0</a></li>
      
        
      
    </ul>
  </div>
  </p>
</blockquote>

                            
                            <p>When you decide to start using Docker Universal Control Plane on a production
setting, you should
<a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/configure/join-nodes/">configure it for high availability</a>.</p>

<p>The next step is creating a backup policy and disaster recovery plan.</p>

<h2 id="data-managed-by-ucp">Data managed by UCP</h2>

<p>UCP maintains data about:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Data</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Configurations</td>
      <td style="text-align: left">The UCP cluster configurations, as shown by <code class="highlighter-rouge">docker config ls</code>, including Docker EE license and swarm and client CAs</td>
    </tr>
    <tr>
      <td style="text-align: left">Access control</td>
      <td style="text-align: left">Permissions for teams to cluster resources, including resource sets, grants, and roles</td>
    </tr>
    <tr>
      <td style="text-align: left">Certificates and keys</td>
      <td style="text-align: left">The certificates, public keys, and private keys that are used for authentication and mutual TLS communication</td>
    </tr>
    <tr>
      <td style="text-align: left">Metrics data</td>
      <td style="text-align: left">Monitoring data gathered by UCP</td>
    </tr>
    <tr>
      <td style="text-align: left">Organizations</td>
      <td style="text-align: left">Your users, teams, and orgs</td>
    </tr>
    <tr>
      <td style="text-align: left">Volumes</td>
      <td style="text-align: left">All <a href="../architecture/#volumes-used-by-ucp">UCP named volumes</a>, which include all UCP component certs and data</td>
    </tr>
  </tbody>
</table>

<p>This data is persisted on the host running UCP, using named volumes.
<a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/ucp-architecture/">Learn more about UCP named volumes</a>.</p>

<blockquote>
  <p>Warning: UCP will not back up your routing mesh settings. After restoring,
<a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/interlock/deploy/">reenable the routing mesh</a>. Additionally, if you’ve customized
your Layer 7 routing deployment, reapply your custom settings.</p>
  <h2 id="backup-steps">Backup steps</h2>
</blockquote>

<p>Back up your Docker EE components in the following order:</p>

<ol>
  <li><a href="/engine/swarm/admin_guide/#back-up-the-swarm">Back up your swarm</a></li>
  <li>Back up UCP</li>
  <li><a href="/ee/dtr/admin/disaster-recovery/">Back up DTR</a></li>
</ol>

<h2 id="backup-policy">Backup policy</h2>

<p>As part of your backup policy you should regularly create backups of UCP.
DTR is backed up independently.
<a href="../../dtr/2.5/admin/disaster-recovery/index.md">Learn about DTR backups and recovery</a>.</p>

<blockquote>
  <p>Warning: On UCP versions 3.1.0 - 3.1.2, before performing a UCP backup, you must clean up multiple /dev/shm mounts in the ucp-kublet entrypoint script by running the following script on all nodes via cron job:</p>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SHM_MOUNT=$(grep -m1 '^tmpfs./dev/shm' /proc/mounts)
while [ $(grep -cm2 '^tmpfs./dev/shm' /proc/mounts) -gt 1 ]; do
  sudo umount /dev/shm
done
grep -q '^tmpfs./dev/shm' /proc/mounts || sudo mount "${SHM_MOUNT}"
</code></pre></div></div>
<p>For additional details, refer to <a href="https://success.docker.com/article/more-than-one-dev-shm-mount-in-the-host-namespace" target="_blank">Docker KB000934</a></p>

<p>To create a UCP backup, run the <code class="highlighter-rouge">docker/ucp:3.1.12 backup</code> command
on a single UCP manager. This command creates a tar archive with the
contents of all the <a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/ucp-architecture/">volumes used by UCP</a> to persist data
and streams it to <code class="highlighter-rouge">stdout</code>. The backup doesn’t include the swarm-mode state,
like service definitions and overlay network definitions.</p>

<p>You only need to run the backup command on a single UCP manager node. Since UCP
stores the same data on all manager nodes, you only need to take periodic
backups of a single manager node.</p>

<p>To create a consistent backup, the backup command temporarily stops the UCP
containers running on the node where the backup is being performed. User
resources, such as services, containers, and stacks are not affected by this
operation and will continue operating as expected. Any long-lasting <code class="highlighter-rouge">exec</code>,
<code class="highlighter-rouge">logs</code>, <code class="highlighter-rouge">events</code>, or <code class="highlighter-rouge">attach</code> operations on the affected manager node will
be disconnected.</p>

<p>Additionally, if UCP is not configured for high availability, you will be
temporarily unable to:</p>

<ul>
  <li>Log in to the UCP Web UI</li>
  <li>Perform CLI operations using existing client bundles</li>
</ul>

<p>To minimize the impact of the backup policy on your business, you should:</p>

<ul>
  <li>Configure UCP for <a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/configure/join-nodes/">high availability</a>.
This allows load-balancing user requests across multiple UCP manager nodes.</li>
  <li>Schedule the backup to take place outside business hours.</li>
</ul>

<h2 id="backup-command">Backup command</h2>

<p>The example below shows how to create a backup of a UCP manager node and
verify its contents:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create a backup, encrypt it, and store it on /tmp/backup.tar</span>
docker container run <span class="se">\</span>
  <span class="nt">--log-driver</span> none <span class="nt">--rm</span> <span class="se">\</span>
  <span class="nt">--interactive</span> <span class="se">\</span>
  <span class="nt">--name</span> ucp <span class="se">\</span>
  <span class="nt">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="se">\</span>
  docker/ucp:3.1.12 backup <span class="se">\</span>
  <span class="nt">--id</span> &lt;ucp-instance-id&gt; <span class="se">\</span>
  <span class="nt">--passphrase</span> <span class="s2">"secret"</span> <span class="o">&gt;</span> /tmp/backup.tar

<span class="c"># Decrypt the backup and list its contents</span>
<span class="nv">$ </span>gpg <span class="nt">--decrypt</span> /tmp/backup.tar | <span class="nb">tar</span> <span class="nt">--list</span>
</code></pre></div></div>

<h3 id="security-enhanced-linux-selinux">Security-Enhanced Linux (SELinux)</h3>

<p>For Docker EE 17.06 or higher, if the Docker engine has SELinux enabled,
which is typical for RHEL hosts, you need to include <code class="highlighter-rouge">--security-opt label=disable</code>
in the <code class="highlighter-rouge">docker</code> command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker container run <span class="nt">--security-opt</span> <span class="nv">label</span><span class="o">=</span>disable <span class="nt">--log-driver</span> none <span class="nt">--rm</span> <span class="nt">-i</span> <span class="nt">--name</span> ucp <span class="se">\</span>
  <span class="nt">-v</span> /var/run/docker.sock:/var/run/docker.sock <span class="se">\</span>
  docker/ucp:3.1.12 backup <span class="nt">--interactive</span> <span class="o">&gt;</span> /tmp/backup.tar
</code></pre></div></div>

<p>To find out whether SELinux is enabled in the engine, view the host’s
<code class="highlighter-rouge">/etc/docker/daemon.json</code> file and search for the string
<code class="highlighter-rouge">"selinux-enabled":"true"</code>.</p>

<h2 id="restore-ucp">Restore UCP</h2>

<p>To restore an existing UCP installation from a backup, you need to
uninstall UCP from the swarm by using the <code class="highlighter-rouge">uninstall-ucp</code> command.
<a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/install/uninstall/">Learn to uninstall UCP</a>.</p>

<p>If you restore UCP using a different Docker swarm than the one where UCP was
previously deployed on, UCP will start using new TLS certificates. Existing
client bundles won’t work anymore, so users need to download new ones.</p>

<p>When restoring, make sure you use the same version of the <code class="highlighter-rouge">docker/ucp</code> image
that you’ve used to create the backup. The example below shows how to restore
UCP from an existing backup file, presumed to be located at
<code class="highlighter-rouge">/tmp/backup.tar</code>:</p>

<pre><code class="language-none">docker container run --rm -i --name ucp \
  -v /var/run/docker.sock:/var/run/docker.sock  \
  docker/ucp:3.1.12 restore &lt; /tmp/backup.tar
</code></pre>

<p>If the backup file is encrypted with a passphrase, you will need to provide the
passphrase to the restore operation:</p>

<pre><code class="language-none">docker container run --rm -i --name ucp \
  -v /var/run/docker.sock:/var/run/docker.sock  \
  docker/ucp:3.1.12 restore --passphrase "secret" &lt; /tmp/backup.tar
</code></pre>

<p>The restore command may also be invoked in interactive mode, in which case the
backup file should be mounted to the container rather than streamed through
<code class="highlighter-rouge">stdin</code>:</p>

<pre><code class="language-none">docker container run --rm -i --name ucp \
  -v /var/run/docker.sock:/var/run/docker.sock \
  -v /tmp/backup.tar:/config/backup.tar \
  docker/ucp:3.1.12 restore -i
</code></pre>

<h3 id="ucp-and-swarm">UCP and Swarm</h3>

<p>UCP restore recovers the following assets from the backup file:</p>

<ul>
  <li>Users, teams, and permissions.</li>
  <li>All UCP configuration options available under <code class="highlighter-rouge">Admin Settings</code>, like the
Docker EE subscription license, scheduling options, content trust, and
authentication backends.</li>
</ul>

<p>UCP restore does not include swarm assets such as cluster membership, services, networks,
secrets, etc.  <a href="/engine/swarm/admin_guide/#back-up-the-swarm">Learn to backup a swarm</a>.</p>

<p>There are two ways to restore UCP:</p>

<ul>
  <li>On a manager node of an existing swarm which does not have UCP installed.
In this case, UCP restore will use the existing swarm.</li>
  <li>On a docker engine that isn’t participating in a swarm. In this case, a new
swarm is created and UCP is restored on top.</li>
</ul>

<h2 id="disaster-recovery">Disaster recovery</h2>

<p>In the event where half or more manager nodes are lost and cannot be recovered
to a healthy state, the system is considered to have lost quorum and can only be
restored through the following disaster recovery procedure. If your cluster has
lost quorum, you can still take a backup of one of the remaining nodes, but we
recommend making backups regularly.</p>

<p>It is important to note that this procedure is not guaranteed to succeed with
no loss of running services or configuration data. To properly protect against
manager failures, the system should be configured for
<a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/configure/join-nodes/">high availability</a>.</p>

<ol>
  <li>On one of the remaining manager nodes, perform <code class="highlighter-rouge">docker swarm init
--force-new-cluster</code>. You may also need to specify an
<code class="highlighter-rouge">--advertise-addr</code> parameter which is equivalent to the <code class="highlighter-rouge">--host-address</code>
parameter of the <code class="highlighter-rouge">docker/ucp install</code> operation. This will instantiate a new
single-manager swarm by recovering as much state as possible from the
existing manager. This is a disruptive operation and existing tasks may be
either terminated or suspended.</li>
  <li>Obtain a backup of one of the remaining manager nodes if one is not already
available.</li>
  <li>If UCP is still installed on the swarm, uninstall UCP using the
<code class="highlighter-rouge">uninstall-ucp</code> command.</li>
  <li>Perform a restore operation on the recovered swarm manager node.</li>
  <li>Log in to UCP and browse to the nodes page, or use the CLI <code class="highlighter-rouge">docker node ls</code>
command.</li>
  <li>If any nodes are listed as <code class="highlighter-rouge">down</code>, you’ll have to manually
<a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/configure/scale-your-cluster/">remove these nodes</a> from the swarm and then
re-join them using a <code class="highlighter-rouge">docker swarm join</code> operation with the swarm’s new
join-token.</li>
</ol>

<h2 id="where-to-go-next">Where to go next</h2>

<ul>
  <li><a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/ucp-architecture/">UCP architecture</a></li>
  <li><a href="/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/configure/join-nodes/">Set up high availability</a></li>
</ul>

                            <!-- tags -->
                            
                            <span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span
                                style="vertical-align: 2px"><a
                                    href="https://docs.docker.com/search/?q=ucp">ucp</a>, <a
                                    href="https://docs.docker.com/search/?q=backup">backup</a>, <a
                                    href="https://docs.docker.com/search/?q=restore">restore</a>, <a
                                    href="https://docs.docker.com/search/?q=recovery">recovery</a></span>
                            
                            
                            <div id="ratings-div"
                                style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
                                <div id="pd_rating_holder_8453675"></div>
                                <script type="text/javascript">
                                    PDRTJS_settings_8453675 = {
                                        "id": "8453675",
                                        "unique_id": "datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery.md",
                                        "title": "Backups and disaster recovery",
                                        "permalink": "https://github.com/docker/docker.github.io/blob/master/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery.md"
                                    };
                                    (function (d, c, j) {
                                        if (!document.getElementById(j)) {
                                            var pd = d.createElement(c),
                                                s;
                                            pd.id = j;
                                            pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
                                            s = document.getElementsByTagName(c)[0];
                                            s.parentNode.insertBefore(pd, s);
                                        }
                                    }(document, 'script', 'pd-rating-js'));
                                </script>
                            </div>
                            
                        </section>
                    </main>
                    <nav class="col-nav">
                        <div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
                            <div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

                        </div>
                    </nav>
                    <div class="col-toc">
                        <div class="sidebar hidden-xs hidden-sm">
                            <div class="toc-nav">
                                <div class="feedback-links">
                                    <ul>
                                        
                                        <li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery.md"><i
                                                    class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
                                        <li><a href="https://github.com/matsuand/docs.docker.jp/issues/new?body=ファイル: [datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery.md](https://matsuand.github.io/docs.docker.jp.onthefly/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery/)"
                                                class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
                                        <!-- toggle mode -->
                                        <li>
                                            <div class="toggle-mode">
                                                <div class="icon">
                                                    <i class="fa fa-sun-o" aria-hidden="true"></i>
                                                </div>
                                                <div class="toggle-switch">
                                                    <label class="switch">
                                                        <input type="checkbox" id="switch-style">
                                                        <div class="slider round"></div>
                                                    </label>
                                                </div>
                                                <div class="icon">
                                                    <i class="fa fa-moon-o" aria-hidden="true"></i>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                
                                
                                
                                
                                <div id="side-toc-title">本ページ内:</div>
                                
<ul id="my_toc" class="inline_toc">
  <li><a href="#data-managed-by-ucp" class="nomunge">Data managed by UCP</a></li>
  <li><a href="#backup-steps" class="nomunge">Backup steps</a></li>
  <li><a href="#backup-policy" class="nomunge">Backup policy</a></li>
  <li><a href="#backup-command" class="nomunge">Backup command</a>
    <ul>
      <li><a href="#security-enhanced-linux-selinux" class="nomunge">Security-Enhanced Linux (SELinux)</a></li>
    </ul>
  </li>
  <li><a href="#restore-ucp" class="nomunge">Restore UCP</a>
    <ul>
      <li><a href="#ucp-and-swarm" class="nomunge">UCP and Swarm</a></li>
    </ul>
  </li>
  <li><a href="#disaster-recovery" class="nomunge">Disaster recovery</a></li>
  <li><a href="#where-to-go-next" class="nomunge">Where to go next</a></li>
</ul>


                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    
    <footer class="footer">
          
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

    </footer>
    <link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
    
    <script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
    <script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
    <script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
    <!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
    <script>
        // Default to assuming this is an archive and hiding some stuff
        // See js/archive.js and js/docs.js for logic relating to this
        var isArchive = true;
        var dockerVersion = 'v19.03';
        // In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
        var jekyllEnv = 'development';
        // If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
        if (jekyllEnv === 'development') {
            jekyllEnv = '';
        }
        var pageURL = jekyllEnv + '/datacenter/ucp/3.1/guides/admin/backups-and-disaster-recovery/';
    </script>
    <script src="/docs.docker.jp.onthefly/js/archive.js"></script>
    <script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
    <script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
    <script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
    <script>
        jQuery(document).ready(function () { hookupTOCEvents(); });
    </script>
</body>


</html>
