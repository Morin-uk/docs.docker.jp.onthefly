<!-- Page generated 2020-04-13 12:18:52 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
	<!-- End Google Tag Manager -->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2020-04-13T12:18:52+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="DTR backups and recovery"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="DTR requires that a majority (n/2 + 1) of its replicas are healthy at all times for it to work. So if a majority of replicas is unhealthy or lost,..." />
	<meta name="twitter:image:src" content="/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker ドキュメント"/>
	<meta property="article:published_time" itemprop="datePublished" content="2020-04-13T12:18:52+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="registry, high-availability, backup, recovery">
	<link rel="stylesheet" href="/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>DTR backups and recovery | Docker ドキュメント</title>
<meta property="og:title" content="DTR backups and recovery" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Learn how to back up your Docker Trusted Registry cluster, and to recover your cluster from an existing backup." />
<meta property="og:description" content="Learn how to back up your Docker Trusted Registry cluster, and to recover your cluster from an existing backup." />
<link rel="canonical" href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery/" />
<meta property="og:site_name" content="Docker ドキュメント" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"DTR backups and recovery","description":"Learn how to back up your Docker Trusted Registry cluster, and to recover your cluster from an existing backup.","url":"https://matsuand.github.io/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery/"}</script>
	<!-- END SEO STUFF -->
	<meta name="robots" content="noindex" />
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="/docs.docker.jp.onthefly/"><img class="logo" src="/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)     <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>DTR backups and recovery</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    7 分
  
</span>

							


<blockquote><p>The documentation herein is for DTR version 2.5.16.</p>
<p>Use the drop-down below to access documentation for the current version or for a different past version.</p>
<p>
  <div class="dropdown">
    <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">2.5.16
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      
        <li><a href="/docs.docker.jp.onthefly/ee/dtr/">2.7 (latest)</a></li>
      
        <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.6/guides/">2.6</a></li>
      
        
      
        <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.4/guides/">2.4</a></li>
      
        <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.3/guides/">2.3</a></li>
      
        <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.2/guides/">2.2</a></li>
      
        <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.1/guides/">2.1</a></li>
      
        <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.0/">2.0</a></li>
      
    </ul>
  </div>
  </p>
</blockquote>

							
							
<p>DTR requires that a majority (n/2 + 1) of its replicas are healthy at all times
for it to work. So if a majority of replicas is unhealthy or lost, the only
way to restore DTR to a working state, is by recovering from a backup. This
is why it’s important to ensure replicas are healthy and perform frequent
backups.</p>

<h2 id="data-managed-by-dtr">Data managed by DTR</h2>

<p>Docker Trusted Registry maintains data about:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Data</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Configurations</td>
      <td style="text-align: left">The DTR cluster configurations</td>
    </tr>
    <tr>
      <td style="text-align: left">Repository metadata</td>
      <td style="text-align: left">The metadata about the repositories and images deployed</td>
    </tr>
    <tr>
      <td style="text-align: left">Access control to repos and images</td>
      <td style="text-align: left">Permissions for teams and repositories</td>
    </tr>
    <tr>
      <td style="text-align: left">Notary data</td>
      <td style="text-align: left">Notary tags and signatures</td>
    </tr>
    <tr>
      <td style="text-align: left">Scan results</td>
      <td style="text-align: left">Security scanning results for images</td>
    </tr>
    <tr>
      <td style="text-align: left">Certificates and keys</td>
      <td style="text-align: left">The certificates, public keys, and private keys that are used for mutual TLS communication</td>
    </tr>
    <tr>
      <td style="text-align: left">Images content</td>
      <td style="text-align: left">The images you push to DTR. This can be stored on the filesystem of the node running DTR, or other storage system, depending on the configuration</td>
    </tr>
  </tbody>
</table>

<p>This data is persisted on the host running DTR, using named volumes.
<a href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/architecture/">Learn more about DTR named volumes</a>.</p>

<p>To perform a backup of a DTR node, run the <code class="highlighter-rouge">docker/dtr backup</code> command. This
command backups up the following data:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Data</th>
      <th style="text-align: left">Backed up</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Configurations</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">DTR settings</td>
    </tr>
    <tr>
      <td style="text-align: left">Repository metadata</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">Metadata like image architecture and size</td>
    </tr>
    <tr>
      <td style="text-align: left">Access control to repos and images</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">Data about who has access to which images</td>
    </tr>
    <tr>
      <td style="text-align: left">Notary data</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">Signatures and digests for images that are signed</td>
    </tr>
    <tr>
      <td style="text-align: left">Scan results</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">Information about vulnerabilities in your images</td>
    </tr>
    <tr>
      <td style="text-align: left">Certificates and keys</td>
      <td style="text-align: left">yes</td>
      <td style="text-align: left">TLS certificates and keys used by DTR</td>
    </tr>
    <tr>
      <td style="text-align: left">Image content</td>
      <td style="text-align: left">no</td>
      <td style="text-align: left">Needs to be backed up separately, depends on DTR configuration</td>
    </tr>
    <tr>
      <td style="text-align: left">Users, orgs, teams</td>
      <td style="text-align: left">no</td>
      <td style="text-align: left">Create a UCP backup to backup this data</td>
    </tr>
    <tr>
      <td style="text-align: left">Vulnerability database</td>
      <td style="text-align: left">no</td>
      <td style="text-align: left">Can be re-downloaded after a restore</td>
    </tr>
  </tbody>
</table>

<h2 id="backup-dtr-data">Backup DTR data</h2>

<p>To create a backup of DTR you need to:</p>

<ol>
  <li>Backup image content</li>
  <li>Backup DTR metadata</li>
</ol>

<p>You should always create backups from the same DTR replica, to ensure a smoother
restore.</p>

<h3 id="backup-image-content">Backup image content</h3>

<p>Since you can configure the storage backend that DTR uses to store images,
the way you backup images depends on the storage backend you’re using.</p>

<p>If you’ve configured DTR to store images on the local filesystem or NFS mount,
you can backup the images by using ssh to log into a node where DTR is running,
and creating a tar archive of the <a href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/architecture/">dtr-registry volume</a>:</p>

<pre><code class="language-none">sudo tar -cf backup-images.tar \
  $(dirname $(docker volume inspect --format '{{.Mountpoint}}' dtr-registry-&lt;replica-id&gt;))
</code></pre>

<p>If you’re using a different storage backend, follow the best practices
recommended for that system.</p>

<h3 id="backup-dtr-metadata">Backup DTR metadata</h3>

<p>To create a DTR backup, load your UCP client bundle, and run the following
command, replacing the placeholders for the real values:</p>

<pre><code class="language-none">read -sp 'ucp password: ' UCP_PASSWORD; \
docker run --log-driver none -i --rm \
  --env UCP_PASSWORD=$UCP_PASSWORD \
  docker/dtr:2.5.16 backup \
  --ucp-url &lt;ucp-url&gt; \
  --ucp-insecure-tls \
  --ucp-username &lt;ucp-username&gt; \
  --existing-replica-id &lt;replica-id&gt; &gt; backup-metadata.tar
</code></pre>

<p>Where:</p>

<ul>
  <li><code class="highlighter-rouge">&lt;ucp-url&gt;</code> is the url you use to access UCP</li>
  <li><code class="highlighter-rouge">&lt;ucp-username&gt;</code> is the username of a UCP administrator</li>
  <li><code class="highlighter-rouge">&lt;replica-id&gt;</code> is the id of the DTR replica to backup</li>
</ul>

<p>This prompts you for the UCP password, backups up the DTR metadata and saves the
result into a tar archive. You can learn more about the supported flags in
the <a href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/reference/cli/backup/">reference documentation</a>.</p>

<p>The backup command doesn’t stop DTR, so that you can take frequent backups
without affecting your users. Also, the backup contains sensitive information
like private keys, so you can encrypt the backup by running:</p>

<pre><code class="language-none">gpg --symmetric backup-metadata.tar
</code></pre>

<p>This prompts you for a password to encrypt the backup, copies the backup file
and encrypts it.</p>

<h3 id="test-your-backups">Test your backups</h3>

<p>To validate that the backup was correctly performed, you can print the contents
of the tar file created. The backup of the images should look like:</p>

<pre><code class="language-none">tar -tf backup-images.tar

dtr-backup-v2.5.16/
dtr-backup-v2.5.16/rethink/
dtr-backup-v2.5.16/rethink/layers/
</code></pre>

<p>And the backup of the DTR metadata should look like:</p>

<pre><code class="language-none">tar -tf backup-metadata.tar

# The archive should look like this
dtr-backup-v2.5.16/
dtr-backup-v2.5.16/rethink/
dtr-backup-v2.5.16/rethink/properties/
dtr-backup-v2.5.16/rethink/properties/0
</code></pre>

<p>If you’ve encrypted the metadata backup, you can use:</p>

<pre><code class="language-none">gpg -d backup-metadata.tar | tar -t
</code></pre>

<p>You can also create a backup of a UCP cluster and restore it into a new
cluster. Then restore DTR on that new cluster to confirm that everything is
working as expected.</p>

<h2 id="restore-dtr-data">Restore DTR data</h2>

<p>If your DTR has a majority of unhealthy replicas, the one way to restore it to
a working state is by restoring from an existing backup.</p>

<p>To restore DTR, you need to:</p>

<ol>
  <li>Stop any DTR containers that might be running</li>
  <li>Restore the images from a backup</li>
  <li>Restore DTR metadata from a backup</li>
  <li>Re-fetch the vulnerability database</li>
</ol>

<p>You need to restore DTR on the same UCP cluster where you’ve created the
backup. If you restore on a different UCP cluster, all DTR resources will be
owned by users that don’t exist, so you can’t manage the resources,
even though they’re stored in the DTR data store.</p>

<p>When restoring, you need to use the same version of the <code class="highlighter-rouge">docker/dtr</code> image
that you’ve used when creating the update. Other versions are not guaranteed
to work.</p>

<h3 id="stop-dtr-containers">Stop DTR containers</h3>

<p>Start by removing any DTR container that is still running:</p>

<pre><code class="language-none">docker run -it --rm \
  docker/dtr:2.5.16 destroy \
  --ucp-insecure-tls
</code></pre>

<h3 id="restore-images">Restore images</h3>

<p>If you had DTR configured to store images on the local filesystem, you can
extract your backup:</p>

<pre><code class="language-none">sudo tar -xf backup-images.tar -C /
</code></pre>

<p>If you’re using a different storage backend, follow the best practices
recommended for that system. When restoring the DTR metadata, DTR will be
deployed with the same configurations it had when creating the backup.</p>

<h3 id="restore-dtr-metadata">Restore DTR metadata</h3>

<p>You can restore the DTR metadata with the <code class="highlighter-rouge">docker/dtr restore</code> command. This
performs a fresh installation of DTR, and reconfigures it with
the configuration created during a backup.</p>

<p>Load your UCP client bundle, and run the following command, replacing the
placeholders for the real values:</p>

<pre><code class="language-none">read -sp 'ucp password: ' UCP_PASSWORD; \
docker run -i --rm \
  --env UCP_PASSWORD=$UCP_PASSWORD \
  docker/dtr:2.5.16 restore \
  --ucp-url &lt;ucp-url&gt; \
  --ucp-insecure-tls \
  --ucp-username &lt;ucp-username&gt; \
  --ucp-node &lt;hostname&gt; \
  --replica-id &lt;replica-id&gt; \
  --dtr-external-url &lt;dtr-external-url&gt; &lt; backup-metadata.tar
</code></pre>

<p>Where:</p>

<ul>
  <li><code class="highlighter-rouge">&lt;ucp-url&gt;</code> is the url you use to access UCP</li>
  <li><code class="highlighter-rouge">&lt;ucp-username&gt;</code> is the username of a UCP administrator</li>
  <li><code class="highlighter-rouge">&lt;hostname&gt;</code> is the hostname of the node where you’ve restored the images</li>
  <li><code class="highlighter-rouge">&lt;replica-id&gt;</code> the id of the replica you backed up</li>
  <li><code class="highlighter-rouge">&lt;dtr-external-url&gt;</code>the url that clients use to access DTR</li>
</ul>

<p>If you’re using NFS as a storage backend, also include <code class="highlighter-rouge">--nfs-storage-url</code> as
part of your restore command, otherwise DTR is restored but starts using a
local volume to persist your Docker images.</p>

<h3 id="re-fetch-the-vulnerability-database">Re-fetch the vulnerability database</h3>

<p>If you’re scanning images, you now need to download the vulnerability database.</p>

<p>After you successfully restore DTR, you can join new replicas the same way you
would after a fresh installation. <a href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/configure/set-up-vulnerability-scans/">Learn more</a>.</p>

<h2 id="where-to-go-next">Where to go next</h2>

<ul>
  <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/configure/set-up-high-availability/">Set up high availability</a></li>
  <li><a href="/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/architecture/">DTR architecture</a></li>
</ul>

							<!-- tags -->
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=registry">registry</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=high-availability">high-availability</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=backup">backup</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=recovery">recovery</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery.md",
										"title": "DTR backups and recovery",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery.md](https://matsuand.github.io/docs.docker.jp.onthefly/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#data-managed-by-dtr" class="nomunge">Data managed by DTR</a></li>
  <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#backup-dtr-data" class="nomunge">Backup DTR data</a>
    <ul>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#backup-image-content" class="nomunge">Backup image content</a></li>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#backup-dtr-metadata" class="nomunge">Backup DTR metadata</a></li>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#test-your-backups" class="nomunge">Test your backups</a></li>
    </ul>
  </li>
  <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#restore-dtr-data" class="nomunge">Restore DTR data</a>
    <ul>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#stop-dtr-containers" class="nomunge">Stop DTR containers</a></li>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#restore-images" class="nomunge">Restore images</a></li>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#restore-dtr-metadata" class="nomunge">Restore DTR metadata</a></li>
      <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#re-fetch-the-vulnerability-database" class="nomunge">Re-fetch the vulnerability database</a></li>
    </ul>
  </li>
  <li><a href="/docs.docker.jp.onthefly/backups-and-disaster-recovery.md#where-to-go-next" class="nomunge">Where to go next</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/why-docker">Why Docker</a></b></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/overview">Products</a></b></li>
                        <li><a href="https://www.docker.com/products/docker-desktop">Docker Desktop</a></li>
                        <li><a href="https://www.docker.com/products/docker-hub">Docker Hub</a></li>
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Features</a></b></li>
                        <li><a href="https://www.docker.com/products/container-runtime">Container Runtime</a></li>
                        <li><a href="https://www.docker.com/products/developer-tools">Developer Tools</a></li>
                        <li><a href="https://www.docker.com/products/kubernetes">Kubernetes</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/products/docker-desktop">Developers</a></b></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/play-with-docker">Play with Docker</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/open-source">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><b><a href="https://www.docker.com/company" target="_blank">Company</a></b></li>
                        <li><a href="https://www.docker.com/company">About Us</a></li>
                        <li><a href="https://www.docker.com/blog/" target="_blank">Blog</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners">Partners</a></li>
                        <li><a href="https://www.docker.com/company/newsroom">Newsroom</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2013-2020 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-slideshare"><a href="https://www.slideshare.net/docker">Slideshare</a></li>
                    <li class="fa fa-reddit"><a href="https://www.reddit.com/r/docker">Reddit</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="/docs.docker.jp.onthefly/css/github.css">
	
	<script defer src="/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/datacenter/dtr/2.5/guides/admin/backups-and-disaster-recovery/';
	</script>
	<script src="/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
