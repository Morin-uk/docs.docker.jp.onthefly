<!-- Page generated 2019-07-08 21:38:19 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-07-08T21:38:19+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="Use the Notary client for advanced users"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="This page explains advanced uses of Notary client for users who are running their own Notary service. Make sure you have first read and understood how to run your own..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker Documentation"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-07-08T21:38:19+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="docker, notary, notary-client, docker content trust, content trust, power user, advanced">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>Use the Notary client for advanced users | Docker Documentation</title>
<meta property="og:title" content="Use the Notary client for advanced users" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Becoming a power user of the notary client." />
<meta property="og:description" content="Becoming a power user of the notary client." />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/advanced_usage/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/notary/advanced_usage/" />
<meta property="og:site_name" content="Docker Documentation" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Use the Notary client for advanced users","description":"Becoming a power user of the notary client.","url":"https://matsuand.github.io/docs.docker.jp.onthefly/notary/advanced_usage/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v18.09';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" /id="searchForm" action="/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v18.09 (current)        <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Use the Notary client for advanced users</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    11 分
  
</span>

							
							
							<p>This page explains advanced uses of Notary client for users who are running
their own Notary service. Make sure you have first read and understood how to
<a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/running_a_service/">run your own Notary service</a> before continuing.</p>

<h2 id="an-important-note-about-the-examples">An important note about the examples</h2>

<p>This document’s command examples omit the <code class="highlighter-rouge">-s</code> and <code class="highlighter-rouge">-d</code> flags. If you do not
know what these options do, read the <a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/getting_started/">Getting
Started</a> docs or run <code class="highlighter-rouge">notary --help</code> before continuing. Once
you understand what these flags do, you must provide your own values for these
options while following this document. You can also configure these options, see
<a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/">advanced configuration options</a> for more information.</p>

<h2 id="initialize-a-trusted-collection">Initialize a Trusted Collection</h2>

<p>Before adding and signing content to a collection, you must first initialize that collection.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary init example.com/collection

No root keys found. Generating a new root key...
You are about to create a new root signing key passphrase. This passphrase
is used to protect the most sensitive key <span class="k">in </span>your signing system.
Choose a long, complex passphrase and be careful to keep the password and the
key file itself secure and backed up. It is highly recommended that you use a
password manager to generate the passphrase and keep it safe. There is no
way to recover this key. You can find the key <span class="k">in </span>your config directory.
Enter passphrase <span class="k">for </span>new root key with ID 1f54328:
Repeat passphrase <span class="k">for </span>new root key with ID 1f54328:
Enter passphrase <span class="k">for </span>new targets key with ID 1df39fc <span class="o">(</span>example.com/collection<span class="o">)</span>:
Repeat passphrase <span class="k">for </span>new targets key with ID 1df39fc <span class="o">(</span>example.com/collection<span class="o">)</span>:
</code></pre></div></div>

<p>Initializing a trusted collection generates the following items; all keys use
asymmetric algorithms, but there is no requirement that they all use the <em>same</em>
algorithm:</p>

<ul>
  <li>If no root key is found, an initial <code class="highlighter-rouge">root</code> key is generated. This key is
used as the default root of trust for all your trusted collections.</li>
  <li>A <code class="highlighter-rouge">targets</code> key and a <code class="highlighter-rouge">snapshot</code> key. The same password encrypts both of these
as the security profile of them (when both held by the author of the trusted
collection) is identical. This is why are not prompted for a snapshot key
password.</li>
  <li>A <code class="highlighter-rouge">timestamp</code> key. This is generated by the server on a request from the
client, returning just the public key. The server holds the private key and
signs timestamps on behalf of the user.</li>
  <li>Stub signed notary metadata. This stages the base version of the trust
metadata for the collection. It is finalized when it is published to the
server.</li>
</ul>

<h2 id="add-and-remove-targets">Add and remove Targets</h2>

<p>To add targets to a trusted collection with notary CLI:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary add example.com/collection v1 my_file.txt
</code></pre></div></div>

<p>This adds the local file <code class="highlighter-rouge">my_file.txt</code> (which must exist relative to the
current working directory), under the target name <code class="highlighter-rouge">v1</code>, to the
<code class="highlighter-rouge">example.com/collection</code> collection we set up. The contents of the local file
are not actually added to the collection - a “target” consists of the file path
and one or more checksums of the contents.</p>

<p>This is an offline command, and we must run a
<code class="highlighter-rouge">notary publish example.com/collection</code> for the add to take effect.</p>

<p>To remove targets, we use the <code class="highlighter-rouge">notary remove</code> command, specifying the GUN and
target name.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary remove example.com/collection v1
</code></pre></div></div>

<p>Removing a target is also an offline command that requires a
<code class="highlighter-rouge">notary publish example.com/collection</code> to take effect.</p>

<h2 id="manage-keys">Manage keys</h2>

<p>By default, the notary client is responsible for managing the private keys for
root, targets, snapshot roles. All of these keys are generated by default when
initializing a new trusted collection. The keys are located in the notary <code class="highlighter-rouge">trust_dir</code>
directory. In addition, if delegation roles exist, those roles’ keys are to also
managed by the notary client.</p>

<p>The notary server is always responsible for managing the timestamp key. However,
it is possible for the notary server to manage the snapshot key, if the snapshot
key is rotated from the notary client to server, as described in the following
subsection.</p>

<h3 id="rotate-keys">Rotate keys</h3>

<p>In case of potential compromise, notary provides a CLI command for rotating keys.
You can use the <code class="highlighter-rouge">notary key rotate</code> command to rotate the targets or snapshot
keys.</p>

<p>While the snapshot key is managed by the notary client by default, use the <code class="highlighter-rouge">notary key
rotate snapshot -r</code> command to rotate the snapshot key to the server, such that the
notary server can sign snapshots. This is particularly useful when using
delegations with a trusted collection, so that delegates never need access to the
snapshot key to push their updates to the collection.</p>

<p>New collections created by a Docker 1.11 Engine client cause the server
manage to the snapshot key by default. To reclaim control of the snapshot key on
the client, use the <code class="highlighter-rouge">notary key rotate</code> command without the <code class="highlighter-rouge">-r</code> flag.</p>

<p>The targets key must be locally managed - to rotate the targets key, for
instance in case of compromise, use the <code class="highlighter-rouge">notary key rotate targets</code> command
without the <code class="highlighter-rouge">-r</code> flag.</p>

<h3 id="use-a-yubikey">Use a Yubikey</h3>

<p>Notary can be used with
<a href="https://www.yubico.com/products/yubikey-hardware/yubikey4/" target="_blank" class="_">Yubikey 4</a>
keys, via a PKCS11 interface when the Yubikey has CCID mode enabled.
The Yubikey is prioritized to store root keys, and requires user
touch-input for signing. Yubikey support is included with the Docker Engine 1.11
client for use with Docker Content Trust.</p>

<p>Yubikey support requires
<a href="https://www.yubico.com/support/knowledge-base/categories/downloads/" target="_blank" class="_">Yubico PIV libraries</a>
(bundled with the PIV tools) to be available in standard library locations.</p>

<h2 id="work-with-delegation-roles">Work with delegation roles</h2>

<p>Delegation roles simplify collaborator workflows in notary trusted collections, and
also allow for fine-grained permissions within a collection’s contents across
delegations. In essence, delegation roles are restricted versions of the targets
role that are only allowed to sign targets within certain filepaths.</p>

<p>A delegation role is given its own keys, such that each collaborator can keep
his own private key without the administrator having to share the
targets key or allow a collaborator write access to all targets of the
collection.</p>

<p>Before adding any delegations, you should rotate the snapshot key to the server.
This is done by default for new collections created with a Docker Engine 1.11 client.
Delegation roles do not require the snapshot key to publish
their own targets to the collection, since the server can publish the valid
snapshot with the delegation targets:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary key rotate example.com/collection snapshot <span class="nt">-r</span>
</code></pre></div></div>

<p>Here, <code class="highlighter-rouge">-r</code> specifies to rotate the key to the remote server.</p>

<p>When adding a delegation, your must acquire a x509 certificate with the public
key of the user you wish to delegate to. The user who assumes this
delegation role must hold the private key to sign content with notary.</p>

<p>Once you’ve acquired the delegate’s x509 certificate, you can add a delegation
for this user:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary delegation add example.com/collection targets/releases cert.pem <span class="nt">--paths</span><span class="o">=</span><span class="s2">"delegation/path"</span>
</code></pre></div></div>

<p>The preceding example illustrates a request to add the delegation
<code class="highlighter-rouge">targets/releases</code> to the GUN <code class="highlighter-rouge">example.com/collection</code>. The delegation name must
be prefixed by <code class="highlighter-rouge">targets/</code> to be valid, since all delegations are restricted
versions of the target role. The command adds the public key contained in the
x509 cert <code class="highlighter-rouge">cert.pem</code> to the <code class="highlighter-rouge">targets/releases</code> delegation.</p>

<p>For the <code class="highlighter-rouge">targets/releases</code> delegation role to sign content, the delegation user
must possess the private key corresponding to this public key. This command
restricts this delegation to only publish content under pathnames prefixed by
<code class="highlighter-rouge">delegation/path</code>. With the given path of “delegation/path”, the <code class="highlighter-rouge">targets/releases</code>
role could sign paths like “delegation/path/content.txt”, “delegation/path_file.txt”
and “delegation/path.txt”. You can add more paths in a comma-separated list under
<code class="highlighter-rouge">--paths</code>, or pass the <code class="highlighter-rouge">--all-paths</code> flag to allow this delegation to publish
content under any pathname.</p>

<p>After publishing, you can view delegations using a list command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary delegation list example.com/collection

      ROLE               PATHS                                   KEY IDS                                THRESHOLD
<span class="nt">---------------------------------------------------------------------------------------------------------------</span>
  targets/releases   delegation/path   729c7094a8210fd1e780e7b17b7bb55c9a28a48b871b07f65d97baf93898523a   1
</code></pre></div></div>

<p>You can see the <code class="highlighter-rouge">targets/releases</code> with its paths and key IDs. If you wish to modify these fields, you can do so with additional <code class="highlighter-rouge">notary delegation add</code> or <code class="highlighter-rouge">notary delegation remove</code> commands on this role.</p>

<p>A threshold of <code class="highlighter-rouge">1</code> indicates that only one of the keys specified in <code class="highlighter-rouge">KEY IDS</code> is required to publish to this delegation. Thresholds other than 1 are not currently supported. To remove a delegation role entirely, or just individual keys and/or paths, use the <code class="highlighter-rouge">notary delegation remove</code> command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary delegation remove example.com/user targets/releases

Are you sure you want to remove all data <span class="k">for </span>this delegation? <span class="o">(</span>yes/no<span class="o">)</span>
yes

Forced removal <span class="o">(</span>including all keys and paths<span class="o">)</span> of delegation role targets/releases to repository <span class="s2">"example.com/user"</span> staged <span class="k">for </span>next publish.
</code></pre></div></div>

<p>You can remove individual keys and/or paths by passing keys as arguments, and/or
paths under the <code class="highlighter-rouge">--paths</code> flag. Use <code class="highlighter-rouge">--all-paths</code> to clear all paths for this
role. If you specify all key IDs currently in the delegation role, you
delete the role entirely.</p>

<p>To add targets to a specified delegation role, we can use the <code class="highlighter-rouge">notary add</code>
command with the <code class="highlighter-rouge">--roles</code> flag.</p>

<p>You must have imported an appropriate delegation key for this role. To do so,
you can run <code class="highlighter-rouge">notary key import &lt;KEY_FILE&gt; --role user</code> with the private key PEM
file, or drop the private key PEM in <code class="highlighter-rouge">private/tuf_keys</code> as <code class="highlighter-rouge">&lt;KEY_ID&gt;.key</code> with
the <code class="highlighter-rouge">role</code> PEM header set to <code class="highlighter-rouge">user</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary add example/collections delegation/path/target delegation_file.txt <span class="nt">--roles</span><span class="o">=</span>targets/releases
</code></pre></div></div>

<p>In the preceding example, you add the target <code class="highlighter-rouge">delegation/path/target</code> to
collection <code class="highlighter-rouge">example/collections</code> staged for next publish. The file
<code class="highlighter-rouge">delegation_file.txt</code> is a target <code class="highlighter-rouge">delegation/path/target</code> using the delegation
role <code class="highlighter-rouge">targets/releases</code>. This target’s path is valid because it is prefixed by
the delegation role’s valid path.</p>

<p>The <code class="highlighter-rouge">notary list</code> and <code class="highlighter-rouge">notary remove</code> commands can also take the <code class="highlighter-rouge">--roles</code> flag
to specify roles to list or remove targets from. By default, this operates over
the base <code class="highlighter-rouge">targets</code> role.</p>

<p>To remove this target from our delegation, use the <code class="highlighter-rouge">notary remove</code> command with
the same flag:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>notary remove example/collections delegation/path/target <span class="nt">--roles</span><span class="o">=</span>targets/releases
</code></pre></div></div>

<h2 id="use-delegations-with-content-trust">Use delegations with content trust</h2>

<p>Docker Engine 1.10 and above supports the usage of the <code class="highlighter-rouge">targets/releases</code>
delegation as the canonical source of a trusted image tag, if it exists.</p>

<p>When running <code class="highlighter-rouge">docker pull</code> with Docker Content Trust on Docker Engine 1.10,
Docker attempts to search the <code class="highlighter-rouge">targets/releases</code> role for the signed image tag,
and falls back to the default <code class="highlighter-rouge">targets</code> role if it does not exist. When
searching the default <code class="highlighter-rouge">targets</code> role, Docker 1.10 may pick up on other
non-<code class="highlighter-rouge">targets/releases</code> delegation roles’ signed images if they exist for this tag.
In Docker 1.11, this behavior is changed such that all <code class="highlighter-rouge">docker pull</code> commands with
Docker Content Trust must pull tags only signed by the <code class="highlighter-rouge">targets/releases</code> delegation role
or the <code class="highlighter-rouge">targets</code> base role.</p>

<p>When running <code class="highlighter-rouge">docker push</code> with Docker Content Trust, Docker Engine 1.10
attempts to sign and push with the <code class="highlighter-rouge">targets/releases</code> delegation role if it exists,
otherwise falling back to the <code class="highlighter-rouge">targets</code> role. In Docker 1.11, a <code class="highlighter-rouge">docker push</code>
attempts to sign and push with all delegation roles directly under targets
(ex: <code class="highlighter-rouge">targets/role</code> but not <code class="highlighter-rouge">targets/nested/role</code>) that the user has signing keys for.
If delegation roles exist but the user does not have signing keys, the push fails.
If no delegation roles exist, the push attempts to sign with the base <code class="highlighter-rouge">targets</code> role.</p>

<p>To use the <code class="highlighter-rouge">targets/releases</code> role for pushing and pulling images with content trust,
follow the steps above to add and publish the delegation role with notary.
When adding the delegation, the <code class="highlighter-rouge">--all-paths</code> flag should be used to allow signing all tags.</p>

<h2 id="files-and-state-on-disk">Files and state on disk</h2>

<p>Notary stores state in its <code class="highlighter-rouge">trust_dir</code> directory, which is <code class="highlighter-rouge">~/.notary</code> by
default or usually <code class="highlighter-rouge">~/.docker/trust</code> when enabling docker content trust. Within this
directory, <code class="highlighter-rouge">trusted_certificates</code> stores certificates for bootstrapping trust in
a collection, <code class="highlighter-rouge">tuf</code> stores TUF metadata and changelists to be applied to a GUN,
and <code class="highlighter-rouge">private</code> stores private keys.</p>

<p>The <code class="highlighter-rouge">root_keys</code> subdirectory within <code class="highlighter-rouge">private</code> stores root private keys, while
<code class="highlighter-rouge">tuf_keys</code> stores targets, snapshots, and delegations private keys.</p>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=docker">docker</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary">notary</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary-client">notary-client</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=docker content trust">docker content trust</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=content trust">content trust</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=power user">power user</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=advanced">advanced</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/notary/advanced_usage/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "notary/advanced_usage.md",
										"title": "Use the Notary client for advanced users",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/notary/advanced_usage.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v18.09.local/notary/advanced_usage.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [notary/advanced_usage.md](https://matsuand.github.io/docs.docker.jp.onthefly/notary/advanced_usage/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#an-important-note-about-the-examples" class="nomunge">An important note about the examples</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#initialize-a-trusted-collection" class="nomunge">Initialize a Trusted Collection</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#add-and-remove-targets" class="nomunge">Add and remove Targets</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#manage-keys" class="nomunge">Manage keys</a>
    <ul>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#rotate-keys" class="nomunge">Rotate keys</a></li>
      <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#use-a-yubikey" class="nomunge">Use a Yubikey</a></li>
    </ul>
  </li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#work-with-delegation-roles" class="nomunge">Work with delegation roles</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#use-delegations-with-content-trust" class="nomunge">Use delegations with content trust</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/#files-and-state-on-disk" class="nomunge">Files and state on disk</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v18.09';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/notary/advanced_usage/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/collections_tocs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
