<!-- Page generated 2019-08-28 16:50:42 +0900 -->
<!-- relative link basehrefs -->

	
	
	
		
			
		
	
		
			
		
	
		
			
			


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<script type="text/javascript">
	  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="4.0.0";
	  analytics.load("IWj9D0UpZHZdZUZX9jl98PcpBFWBnBMy");
	  analytics.page();
	  }}();
	</script>
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2019-08-28T16:50:42+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="Notary server configuration file"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="This document is for those who are running their own Notary service who want to specify custom options. Overview A configuration file is required by Notary server, and the path..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker ドキュメント"/>
	<meta property="article:published_time" itemprop="datePublished" content="2019-08-28T16:50:42+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="docker, notary, notary-client, notary-server, notary server, notary-signer, notary signer">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>Notary server configuration file | Docker ドキュメント</title>
<meta property="og:title" content="Notary server configuration file" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Configuring the notary client, server and signer." />
<meta property="og:description" content="Configuring the notary client, server and signer." />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/server-config/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/server-config/" />
<meta property="og:site_name" content="Docker ドキュメント" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Notary server configuration file","description":"Configuring the notary client, server and signer.","url":"https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/server-config/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)         <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/edge/">Docker edge</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>Notary server configuration file</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    9 分
  
</span>

							
							
							<p>This document is for those who are <a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/running_a_service/">running their own Notary service</a> who
want to specify custom options.</p>

<h2 id="overview">Overview</h2>

<p>A configuration file is required by Notary server, and the path to the
configuration file must be specified using the <code class="highlighter-rouge">-config</code> option on the command
line.</p>

<p>Notary server also allows you to <a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/server-config/#hot-logging-level-reload">increase/decrease</a> the logging level without having to restart.</p>

<p>Here is a full server configuration file example; click on the top level JSON keys to
learn more about the configuration section corresponding to that key:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"server-config.md#server-section-required"</span><span class="err">&gt;</span><span class="s2">"server"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"http_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">":4443"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tls_key_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.key"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tls_cert_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.crt"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"server-config.md#trust-service-section-required"</span><span class="err">&gt;</span><span class="s2">"trust_service"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"remote"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"hostname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notarysigner"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7899"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"key_algorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ecdsa"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tls_ca_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/root-ca.crt"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tls_client_cert"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.crt"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"tls_client_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.key"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"server-config.md#storage-section-required"</span><span class="err">&gt;</span><span class="s2">"storage"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"backend"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mysql"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"db_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user:pass@tcp(notarymysql:3306)/databasename?parseTime=true"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"server-config.md#auth-section-optional"</span><span class="err">&gt;</span><span class="s2">"auth"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"token"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"realm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://auth.docker.io/token"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notary-server"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"issuer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth.docker.io"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"rootcertbundle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/path/to/auth.docker.io/cert"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"../common-configs/#logging-section-optional"</span><span class="err">&gt;</span><span class="s2">"logging"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"debug"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"../common-configs/#reporting-section-optional"</span><span class="err">&gt;</span><span class="s2">"reporting"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"bugsnag"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c9d60ae4c7e70c4b6c4ebd3e8056d2b8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"release_stage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"production"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"server-config.md#caching-section-optional"</span><span class="err">&gt;</span><span class="s2">"caching"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"max_age"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"current_metadata"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
      </span><span class="s2">"consistent_metadata"</span><span class="p">:</span><span class="w"> </span><span class="mi">31536000</span><span class="p">,</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="err">&lt;a</span><span class="w"> </span><span class="err">href=</span><span class="s2">"server-config.md#repositories-section-optional"</span><span class="err">&gt;</span><span class="s2">"repositories"</span><span class="err">&lt;/a&gt;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"gun_prefixes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"docker.io/"</span><span class="p">,</span><span class="w"> </span><span class="s2">"my-own-registry.com/"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="server-section-required">server section (required)</h2>

<p>Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"server"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"http_addr"</span><span class="p">:</span><span class="w"> </span><span class="s2">":4443"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tls_key_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.key"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tls_cert_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.crt"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table>
	<tr>
		<th>Parameter</th>
		<th>Required</th>
		<th>Description</th>
	</tr>
	<tr>
		<td valign="top"><code>http_addr</code></td>
		<td valign="top">yes</td>
		<td valign="top">The TCP address (IP and port) to listen on.  Examples:
			<ul>
			<li><code>":4443"</code> means listen on port 4443 on all IPs (and
				hence all interfaces, such as those listed when you run
				<code>ifconfig</code>)</li>
			<li><code>"127.0.0.1:4443"</code> means listen on port 4443 on
				localhost only.  That means that the server is not
				accessible except locally (via SSH tunnel, or just on a local
				terminal)</li>
			</ul>
		</td>
	</tr>
	<tr>
		<td valign="top"><code>tls_key_file</code></td>
		<td valign="top">no</td>
		<td valign="top">The path to the private key to use for
			HTTPS.  Must be provided together with <code>tls_cert_file</code>,
			or not at all. If neither are provided, the server uses HTTP
			instead of HTTPS. The path is relative to the directory of the
			configuration file.</td>
	</tr>
	<tr>
		<td valign="top"><code>tls_cert_file</code></td>
		<td valign="top">no</td>
		<td valign="top">The path to the certificate to use for HTTPS.
			Must be provided together with <code>tls_key_file</code>, or not
			at all. If neither are provided, the server uses HTTP instead
			of HTTPS. The path is relative to the directory of the
			configuration file.</td>
	</tr>
</table>

<h2 id="trust_service-section-required">trust_service section (required)</h2>

<p>This section configures either a remote trust service, such as
<a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/signer-config/">Notary signer</a> or a local in-memory
ED25519 trust service.</p>

<p>Remote trust service example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"trust_service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"remote"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"hostname"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notarysigner"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"port"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7899"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"key_algorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ecdsa"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tls_ca_file"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/root-ca.crt"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tls_client_cert"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.crt"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"tls_client_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./fixtures/notary-server.key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Local trust service example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"trust_service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"local"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table>
	<tr>
		<th>Parameter</th>
		<th>Required</th>
		<th>Description</th>
	</tr>
	<tr>
		<td valign="top"><code>type</code></td>
		<td valign="top">yes</td>
		<td valign="top">Must be <code>"remote"</code> or <code>"local"</code></td>
	</tr>
	<tr>
		<td valign="top"><code>hostname</code></td>
		<td valign="top">yes if remote</td>
		<td valign="top">The hostname of the remote trust service</td>
	</tr>
	<tr>
		<td valign="top"><code>port</code></td>
		<td valign="top">yes if remote</td>
		<td valign="top">The GRPC port of the remote trust service</td>
	</tr>
	<tr>
		<td valign="top"><code>key_algorithm</code></td>
		<td valign="top">yes if remote</td>
		<td valign="top">Algorithm to use to generate keys stored on the
			signing service.  Valid values are <code>"ecdsa"</code>,
			<code>"rsa"</code>, and <code>"ed25519"</code>.</td>
	</tr>
	<tr>
		<td valign="top"><code>tls_ca_file</code></td>
		<td valign="top">no</td>
		<td valign="top">The path to the root CA that signed the TLS
			certificate of the remote service. This parameter must be
			provided if said root CA is not in the system's default trust
			roots. The path is relative to the directory of the configuration file.</td>
	</tr>
	<tr>
		<td valign="top"><code>tls_client_key</code></td>
		<td valign="top">no</td>
		<td valign="top">The path to the private key to use for TLS mutual
			authentication. This must be provided together with
			<code>tls_client_cert</code> or not at all. The path is relative
			to the directory of the configuration file.</td>
	</tr>
	<tr>
		<td valign="top"><code>tls_client_cert</code></td>
		<td valign="top">no</td>
		<td valign="top">The path to the certificate to use for TLS mutual
			authentication. This must be provided together with
			<code>tls_client_key</code> or not at all. The path is relative
			to the directory of the configuration file.</td>
	</tr>
</table>

<h2 id="storage-section-required">storage section (required)</h2>

<p>The storage section specifies which storage backend the server should use to
store TUF metadata.  Only MySQL or an in-memory store is supported.</p>

<p>DB storage example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"storage"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"backend"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mysql"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"db_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user:pass@tcp(notarymysql:3306)/databasename?parseTime=true"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table>
	<tr>
		<th>Parameter</th>
		<th>Required</th>
		<th>Description</th>
	</tr>
	<tr>
		<td valign="top"><code>backend</code></td>
		<td valign="top">yes</td>
		<td valign="top">Must be <code>"mysql"</code> or <code>"memory"</code>.
			If <code>"memory"</code> is selected, the <code>db_url</code>
			is ignored.</td>
	</tr>
	<tr>
		<td valign="top"><code>db_url</code></td>
		<td valign="top">yes if not <code>memory</code></td>
		<td valign="top">The <a href="https://github.com/go-sql-driver/mysql">
			the Data Source Name used to access the DB.</a>
			( include <code>parseTime=true</code> as part of the DSN)</td>
	</tr>
</table>

<h2 id="auth-section-optional">auth section (optional)</h2>

<p>This sections specifies the authentication options for the server.
Currently, we only support token authentication.</p>

<p>Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"auth"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"token"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"realm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://auth.docker.io"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notary-server"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"issuer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth.docker.io"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"rootcertbundle"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/path/to/auth.docker.io/cert"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>This entire section is optional.  However, if you would like
authentication for your server, then you need the required parameters below to
configure it.</p>

<p><strong>Token authentication:</strong></p>

<p>This is an implementation of the same authentication used by version 2 of the
<a href="https://github.com/docker/distribution">Docker Registry</a>.</p>

<table>
	<tr>
		<th>Parameter</th>
		<th>Required</th>
		<th>Description</th>
	</tr>
	<tr>
		<td valign="top"><code>type</code></td>
		<td valign="top">yes</td>
		<td valign="top">Must be <code>"token"</code>; all other values result in no
			authentication (and the rest of the parameters are ignored)</td>
	</tr>
	<tr>
		<td valign="top"><code>options</code></td>
		<td valign="top">yes</td>
		<td valign="top">The options for token auth. See
			<a href="https://github.com/docker/distribution/blob/master/docs/configuration.md#token">
			the registry token configuration documentation</a>
			for the parameter details.</td>
	</tr>
</table>

<h2 id="caching-section-optional">caching section (optional)</h2>

<p>Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"caching"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"max_age"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"current_metadata"</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w">
    </span><span class="s2">"consistent_metadata"</span><span class="p">:</span><span class="w"> </span><span class="mi">31536000</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table>
	<tr>
		<th>Parameter</th>
		<th>Required</th>
		<th>Description</th>
	</tr>
	<tr>
		<td valign="top"><code>max_age</code></td>
		<td valign="top">no</td>
		<td valign="top">The max age, in seconds, for caching services to cache
			the latest metadata for a role and the metadata by checksum for a
			role.  This value is set on the cache control headers for
			GET-ting metadata.

			`must-revalidate` is also set on the cache control headers
			for current metadata, as current metadata may change whenever new
			metadata is signed into a repo.

			Consistent metadata should never change, although it may be deleted,
			so the max age can be a higher value.
		</td>
	</tr>
</table>

<h2 id="repositories-section-optional">repositories section (optional)</h2>

<p>Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"repositories"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="s2">"gun_prefixes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"docker.io/"</span><span class="p">,</span><span class="w"> </span><span class="s2">"my-own-registry.com/"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table>
	<tr>
		<th>Parameter</th>
		<th>Required</th>
		<th>Description</th>
	</tr>
	<tr>
		<td valign="top"><code>gun_prefixes</code></td>
		<td valign="top">no</td>
		<td valign="top">A list of GUN prefixes accepted by this
			server.  POST operations on an image beginning with any other prefix
			are rejected with a 400, and GET/DELETE operations are rejected
			with a 404.
		</td>
	</tr>
</table>

<h2 id="hot-logging-level-reload">Hot logging level reload</h2>

<p>We don’t support completely reloading notary configuration files yet at present. What we support for now is:</p>
<ul>
  <li>increase logging level by signaling <code class="highlighter-rouge">SIGUSR1</code></li>
  <li>decrease logging level by signaling <code class="highlighter-rouge">SIGUSR2</code></li>
</ul>

<p>Example:</p>

<p>To increase logging level</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">kill</span> <span class="nt">-s</span> SIGUSR1 PID
</code></pre></div></div>

<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker container <span class="nb">exec</span> <span class="nt">-i</span> CONTAINER_ID <span class="nb">kill</span> <span class="nt">-s</span> SIGUSR1 PID
</code></pre></div></div>

<p>To decrease logging level</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">kill</span> <span class="nt">-s</span> SIGUSR2 PID
</code></pre></div></div>

<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker container <span class="nb">exec</span> <span class="nt">-i</span> CONTAINER_ID <span class="nb">kill</span> <span class="nt">-s</span> SIGUSR2 PID
</code></pre></div></div>

<p>PID is the process id of <code class="highlighter-rouge">notary-server</code> and it may not the PID 1 process if you are running
the container with some kind of wrapper startup script or something.</p>

<p>You can get the PID of <code class="highlighter-rouge">notary-server</code> through</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>docker container <span class="nb">exec </span>CONTAINER_ID ps aux
</code></pre></div></div>

<p>or</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>ps aux | <span class="nb">grep</span> <span class="s2">"notary-server -config"</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"grep"</span>
</code></pre></div></div>

<h2 id="related-information">Related information</h2>

<ul>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/signer-config/">Notary Signer Configuration File</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/common-configs/">Configuration sections common to the Notary Server and Signer</a></li>
</ul>

							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=docker">docker</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary">notary</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary-client">notary-client</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary-server">notary-server</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary server">notary server</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary-signer">notary-signer</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/glossary/?term=notary signer">notary signer</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/notary/reference/server-config/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "notary/reference/server-config.md",
										"title": "Notary server configuration file",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/notary/reference/server-config.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/notary/reference/server-config.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [notary/reference/server-config.md](https://matsuand.github.io/docs.docker.jp.onthefly/notary/reference/server-config/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#overview" class="nomunge">Overview</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#server-section-required" class="nomunge">server section (required)</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#trust_service-section-required" class="nomunge">trust_service section (required)</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#storage-section-required" class="nomunge">storage section (required)</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#auth-section-optional" class="nomunge">auth section (optional)</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#caching-section-optional" class="nomunge">caching section (optional)</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#repositories-section-optional" class="nomunge">repositories section (optional)</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#hot-logging-level-reload" class="nomunge">Hot logging level reload</a></li>
  <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/server-config.md#related-information" class="nomunge">Related information</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<!-- <script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script> -->
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/notary/reference/server-config/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/collections_tocs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
