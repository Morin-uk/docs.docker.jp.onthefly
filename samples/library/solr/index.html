<!-- Page generated 2020-02-15 16:32:32 +0900 -->
<!-- relative link basehrefs -->

	


<!-- Logic for 'edit this button' -->


	

	

	

	

	

	

	

	

	


<!-- End of logic for 'edit this button' -->


<!DOCTYPE html>
<html lang="ja">

<head>
	<base href="https://matsuand.github.io/docs.docker.jp.onthefly/samples/library/solr/" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<style type="text/css">
		@charset "UTF-8";
		[ng\:cloak],
		[ng-cloak],
		[data-ng-cloak],
		[x-ng-cloak],
		.ng-cloak,
		.x-ng-cloak,
		.ng-hide:not(.ng-hide-animate) {
			display: none !important;
		}

		ng\:form {
			display: block;
		}
	</style>
	<!-- Google Tag Manager -->
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-WL2QLG5');</script>
	<!-- End Google Tag Manager -->
	
	<!-- favicon -->
	<link rel="icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta name="msapplication-TileImage" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico">
	<link rel="apple-touch-icon" type="image/x-icon" href="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico" sizes="129x128">
	<meta property="og:image" content="https://matsuand.github.io/docs.docker.jp.onthefly/favicons/docs@2x.ico"/>
	<!-- metadata -->
	<meta property="og:type" content="website"/>
	<meta property="og:updated_time" itemprop="dateUpdated" content="2020-02-15T16:32:32+09:00"/>
	<meta property="og:image" itemprop="image primaryImageOfPage" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:card" content="summary"/>
	<meta name="twitter:domain" content="docs.docker.jp"/>
	<meta name="twitter:site" content="@docker_docs"/>
	<meta name="twitter:url" content="https://twitter.com/docker_docs"/>
	<meta name="twitter:title" itemprop="title name" content="solr"/>
	<meta name="twitter:description" property="og:description" itemprop="description" content="Solr is the popular, blazing-fast, open source enterprise search platform built on Apache Lucene™. GitHub repo: https://github.com/docker-solr/docker-solr Library reference This content is imported from the official Docker Library docs, and..." />
	<meta name="twitter:image:src" content="https://matsuand.github.io/docs.docker.jp.onthefly/images/docs@2x.png"/>
	<meta name="twitter:image:alt" content="Docker ドキュメント"/>
	<meta property="article:published_time" itemprop="datePublished" content="2020-02-15T16:32:32+09:00"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="keywords" content="library, sample, solr">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/bootstrap.min.css">
	<link id="pygments" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/pygments/perldoc.css">
	<link id="pagestyle" rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/style.css">

	<!-- Go get "Open Sans" font from Google -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
	<!-- SEO stuff -->
	<title>solr | Docker ドキュメント</title>
<meta property="og:title" content="solr" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="Solr is the popular, blazing-fast, open source enterprise search platform built on Apache Lucene™.
" />
<meta property="og:description" content="Solr is the popular, blazing-fast, open source enterprise search platform built on Apache Lucene™.
" />
<link rel="canonical" href="https://matsuand.github.io/docs.docker.jp.onthefly/samples/library/solr/" />
<meta property="og:url" content="https://matsuand.github.io/docs.docker.jp.onthefly/samples/library/solr/" />
<meta property="og:site_name" content="Docker ドキュメント" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"solr","description":"Solr is the popular, blazing-fast, open source enterprise search platform built on Apache Lucene™.
","url":"https://matsuand.github.io/docs.docker.jp.onthefly/samples/library/solr/"}</script>
	<!-- END SEO STUFF -->
	
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	</script>
</head>
<body ng-app="Docker" ng-controller="DockerController" class="colums">
	<header>
		 <nav class="nav-secondary navbar navbar-fixed-top">
    <!-- <div class="fan"></div> -->
    <div class="container-fluid">
        <div class="navbar-header">
            <a href="https://matsuand.github.io/docs.docker.jp.onthefly/"><img class="logo" src="https://matsuand.github.io/docs.docker.jp.onthefly/images/docker-docs-logo.svg" alt="Docker Docs" title="Docker Docs"></a>
        </div>
        <div class="navbar-collapse" aria-expanded="false" style="height: 1px;">
            <div class="search-form" id="search-div" style="visibility: hidden">
    <form class="search-form form-inline ng-pristine ng-valid" id="searchForm" action="https://matsuand.github.io/docs.docker.jp.onthefly/search/">
        <input class="search-field form-control ds-input" id="st-search-input" value="" name="q" placeholder="文書内検索" type="search" autocomplete="off" spellcheck="false" dir="auto" style="position: relative; vertical-align: top;">
        <div id="autocompleteContainer">
            <div id="autocompleteResults"></div>
        </div>
        <!-- <button type="submit" class="search-submit btn btn-default">検索</button> -->
    </form>
</div>
<div class="sidebar-toggle">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
</div>
<div class="nav-container">
    <div id="tabs">
        <ul class="tabs" id="jsTOCHorizontal">

        </ul>
    </div>
    <div class="ctrl-right hidden-xs hidden-sm">
        <a href="javascript:void(0)" id="menu-toggle"><i class="fa fa-indent" aria-hidden="true"></i></a>
        <div class="btn-group" style="visibility: hidden">
  <button type="button" class="btn btn-default dropdown-btn dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Docker v19.03 (current)        <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.09/">Docker v18.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v18.03/">Docker v18.03</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.12/">Docker v17.12</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.09/">Docker v17.09</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.06/">Docker v17.06</a></li><li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/v17.03/">Docker v17.03</a></li>
  </ul>
</div>

    </div>
</div>

        </div>
    </div>
</nav>

	</header>

	<div class="wrapper right-open">
		<div class="container-fluid">
			<div class="row">
				<div class="col-body">
					<main class="col-content content">
						<section class="section">
							
								
							<h1>solr</h1>  <span class="reading-time" title="Estimated reading time">
  <span class="reading-time-label">読む時間の目安: </span>
  
  
    11 分
  
</span>

							
							
							<p>Solr is the popular, blazing-fast, open source enterprise search platform built on Apache Lucene™.</p>

<p>GitHub repo: <a href="https://github.com/docker-solr/docker-solr">https://github.com/docker-solr/docker-solr</a></p>

<blockquote>
  <p><strong>Library reference</strong></p>

  <p>This content is imported from
<a href="https://github.com/docker-library/docs/tree/master/solr/">the official Docker Library docs</a>,
and is provided by the original uploader. You can view the Docker Hub page for this image at
<a href="https://hub.docker.com/images/solr">https://hub.docker.com/images/solr</a></p>
</blockquote>

<!-- content begin -->

<!--

********************************************************************************

WARNING:

    DO NOT EDIT "solr/README.md"

    IT IS AUTO-GENERATED

    (from the other files in "solr/" combined with a set of templates)

********************************************************************************

-->

<h1 id="supported-tags-and-respective-dockerfile-links">Supported tags and respective <code class="highlighter-rouge">Dockerfile</code> links</h1>

<ul>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/02fff54d99672ee2666bff6f96f008996fb3e3b8/8.1/Dockerfile"><code class="highlighter-rouge">8.1.1</code>, <code class="highlighter-rouge">8.1</code>, <code class="highlighter-rouge">8</code>, <code class="highlighter-rouge">latest</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/02fff54d99672ee2666bff6f96f008996fb3e3b8/8.1/slim/Dockerfile"><code class="highlighter-rouge">8.1.1-slim</code>, <code class="highlighter-rouge">8.1-slim</code>, <code class="highlighter-rouge">8-slim</code>, <code class="highlighter-rouge">slim</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/71ebabff0dce35b97e796ab0c444276c75d6538e/8.0/Dockerfile"><code class="highlighter-rouge">8.0.0</code>, <code class="highlighter-rouge">8.0</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/71ebabff0dce35b97e796ab0c444276c75d6538e/8.0/slim/Dockerfile"><code class="highlighter-rouge">8.0.0-slim</code>, <code class="highlighter-rouge">8.0-slim</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/3d2bfd1262cdc05e8ed6de9347c7b961157bf136/7.7/Dockerfile"><code class="highlighter-rouge">7.7.2</code>, <code class="highlighter-rouge">7.7</code>, <code class="highlighter-rouge">7</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/3d2bfd1262cdc05e8ed6de9347c7b961157bf136/7.7/slim/Dockerfile"><code class="highlighter-rouge">7.7.2-slim</code>, <code class="highlighter-rouge">7.7-slim</code>, <code class="highlighter-rouge">7-slim</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/71ebabff0dce35b97e796ab0c444276c75d6538e/7.6/Dockerfile"><code class="highlighter-rouge">7.6.0</code>, <code class="highlighter-rouge">7.6</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/71ebabff0dce35b97e796ab0c444276c75d6538e/7.6/slim/Dockerfile"><code class="highlighter-rouge">7.6.0-slim</code>, <code class="highlighter-rouge">7.6-slim</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/71ebabff0dce35b97e796ab0c444276c75d6538e/7.5/Dockerfile"><code class="highlighter-rouge">7.5.0</code>, <code class="highlighter-rouge">7.5</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/71ebabff0dce35b97e796ab0c444276c75d6538e/7.5/slim/Dockerfile"><code class="highlighter-rouge">7.5.0-slim</code>, <code class="highlighter-rouge">7.5-slim</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/a6ad91bb7bb4373a0342325f3140966cc1c1ab24/6.6/Dockerfile"><code class="highlighter-rouge">6.6.6</code>, <code class="highlighter-rouge">6.6</code>, <code class="highlighter-rouge">6</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/a6ad91bb7bb4373a0342325f3140966cc1c1ab24/6.6/slim/Dockerfile"><code class="highlighter-rouge">6.6.6-slim</code>, <code class="highlighter-rouge">6.6-slim</code>, <code class="highlighter-rouge">6-slim</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/a6ad91bb7bb4373a0342325f3140966cc1c1ab24/5.5/Dockerfile"><code class="highlighter-rouge">5.5.5</code>, <code class="highlighter-rouge">5.5</code>, <code class="highlighter-rouge">5</code></a></li>
  <li><a href="https://github.com/docker-solr/docker-solr/blob/a6ad91bb7bb4373a0342325f3140966cc1c1ab24/5.5/slim/Dockerfile"><code class="highlighter-rouge">5.5.5-slim</code>, <code class="highlighter-rouge">5.5-slim</code>, <code class="highlighter-rouge">5-slim</code></a></li>
</ul>

<h1 id="quick-reference">Quick reference</h1>

<ul>
  <li>
    <p><strong>Where to get help</strong>:<br />
<a href="https://lucene.apache.org/solr/community.html">the Solr Community</a></p>
  </li>
  <li>
    <p><strong>Where to file issues</strong>:<br />
<a href="https://github.com/docker-solr/docker-solr/issues">https://github.com/docker-solr/docker-solr/issues</a></p>
  </li>
  <li>
    <p><strong>Maintained by</strong>:<br />
<a href="https://github.com/docker-solr/docker-solr">the Solr Community</a></p>
  </li>
  <li>
    <p><strong>Supported architectures</strong>: (<a href="https://github.com/docker-library/official-images#architectures-other-than-amd64">more info</a>)<br />
<a href="https://hub.docker.com/r/amd64/solr/"><code class="highlighter-rouge">amd64</code></a>, <a href="https://hub.docker.com/r/arm64v8/solr/"><code class="highlighter-rouge">arm64v8</code></a></p>
  </li>
  <li>
    <p><strong>Published image artifact details</strong>:<br />
<a href="https://github.com/docker-library/repo-info/blob/master/repos/solr">repo-info repo’s <code class="highlighter-rouge">repos/solr/</code> directory</a> (<a href="https://github.com/docker-library/repo-info/commits/master/repos/solr">history</a>)<br />
(image metadata, transfer size, etc)</p>
  </li>
  <li>
    <p><strong>Image updates</strong>:<br />
<a href="https://github.com/docker-library/official-images/pulls?q=label%3Alibrary%2Fsolr">official-images PRs with label <code class="highlighter-rouge">library/solr</code></a><br />
<a href="https://github.com/docker-library/official-images/blob/master/library/solr">official-images repo’s <code class="highlighter-rouge">library/solr</code> file</a> (<a href="https://github.com/docker-library/official-images/commits/master/library/solr">history</a>)</p>
  </li>
  <li>
    <p><strong>Source of this description</strong>:<br />
<a href="https://github.com/docker-library/docs/tree/master/solr">docs repo’s <code class="highlighter-rouge">solr/</code> directory</a> (<a href="https://github.com/docker-library/docs/commits/master/solr">history</a>)</p>
  </li>
</ul>

<h1 id="what-is-solr">What is Solr?</h1>

<p>Solr is highly reliable, scalable and fault tolerant, providing distributed indexing, replication and load-balanced querying, automated failover and recovery, centralized configuration and more. Solr powers the search and navigation features of many of the world’s largest internet sites.</p>

<p>Learn more on <a href="http://lucene.apache.org/solr/">Apache Solr homepage</a> and in the <a href="https://www.apache.org/dyn/closer.cgi/lucene/solr/ref-guide/">Apache Solr Reference Guide</a>.</p>

<blockquote>
  <p><a href="https://en.wikipedia.org/wiki/Apache_Solr">wikipedia.org/wiki/Apache_Solr</a></p>
</blockquote>

<p><img src="https://raw.githubusercontent.com/docker-library/docs/ddc9eb521da7c412b70229f1a600d0c63d55d0f7/solr/logo.png" alt="logo" /></p>

<h1 id="how-to-use-this-docker-image">How to use this Docker image</h1>

<h2 id="run-solr-and-index-example-data">Run Solr and index example data</h2>

<p>To run a single Solr server:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">--name</span> my_solr <span class="nt">-d</span> <span class="nt">-p</span> 8983:8983 <span class="nt">-t</span> solr
</code></pre></div></div>

<p>Then with a web browser go to <code class="highlighter-rouge">http://localhost:8983/</code> to see the Admin Console (adjust the hostname for your docker host).</p>

<p>To use Solr, you need to create a “core”, an index for your data. For example:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">--user</span><span class="o">=</span>solr my_solr bin/solr create_core <span class="nt">-c</span> gettingstarted
</code></pre></div></div>

<p>In the web UI if you click on “Core Admin” you should now see the “gettingstarted” core.</p>

<p>If you want to load some of the example data that is included in the container:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">--user</span><span class="o">=</span>solr my_solr bin/post <span class="nt">-c</span> gettingstarted example/exampledocs/manufacturers.xml
</code></pre></div></div>

<p>In the UI, find the “Core selector” popup menu and select the “gettingstarted” core, then select the “Query” menu item. This gives you a default search for <code class="highlighter-rouge">*:*</code> which returns all docs. Hit the “Execute Query” button, and you should see a few docs with data. Congratulations!</p>

<h2 id="single-command-demo">Single-command demo</h2>

<p>For convenience, there is a single command that starts Solr, creates a collection called “demo”, and loads sample data into it:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">--name</span> solr_demo <span class="nt">-d</span> <span class="nt">-P</span> solr solr-demo
</code></pre></div></div>

<h2 id="loading-your-own-data">Loading your own data</h2>

<p>If you want load your own data, you’ll have to make it available to the container, for example by copying it into the container:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker cp <span class="nv">$HOME</span>/mydata/mydata.xml my_solr:/opt/solr/mydata.xml
<span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">--user</span><span class="o">=</span>solr my_solr bin/post <span class="nt">-c</span> gettingstarted mydata.xml
</code></pre></div></div>

<p>or by mounting a host directory as a volume:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">--name</span> my_solr <span class="nt">-d</span> <span class="nt">-p</span> 8983:8983 <span class="nt">-t</span> <span class="nt">-v</span> <span class="nv">$HOME</span>/mydata:/opt/solr/mydata solr
<span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">--user</span><span class="o">=</span>solr my_solr bin/solr create_core <span class="nt">-c</span> gettingstarted
<span class="gp">$</span> docker <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">--user</span><span class="o">=</span>solr my_solr bin/post <span class="nt">-c</span> gettingstarted mydata/mydata.xml
</code></pre></div></div>

<p>To learn more about Solr, see the <a href="https://cwiki.apache.org/confluence/display/solr/Apache+Solr+Reference+Guide">Apache Solr Reference Guide</a>.</p>

<h2 id="creating-cores">Creating Cores</h2>

<p>In addition to the <code class="highlighter-rouge">docker exec</code> method explained above, you can create a core automatically at start time, in several ways.</p>

<p>If you run:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-d</span> <span class="nt">-P</span> solr solr-create <span class="nt">-c</span> mycore
</code></pre></div></div>

<p>the container will:</p>

<ul>
  <li>run Solr in the background, on the loopback interface</li>
  <li>wait for it to start</li>
  <li>run the “solr create” command with the arguments you passed</li>
  <li>stop the background Solr</li>
  <li>start Solr in the foreground</li>
</ul>

<p>You can combine this with mounted volumes to pass in core configuration from your host:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-d</span> <span class="nt">-P</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/myconfig:/myconfig solr solr-create <span class="nt">-c</span> mycore <span class="nt">-d</span> /myconfig
</code></pre></div></div>

<p>When using the <code class="highlighter-rouge">solr-create</code> command, Solr will log to the standard docker log (inspect with <code class="highlighter-rouge">docker logs</code>), and the collection creation will happen in the background and log to <code class="highlighter-rouge">/opt/docker-solr/init.log</code>.</p>

<p>This first way closely mirrors the manual core creation steps and uses Solr’s own tools to create the core, so should be reliable.</p>

<p>The second way of creating a core at start time is using the <code class="highlighter-rouge">solr-precreate</code> command. This will create the core in the filesystem before running Solr. You should pass it the core name, and optionally the directory to copy the config from (this defaults to Solr’s built-in “basic_configs”). For example:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-d</span> <span class="nt">-P</span> solr solr-precreate mycore
<span class="gp">$</span> docker run <span class="nt">-d</span> <span class="nt">-P</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/myconfig:/myconfig solr solr-precreate mycore /myconfig
</code></pre></div></div>

<p>This method stores the core in an intermediate subdirectory called “mycores”. This allows you to use mounted volumes:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> mkdir mycores
<span class="gp">$</span> <span class="nb">sudo </span>chown 8983:8983 mycores
<span class="gp">$</span> docker run <span class="nt">-d</span> <span class="nt">-P</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/mycores:/opt/solr/server/solr/mycores solr solr-precreate mycore
</code></pre></div></div>

<p>This second way is quicker, easier to monitor because it logs to the docker log, and can fail immediately if something is wrong.</p>

<p>The third way of creating a core at startup is to use the image extension mechanism explained in the next section.</p>

<h2 id="using-docker-compose">Using Docker Compose</h2>

<p>With Docker Compose you can create a Solr container with the index stored in a named data volume. Create a <code class="highlighter-rouge">docker-compose.yml</code> like:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">2'</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">solr</span><span class="pi">:</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">solr</span>
    <span class="na">ports</span><span class="pi">:</span>
     <span class="pi">-</span> <span class="s2">"</span><span class="s">8983:8983"</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">data:/opt/solr/server/solr/mycores</span>
    <span class="na">entrypoint</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">docker-entrypoint.sh</span>
      <span class="pi">-</span> <span class="s">solr-precreate</span>
      <span class="pi">-</span> <span class="s">mycore</span>
<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">data</span><span class="pi">:</span>
</code></pre></div></div>

<p>and just run <code class="highlighter-rouge">docker-compose up</code>.</p>

<h2 id="solrinsh-configuration">solr.in.sh configuration</h2>

<p>In Solr it is common to configure settings in <a href="https://github.com/apache/lucene-solr/blob/master/solr/bin/solr.in.sh">solr.in.sh</a>, as documented in the <a href="https://cwiki.apache.org/confluence/display/solr/Taking+Solr+to+Production#TakingSolrtoProduction-Environmentoverridesincludefile">Solr Reference Guide</a>.</p>

<p>In docker-solr you can simply pass these environment variables to the container. For example:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-d</span> <span class="nt">-P</span> <span class="nt">-e</span> <span class="nv">SOLR_HEAP</span><span class="o">=</span>800m solr
</code></pre></div></div>

<p>This works for Solr versions newer than 6.3.0. Older versions had some hardcoded defaults in <code class="highlighter-rouge">solr.in.sh</code>; see <code class="highlighter-rouge">docs/set-heap.sh</code> for how to modify that configuration.</p>

<h2 id="custom-solr_home">Custom SOLR_HOME</h2>

<p>In Solr, it is common to specify a custom SOLR_HOME, to store cores and configuration in a different volume. In docker-solr, you can use that with mounted volumes:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> mkdir mysolrhome
<span class="gp">$</span> <span class="nb">sudo </span>chown 8983:8983 mysolrhome
<span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/mysolrhome:/opt/mysolrhome <span class="nt">-e</span> <span class="nv">SOLR_HOME</span><span class="o">=</span>/opt/mysolrhome solr
</code></pre></div></div>

<p>Solr requires a solr.xml file and configsets in the SOLR_HOME, so you must provide that ahead of time. One way of doing that is to copy the default content before running Solr:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/mysolrhome:/opt/mysolrhome <span class="nt">-e</span> <span class="nv">SOLR_HOME</span><span class="o">=</span>/opt/mysolrhome solr <span class="se">\</span>
   bash <span class="nt">-c</span> <span class="s2">"cp -R /opt/solr/server/solr/* /opt/mysolrhome"</span>
<span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/mysolrhome:/opt/mysolrhome <span class="nt">-e</span> <span class="nv">SOLR_HOME</span><span class="o">=</span>/opt/mysolrhome solr
</code></pre></div></div>

<p>or, in a single command:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/mysolrhome:/opt/mysolrhome <span class="nt">-e</span> <span class="nv">SOLR_HOME</span><span class="o">=</span>/opt/mysolrhome solr <span class="se">\</span>
   bash <span class="nt">-c</span> <span class="s2">"cp -R /opt/solr/server/solr/* /opt/mysolrhome &amp;&amp; exec docker-entrypoint.sh solr-foreground"</span>
</code></pre></div></div>

<p>As an added convenience, you can pass <code class="highlighter-rouge">-e INIT_SOLR_HOME=yes</code> to do that automatically (if SOLR_HOME is empty):</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">-it</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/mysolrhome:/opt/mysolrhome <span class="nt">-e</span> <span class="nv">SOLR_HOME</span><span class="o">=</span>/opt/mysolrhome <span class="nt">-e</span> <span class="nv">INIT_SOLR_HOME</span><span class="o">=</span>yes solr
</code></pre></div></div>

<h2 id="extending-the-image">Extending the image</h2>

<p>The docker-solr image has an extension mechanism. At run time, before starting Solr, the container will execute scripts in the <code class="highlighter-rouge">/docker-entrypoint-initdb.d/</code> directory. You can add your own scripts there either by using mounted volumes or by using a custom Dockerfile. These scripts can for example copy a core directory with pre-loaded data for continuous integration testing, or modify the Solr configuration.</p>

<p>Here is a simple example. With a <code class="highlighter-rouge">custom.sh</code> script like:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">#</span><span class="o">!</span>/bin/bash
<span class="go">set -e
echo "this is running inside the container before Solr starts"
</span></code></pre></div></div>

<p>you can run:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">$</span> docker run <span class="nt">--name</span> solr_custom1 <span class="nt">-d</span> <span class="nt">-P</span> <span class="nt">-v</span> <span class="nv">$PWD</span>/custom.sh:/docker-entrypoint-initdb.d/custom.sh solr
<span class="gp">$</span> sleep 5
<span class="gp">$</span> docker logs solr_custom1 | head
<span class="go">/opt/docker-solr/scripts/docker-entrypoint.sh: running /docker-entrypoint-initdb.d/set-heap.sh
this is running inside the container before Solr starts

Starting Solr on port 8983 from /opt/solr/server
</span></code></pre></div></div>

<p>With this extension mechanism it can be useful to see the shell commands that are being executed by the <code class="highlighter-rouge">docker-entrypoint.sh</code> script in the docker log. To do that, set an environment variable using Docker’s <code class="highlighter-rouge">-e VERBOSE=yes</code>.</p>

<h2 id="distributed-solr">Distributed Solr</h2>

<p>You can also run a distributed Solr configuration.</p>

<p>The recommended and most flexible way to do that is to use Docker networking. See the <a href="https://github.com/docker-solr/docker-solr/blob/master/Docker-FAQ.md#can-i-run-zookeeper-and-solr-clusters-under-docker">Can I run ZooKeeper and Solr clusters under Docker</a> FAQ, and <a href="https://github.com/docker-solr/docker-solr/blob/master/docs/docker-networking.md">this example</a>.</p>

<p>You can also use legacy links, see the <a href="https://github.com/docker-solr/docker-solr/blob/master/Docker-FAQ.md#can-i-run-zookeeper-and-solr-clusters-under-docker">Can I run ZooKeeper and Solr with Docker Links</a> FAQ.</p>

<h1 id="about-this-repository">About this repository</h1>

<p>This repository is available on <a href="https://github.com/docker-solr/docker-solr">github.com/docker-solr/docker-solr</a>, and the official build is on the <a href="https://hub.docker.com/_/solr/">Docker Hub</a>.</p>

<p>This repository is based on (and replaces) <code class="highlighter-rouge">makuk66/docker-solr</code>, and has been sponsored by <a href="http://www.lucidworks.com/">Lucidworks</a>.</p>

<h1 id="image-variants">Image Variants</h1>

<p>The <code class="highlighter-rouge">solr</code> images come in many flavors, each designed for a specific use case.</p>

<h2 id="solrversion"><code class="highlighter-rouge">solr:&lt;version&gt;</code></h2>

<p>This is the defacto image. If you are unsure about what your needs are, you probably want to use this one. It is designed to be used both as a throw away container (mount your source code and start the container to start your app), as well as the base to build other images off of.</p>

<h2 id="solrversion-slim"><code class="highlighter-rouge">solr:&lt;version&gt;-slim</code></h2>

<p>This image does not contain the common packages contained in the default tag and only contains the minimal packages needed to run <code class="highlighter-rouge">solr</code>. Unless you are working in an environment where <em>only</em> the <code class="highlighter-rouge">solr</code> image will be deployed and you have space constraints, we highly recommend using the default image of this repository.</p>

<h1 id="license">License</h1>

<p>Solr is licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>

<p>This repository is also licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.</p>

<p>Copyright 2015 Martijn Koster</p>

<p>Licensed under the Apache License, Version 2.0 (the “License”); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      http://www.apache.org/licenses/LICENSE-2.0
</code></pre></div></div>

<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an “AS IS” BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>

<p>As with all Docker images, these likely also contain other software which may be under other licenses (such as Bash, etc from the base distribution, along with any direct or indirect dependencies of the primary software being contained).</p>

<p>Some additional license information which was able to be auto-detected might be found in <a href="https://github.com/docker-library/repo-info/tree/master/repos/solr">the <code class="highlighter-rouge">repo-info</code> repository’s <code class="highlighter-rouge">solr/</code> directory</a>.</p>

<p>As for any pre-built image usage, it is the image user’s responsibility to ensure that any use of this image complies with any relevant licenses for all software contained within.</p>


							<!-- tags -->
							
							
							
							<span class="glyphicon glyphicon-tags" style="padding-right: 10px"></span><span style="vertical-align: 2px"><a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=library">library</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=sample">sample</a>, <a href="https://matsuand.github.io/docs.docker.jp.onthefly/search/?q=solr">solr</a></span>
							
							<!-- link corrections -->
              <script language="JavaScript">
							var x = document.links.length;
							var baseHref = document.getElementsByTagName('base')[0].href
							for (i = 0; i < x; i++) {
							  var munged = false;
							  var thisHREF = document.links[i].href;
							  var originalURL = "/samples/library/solr/";
							  if (thisHREF.indexOf(baseHref + "#") > -1) {
							    // hash fix
							    //console.log('BEFORE: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							    thisHREF = originalURL + thisHREF.replace(baseHref, "");
							    //console.log('AFTER: base:',baseHref,'thisHREF:',thisHREF,'originalURL:',originalURL);
							  }
							  if ((thisHREF.indexOf(window.location.hostname) > -1 || thisHREF.indexOf('http') == -1) && document.links[i].className.indexOf("nomunge") < 0) {
							    munged = true;
							    thisHREF = thisHREF.replace(".md", "/").replace("/index/", "/");
							    document.links[i].setAttribute('href', thisHREF);
							  }
							}
							</script>
							
						  <div id="ratings-div" style="color:#b9c2cc; text-align: center; margin-top: 150px; visibility: hidden">
								<div id="pd_rating_holder_8453675"></div>
								<script type="text/javascript">
									PDRTJS_settings_8453675 = {
										"id": "8453675",
										"unique_id": "_samples/library/solr/index.md",
										"title": "solr",
										"permalink": "https://github.com/docker/docker.github.io/blob/master/_samples/library/solr/index.md"
									};
									(function(d, c, j) {
										if (!document.getElementById(j)) {
											var pd = d.createElement(c),
												s;
											pd.id = j;
											pd.src = ('https:' == document.location.protocol) ? 'https://polldaddy.com/js/rating/rating.js' : 'http://i0.poll.fm/js/rating/rating.js';
											s = document.getElementsByTagName(c)[0];
											s.parentNode.insertBefore(pd, s);
										}
									}(document, 'script', 'pd-rating-js'));
								</script>
							</div>
							
						</section>
					</main>
					<nav class="col-nav">
						<div id="sidebar-nav" class="sidebar hidden-sm hidden-xs">
						<div id="navbar" class="nav-sidebar">
    <ul class="nav" id="jsTOCLeftNav">
    </ul>
</div>

						</div>
					</nav>
					<div class="col-toc">
							<div class="sidebar hidden-xs hidden-sm">
							<div class="toc-nav">
								<div class="feedback-links">
									<ul>
										
										<li style="visibility: hidden"><a href="https://github.com/matsuand/docs.docker.jp/edit/v19.03.local/_samples/library/solr/index.md"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> このページの編集</a></li>
										<li><a href="https://github.com/matsuand/docs.docker.jp.onthefly/issues/new?body=File: [_samples/library/solr/index.md](https://matsuand.github.io/docs.docker.jp.onthefly/samples/library/solr/)"
															class="nomunge"><i class="fa fa-check" aria-hidden="true"></i> 文書変更のリクエスト</a></li>
										<li><a href="https://success.docker.com/support"><i class="fa fa-question" aria-hidden="true"></i> サポート依頼</a></li>
										<!-- toggle mode -->
										<li>
											<div class="toggle-mode">
												<div class="icon">
													<i class="fa fa-sun-o" aria-hidden="true"></i>
												</div>
												<div class="toggle-switch">
													<label class="switch">
														<input type="checkbox" id="switch-style">
														<div class="slider round"></div>
												</label>
												</div>
												<div class="icon">
													<i class="fa fa-moon-o" aria-hidden="true"></i>
												</div>
											</div>
										</li>
									</ul>
								</div>
								   
									<div id="side-toc-title">本ページ内</div>
									
<ul id="my_toc" class="inline_toc">
  <li><a href="#run-solr-and-index-example-data" class="nomunge">Run Solr and index example data</a></li>
  <li><a href="#single-command-demo" class="nomunge">Single-command demo</a></li>
  <li><a href="#loading-your-own-data" class="nomunge">Loading your own data</a></li>
  <li><a href="#creating-cores" class="nomunge">Creating Cores</a></li>
  <li><a href="#using-docker-compose" class="nomunge">Using Docker Compose</a></li>
  <li><a href="#solrinsh-configuration" class="nomunge">solr.in.sh configuration</a></li>
  <li><a href="#custom-solr_home" class="nomunge">Custom SOLR_HOME</a></li>
  <li><a href="#extending-the-image" class="nomunge">Extending the image</a></li>
  <li><a href="#distributed-solr" class="nomunge">Distributed Solr</a></li>
  <li><a href="#solrversion" class="nomunge">solr:&lt;version&gt;</a></li>
  <li><a href="#solrversion-slim" class="nomunge">solr:&lt;version&gt;-slim</a></li>
</ul>


								</div>
								
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	
	<footer class="footer">
		  
    <div class="container">
        <div class="top_footer">
            <div class="row">
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/what-docker">What is Docker</a></li>
                        <li><a href="https://www.docker.com/what-container">What is a Container</a></li>
                        <li><a href="https://www.docker.com/use-cases">Use Cases</a></li>
                        <li><a href="https://www.docker.com/customers">Customers</a></li>
                        <li><a href="https://www.docker.com/partners/partner-program">Partners</a></li>
                        <li class="break"><a href="https://www.docker.com/industry-government">For Government</a></li>
                        <li><a href="https://www.docker.com/company">About Docker</a></li>
                        <li><a href="https://www.docker.com/company/management">Management</a></li>
                        <li><a href="https://www.docker.com/company/news-and-press">Press &amp; News</a></li>
                        <li><a href="https://www.docker.com/careers">Careers</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/products/overview">Product</a></li>
                        <li><a href="https://www.docker.com/pricing">Pricing</a></li>
                        <li><a href="https://www.docker.com/docker-community">Community Edition</a></li>
                        <li class="break"><a href="https://www.docker.com/enterprise">Enterprise Edition </a></li>
                        <li><a href="https://www.docker.com/products/docker-datacenter">Docker Datacenter</a></li>
                        <li><a href="https://hub.docker.com/">Docker Hub</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://matsuand.github.io/docs.docker.jp.onthefly/">Documentation</a></li>
                        <li><a href="https://www.docker.com/docker">Learn</a></li>
                        <li><a href="https://blog.docker.com" target="_blank">Blog</a></li>
                        <li><a href="https://engineering.docker.com" target="_blank">Engineering Blog</a></li>
                        <li><a href="https://training.docker.com/" target="_blank">Training</a></li>
                        <li><a href="https://success.docker.com/support">Support</a></li>
                        <li><a href="https://success.docker.com/kbase">Knowledge Base</a></li>
                        <li><a href="https://www.docker.com/products/resources">Resources</a></li>
                    </ul>
                </div>
                <div class="col-xs-12 col-sm-3 col-md-3">
                    <ul class="footer_links">
                        <li><a href="https://www.docker.com/docker-community">Community</a></li>
                        <li><a href="https://www.docker.com/technologies/overview">Open Source</a></li>
                        <li><a href="https://www.docker.com/community/events">Events</a></li>
                        <li><a href="https://forums.docker.com/" target="_blank">Forums</a></li>
                        <li><a href="https://www.docker.com/community/docker-captains">Docker Captains</a></li>
                        <li><a href="https://www.docker.com/docker-community/scholarships">Scholarships</a></li>
                        <li><a href="https://blog.docker.com/curated/">Community News</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-nav">
                <nav class="footer_sub_nav">
                    <ul class="menu">
                        <li><a href="http://status.docker.com/">Status</a></li>
                        <li><a href="https://www.docker.com/docker-security">Security</a></li>
                        <li><a href="https://www.docker.com/legal">Legal</a></li>
                        <li><a href="https://www.docker.com/company/contact">Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
        <div class="bottom_footer">
            <div class="footer-copyright col-xs-12 col-md-8">
                <p class="copyright">
                    Copyright &copy; 2019 Docker Inc. All rights reserved. </p>
            </div>
            <div class="footer_social_nav">
                <ul class="nav-social">
                    <li class="fa fa-twitter"><a href="http://twitter.com/docker">Twitter</a></li>
                    <li class="fa fa-youtube"><a href="http://www.youtube.com/user/dockerrun">Youtube</a></li>
                    <li class="fa fa-github"><a href="https://github.com/docker">GitHub</a></li>
                    <li class="fa fa-linkedin"><a href="https://www.linkedin.com/company/docker">Linkedin</a></li>
                    <li class="fa fa-facebook"><a href="https://www.facebook.com/docker.run">Facebook</a></li>
                    <li class="fa fa-reddit"><a href="http://www.reddit.com/r/docker">Reddit</a></li>
                    <li class="fa fa-slideshare"><a href="http://www.slideshare.net/docker">Slideshare</a></li>
                </ul>
            </div>
        </div>
    </div>

	</footer>
	<link rel="stylesheet" href="https://matsuand.github.io/docs.docker.jp.onthefly/css/github.css">
	
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/anchorlinks.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/menu.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/jquery.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/bootstrap.min.js"></script>
	<!-- Always include the archive.js, but it doesn't do much unless we are an archive -->
	<script language="javascript">
	// Default to assuming this is an archive and hiding some stuff
	// See js/archive.js and js/docs.js for logic relating to this
	var isArchive = true;
	var dockerVersion = 'v19.03';
	// In archives, we need to know the page root and we get it from JEKYLL_ENV in the jekyll build command
	var jekyllEnv = 'development';
	// If unset (in non-archive branches), defaults to "development". In that case, reset it to empty
	if (jekyllEnv == 'development') {
		jekyllEnv = '';
	}
	var pageURL = jekyllEnv + '/samples/library/solr/';
	</script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/archive.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/stickyfill.min.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/metadata.js"></script>
	<script src="https://matsuand.github.io/docs.docker.jp.onthefly/js/glossary.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/docs.js"></script>
	<script defer src="https://matsuand.github.io/docs.docker.jp.onthefly/js/toc.js"></script>
	<script language="javascript">
	jQuery(document).ready(function(){
				hookupTOCEvents();
			});
	</script>
</body>

</html>
